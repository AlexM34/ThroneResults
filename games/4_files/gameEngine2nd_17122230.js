function jlj(a,b){this.key=a;this.value=b}function _p0y(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+a+"=([^&#]*)"),b=c.exec(location.search);return b===null?"":decodeURIComponent(b[1].replace(/\+/g," "))}if(typeof String.prototype.sxk!="function"){String.prototype.sxk=function(a){return this.slice(0,a.length)==a}}Number.prototype.jyc2=function(e,d){var f=Math.min.apply(Math,[e,d]),c=Math.max.apply(Math,[e,d]);return this>=f&&this<=c};Number.prototype.f6xc=function(){return this.valueOf()};String.prototype.f6xc=function(){return parseInt(this,this.length>1?10:16)};String.prototype._jj=function(b){try{return this.match(new RegExp(b,"g")).length}catch(a){return 0}};String.prototype.xr9_=function(){return this.replace(/^\s*?(\S*?)\s*$/,"$1")};String.prototype.x4__=function(){return this.replace(/^\s+|(\s+(?!\S))/mg,"")};String.prototype.phc=function(){return this.replace(/\\'/g,"'").replace(/\\"/g,'"').replace(/\\0/g,"\0").replace(/\\\\/g,"\\")};function z5_j(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}String.prototype.y0f=function(b,a){return this.replace(new RegExp(z5_j(b),"g"),a)};String.prototype.ybz_=function(a,b){b=typeof b!="string"?""+b:b;return this.substr(0,a)+b+this.substr(a+b.length)};String.prototype.cdp=function(a){return this.indexOf(a)>-1};Array.prototype.mqd_=function(b){var a=this.length;while(a--){this[a]=+this[a]}return this};Array.prototype.cdp=function(b){var a=this.length;while(a--){if(this[a]===b){return true}}return false};Array.prototype.fs64=function(){return[].concat(this)};function rnv(b,a){b=b+"";return b.length>=a?b:new Array(a-b.length+1).join("0")+b}function $(a){return document.getElementById(a)}function yvc(d,c){return d[0]-c[0]}function w77(d,c){return c[0]-d[0]}function ls1w(d,c){return c-d}function v6_(e){var a=window.location.search,c=[],d=[];a=a.replace(/\?/g,"");c=a.split("&");for(var b=0;b<c.length;b++){d=c[b].split("=");if(d[0]==e){return d[1]}}}function l_r(a){var b=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.clientLeft||document.body.clientLeft||0;return Math.round(a.getBoundingClientRect().left+b-c)}function tb4(b){var a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,c=document.documentElement.clientTop||document.body.clientTop||0;return Math.round(b.getBoundingClientRect().top+a-c)}function _xg(a){return typeof a!="object"?$(a):a}function w58(a){return $(a).style.cursor=="pointer"}function wb7(a){wtg(a,"pointer")}function mws(a){wtg(a,"crosshair")}function n95(a){wtg(a,"default")}function wtg(b,c){try{_xg(b).style.cursor=c}catch(a){}}function dyj6(b,a){_xg(b).className="";d75(b,a)}function bwz(b,a){b6x_(b,a,-1)}function d75(b,a){b6x_(b,a,1)}function d_bh(b,a){b=_xg(b);b.className.cdp(a)}function b6x_(g,c,d){g=_xg(g);try{var a=c.split(" ");while(a.length>0){var b=a.pop().xr9_();if(b){d>0?g.classList.add(b):g.classList.remove(b)}}}catch(f){if(d>0){g.className=" "+c}else{g.className=g.name.replace(new RegExp("[ ]?"+c),"")}}}var yy4=false,b9j=new _bk8();function _bk8(){this.serverTime=0;this.cntRequest=0;this.cntWarning=0;this.cntError=0;this.warning=function(){if(++this.cntWarning>2){this.cntWarning=0;this.error()}};this.error=function(){if(++this.cntError>=2){t_74()}};this.resetState=function(){this.cntWarning=0;this.cntError=0;k5s()};this.ok=function(){this.resetState()};this.setTime=function(a){if(this.serverTime!=a){this.serverTime=a}else{this.error()}}}function gym(){this.url="./ajax.php";this.parameter="";this.method="GET";this.result="TEXT";this.onSuccess=null;this.onError=function(a){b9j.error()}}function _x1d(){if(window.XMLHttpRequest){return new XMLHttpRequest()}else{try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}}return false}gym.prototype.s_kg=function(){if(!this.url){this.onError("Error: No target url! HTTP request was stopped.");return false}if(this.method!="GET"){this.method="POST"}var b=_x1d();if(!b){this.onError("Error while initializing XMLHttpRequest object.");return false}var c=this;b.onreadystatechange=a;switch(this.method){case"POST":b.open(this.method,this.url,true);b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");b.send(this.parameter);break;default:b.open(this.method,this.url+"?"+this.parameter,true);b.setRequestHeader("Pragma","no-cache");b.setRequestHeader("Cache-Control","no-store, no-cache, must-revalidate");b.setRequestHeader("If-Modified-Since",document.lastModified);b.send();break}function a(){if(this.readyState<4){return false}else{yy4=false;if(this.status==200||this.status==304){b9j.ok();if(c.onSuccess){if(c.result=="XML"){c.onSuccess(this.responseXML)}else{c.onSuccess(this.responseText)}}}else{if(this.status>0||this.statusText){c.onError(this.status+": "+this.statusText)}else{b9j.error()}}}}};function fd0s(a,b){_s0("GET",a,b)}function __b(a,b){_s0("POST",a,b)}function _s0(sendMethod,options,handler){if(yy4){b9j.warning();return false}yy4=true;with(new gym()){method=sendMethod;parameter="game="+d8m+"&rc="+(++b9j.cntRequest)+"&"+options;onSuccess=handler;s_kg()}}function m3xs(){ls73=_p0y("review")=="1";d8m=d2t6("g-id");slf=d2t6("g-ttl").phc();rcfw=d2t6("g-stttm");_nr1=d2t6("g-plrs");lmm=d2t6("g-hid").split("|");fq8=(d2t6("g-ha").split("|")).mqd_();x3f=d2t6("g-pmax");wm0=d2t6("g-omax");_06=d2t6("g-c2win");jsx=d2t6("g-umaxf");y2b=d2t6("g-umaxk");glb=d2t6("g-umaxs");dp37=d2t6("g-umaxse");vm25=d2t6("g-al");_1_f=d2t6("g-as");nq5l=d2t6("g-ap");cjy=d2t6("g-tmax");dpx=d2t6("cfg-useprts");_v1=d2t6("cfg-bttlvrnt");w3p=d2t6("cfg-rdrs2");y7q=d2t6("cfg-mp2nd");xqss=d2t6("cfg-mp6");_hbv=d2t6("cfg-kcrt");_jx=d2t6("p-avatars").split("|");_dby("p-avatars","");zv0="card"+d2t6("css-crds");m_18="cardToB_base cardToB";v0sd="o_base"+d2t6("css-rdrs");y02x=d2t6("u-ismob");t7mc=d2t6("u-snd");khc+=xqss?"s5,l30,l31,l36":"l33";khc+=","}function y6l(){if(_0_>=0){clearInterval(_0_);_0_=-1}_0_=setInterval(nkc,d2t6("u-ival"))}function dz4p(){var a=$("myMap");try{jsonAreas=d2t6("g-ma").replace(/\;/g,",");mapAreas=JSON.parse(jsonAreas);for(var c=0;c<mapAreas.length;++c){var b=document.createElement("area");b.setAttribute("id",mapAreas[c][0]);b.setAttribute("title",mapAreas[c][1]);b.setAttribute("shape",mapAreas[c][2]);b.setAttribute("coords",mapAreas[c][3]);a.appendChild(b)}}catch(d){alert("Unexpected error while initializing game map!")}_dby("g-ma","")}function kt2_(){m3xs();vd37();dz4p();_m7();m0d();b1l(d2t6("cfg-ldtwn"));document.images.initLoading.style.display="none";$("gameField").style.display="";s9zc();r__v();if(d2t6("g-stts")!=1){l026()}else{if(y02x){$("chatWindow").style.position="absolute"}y6l();j76()?pln_(b66,_8bd,_dmx):alert(STR.SPECTATOR)}var b="./images/cards_HSNM"+(d2t6("cfg-crds")?"_2nd":"")+".png";for(var a=0;a<_nr1;a++){var c=lmm[a];if(mymk(c)){new Image().src=b.replace("HSNM",c)}}}function fkly(){d8m=_p0y("game");fd0s("get=GAMEDATA&player="+_p0y("player")+"&access="+_p0y("access"),s9_)}function fn77(a){nnj=!nnj}window.onload=fkly;window.onfocus=fn77;window.onblur=fn77;function vd37(){_tdp();hl6g();g_7();n5w();d8k_();xdg0();l0q();_qpn()}var tgf;var w4c=[];with(w4c){push([2,2]);push([2,3]);push([2,2,3]);push([2,2,2,3]);push([2,2,3,3]);push([2,2,3,4]);push([2,2,2,3,4])}var lmm,fq8,_jx,r_mn=navigator.userAgent.indexOf("WebKit")>0,y02x,slf,ls73=false,wv_,d8m,rcfw,dpx,_v1,w3p,y7q,xqss,_hbv,_nr1,x3f,_06,jsx,y2b,dp37,glb,wm0,cjy,vm25,_1_f,nq5l,zv0,m_18,v0sd,t7mc;var b2j,h60=[];for(var j=0;j<20;j++){h60.push(0)}var khc="s0,s1,s2,s3,s4,l3,l7,l8,l12,l16,l23,l27,l29";var __w=0;var npv9=0;var rf_=false,kw7,xp4g=-1,fj08=-1,m0xj=false,ktlx=0,xh6=0;var ys1=0,bfk=0;var nnj=false,_0_=-1;var s2x="",z507="",n7b0=0,l_q0="",f_fx="nnn",_8bd="",b66="",_dmx="",z31="",_1_="",xh_="",f0s="",y67="",_qnc="",n187="",x_05="",fsny="",nry="",cnn=-1,zdyw=-1,p5t="",bmv_=-1,l89t=-1,m5k=-1,pfdm=0,fk0f=-1,cdt=1,hzd=0;var d6kx=[],r70=[];for(var i=0;i<8;i++){r70.push([])}var sqy=[];var ll1q=[];var kt_h=[];var rsdx=[];var chat,cd_=0,xh_m=0;var mn4x,msj,_kn7=-1,c05y=-1,_15=0,kpc=0,pjh,wr0x=0,qtv=0,th_6=[];var w8_=new Image();w8_.src="./images/battle.gif";var q1x=new Image();q1x.src="./images/window_background.gif";var _29=[];function hl6g(){for(var a=0;a<16;a++){_29[a]=[]}_29[0][1]=v0sd+" o_cover";_29[1][1]=v0sd+" o_raid1";_29[2][1]=v0sd+" o_raid1";_29[3][1]=v0sd+" o_raid2";_29[4][1]=v0sd+" o_march0";_29[5][1]=v0sd+" o_march1";_29[6][1]=v0sd+" o_march2";_29[7][1]=v0sd+" o_supp1";_29[8][1]=v0sd+" o_supp1";_29[9][1]=v0sd+" o_supp2";_29[10][1]=v0sd+" o_def1";_29[11][1]=v0sd+" o_def1";_29[12][1]=v0sd+" o_def2";_29[13][1]=v0sd+" o_cp1";_29[14][1]=v0sd+" o_cp1";_29[15][1]=v0sd+" o_cp2"}var vhz="",_knq=[];function g_7(){_knq[3]="s00l01";_knq[7]="s00s02l06l08l10";_knq[8]="s00s01s02l07";_knq[10]="s02l06l07l09l14";_knq[12]="s02";_knq[14]="s02s03l10l16l17l18";_knq[16]="s03l14l18l23";_knq[17]="l14l18l19l21";_knq[18]="l14l16l17l21l23";_knq[21]="l17l18l19l22l23l25";if(!xqss){_knq[0]="s00s10l01l02";_knq[1]="s00s10l00l02l03l04l06";_knq[2]="s10l00l01";_knq[4]="s09s10l01l05l06";_knq[5]="s09s10l04";_knq[6]="s09l01l04l07l09l10";_knq[9]="s09l06l10l11l13";_knq[11]="s09l09l13";_knq[13]="s09l09l11l15l19";_knq[15]="s09l13";_knq[19]="s07s08s09l13l17l21l22";_knq[20]="s07";_knq[22]="s08l19l21l24l25";_knq[23]="s01s03l16l18l21l25l27";_knq[24]="s07s08l22l25l26l28";_knq[25]="l21l22l23l24l27l28";_knq[26]="s06s07l24l28";_knq[27]="s01s04l23l25l28l29";_knq[28]="s06l24l25l26l27l29l30l31";_knq[29]="s04l27l28";_knq[30]="s04l28l31";_knq[31]="s04s05s06l28l30l32";_knq[32]="s05s06l31";_knq[33]="s04";if(dpx){_knq[29]+="p03";_knq[32]+="p04"}}else{_knq[0]="s00s11l01l02";_knq[1]="s00s11l00l02l03l04l06";_knq[2]="s11l00l01";_knq[4]="s10s11l01l05l06";_knq[5]="s10s11l04";_knq[6]="s10l01l04l07l09l10";_knq[9]="s10l06l10l11l13";_knq[11]="s10l09l13";_knq[13]="s10l09l11l15l19";_knq[15]="s10l13";_knq[19]="s08s09s10l13l17l21l22";_knq[20]="s08";_knq[22]="s09l19l21l24l25";_knq[23]="s01s03s04l16l18l21l25l27";_knq[24]="s08s09l22l25l26l28";_knq[25]="l21l22l23l24l27l28l29";_knq[26]="s06s07s08l24l28";_knq[27]="s04s05l23l25l29l30";_knq[28]="s07l24l25l26l29l32l33";_knq[29]="l25l27l28l30l31l32";_knq[30]="s05l27l29l31";_knq[31]="s04s05l29l30";_knq[32]="l28l29l33l35";if(y7q){_knq[31]+="l32";_knq[32]+="l31"}_knq[33]="s07l28l32l34l35l37";_knq[34]="s06s07l33l37";_knq[35]="s04s06l32l33l37";_knq[36]="s04s05";_knq[37]="s06l33l34l35";if(dpx){_knq[30]+="p03";_knq[34]+="p04"}}_knq[vm25+0]="s01l00l01l03l07l08";_knq[vm25+1]="s00s02s03s04l08l23l27";_knq[vm25+2]="s01s03l07l08l10l12l14";_knq[vm25+3]="s01s02l14l16l23";if(!xqss){_knq[vm25+4]="s01s05l27l29l30l31l33";_knq[vm25+5]="s04s06s07l31l32";_knq[vm25+6]="s05s07l26l28l31l32";_knq[vm25+7]="s05s06s08s09l19l20l24l26";_knq[vm25+8]="s07l19l22l24";_knq[vm25+9]="s07s10l04l05l06l09l11l13l15l19";_knq[vm25+10]="s09l00l01l02l04l05";if(dpx){_knq[vm25+4]+="p03";_knq[vm25+5]+="p04";_knq[vm25+7]+="p05p06";_knq[vm25+9]+="p07"}}else{_knq[vm25+1]="s00s02s03s04l08l23";_knq[vm25+4]="s01s05s06l23l27l31l35l36";_knq[vm25+5]="s04l27l30l31l36";_knq[vm25+6]="s04s07s08l26l34l35l37";_knq[vm25+7]="s06l26l28l33l34";_knq[vm25+8]="s06s09s10l19l20l24l26";_knq[vm25+9]="s08l19l22l24";_knq[vm25+10]="s08s11l04l05l06l09l11l13l15l19";_knq[vm25+11]="s10l00l01l02l04l05";if(dpx){_knq[vm25+5]+="p03";_knq[vm25+6]+="p04";_knq[vm25+8]+="p05p06";_knq[vm25+10]+="p07"}}if(dpx){_knq[1]+="p00";_knq[4]+="p07";_knq[12]+="p01";_knq[16]+="p02";_knq[20]+="p06";_knq[26]+="p05";_knq[vm25+0]+="p00";_knq[vm25+2]+="p01";_knq[vm25+3]+="p02";_knq[vm25+_1_f+0]="s00l01";_knq[vm25+_1_f+1]="s02l12";_knq[vm25+_1_f+2]="s03l16";if(!xqss){_knq[vm25+_1_f+3]="s04l29";_knq[vm25+_1_f+4]="s05l31";_knq[vm25+_1_f+5]="s07l26";_knq[vm25+_1_f+6]="s07l20";_knq[vm25+_1_f+7]="s09l04"}else{_knq[vm25+_1_f+3]="s05l30";_knq[vm25+_1_f+4]="s06l34";_knq[vm25+_1_f+5]="s08l26";_knq[vm25+_1_f+6]="s08l20";_knq[vm25+_1_f+7]="s10l04"}}}var sfb=[],p_qn=[],jcks=[],xt_y=[];function n5w(){var e=_nr1==6?6:5,f=jsx*e,a=y2b*e,d=dp37*e,b=glb*e;for(var c=0;c<f;c++){sfb[c]=[];sfb[c][0]=false;sfb[c][6]=true;sfb[c][2]=-1;if(c<jsx){sfb[c][1]="u_base u_map u_FMB";sfb[c][3]="BFM"+c;sfb[c][4]="B"}else{if(c<jsx*2){sfb[c][1]="u_base u_map u_FML";sfb[c][3]="LFM"+c;sfb[c][4]="L"}else{if(c<jsx*3){sfb[c][1]="u_base u_map u_FMS";sfb[c][3]="SFM"+c;sfb[c][4]="S"}else{if(c<jsx*4){sfb[c][1]="u_base u_map u_FMT";sfb[c][3]="TFM"+c;sfb[c][4]="T"}else{if(c<jsx*5){sfb[c][1]="u_base u_map u_FMG";sfb[c][3]="GFM"+c;sfb[c][4]="G"}else{sfb[c][1]="u_base u_map u_FMM";sfb[c][3]="MFM"+c;sfb[c][4]="M"}}}}}}for(c=0;c<a;c++){p_qn[c]=[];p_qn[c][0]=false;p_qn[c][6]=true;p_qn[c][2]=-1;if(c<y2b){p_qn[c][1]="u_base u_map u_KTB";p_qn[c][3]="BKT"+c;p_qn[c][4]="B"}else{if(c<y2b*2){p_qn[c][1]="u_base u_map u_KTL";p_qn[c][3]="LKT"+c;p_qn[c][4]="L"}else{if(c<y2b*3){p_qn[c][1]="u_base u_map u_KTS";p_qn[c][3]="SKT"+c;p_qn[c][4]="S"}else{if(c<y2b*4){p_qn[c][1]="u_base u_map u_KTT";p_qn[c][3]="TKT"+c;p_qn[c][4]="T"}else{if(c<y2b*5){p_qn[c][1]="u_base u_map u_KTG";p_qn[c][3]="GKT"+c;p_qn[c][4]="G"}else{p_qn[c][1]="u_base u_map u_KTM";p_qn[c][3]="MKT"+c;p_qn[c][4]="M"}}}}}}for(c=0;c<d;c++){jcks[c]=[];jcks[c][0]=false;jcks[c][6]=true;jcks[c][2]=-1;if(c<dp37){jcks[c][1]="u_base u_map u_SEB";jcks[c][3]="BSE"+c;jcks[c][4]="B"}else{if(c<dp37*2){jcks[c][1]="u_base u_map u_SEL";jcks[c][3]="LSE"+c;jcks[c][4]="L"}else{if(c<dp37*3){jcks[c][1]="u_base u_map u_SES";jcks[c][3]="SSE"+c;jcks[c][4]="S"}else{if(c<dp37*4){jcks[c][1]="u_base u_map u_SET";jcks[c][3]="TSE"+c;jcks[c][4]="T"}else{if(c<dp37*5){jcks[c][1]="u_base u_map u_SEG";jcks[c][3]="GSE"+c;jcks[c][4]="G"}else{jcks[c][1]="u_base u_map u_SEM";jcks[c][3]="MSE"+c;jcks[c][4]="M"}}}}}}for(c=0;c<b;c++){xt_y[c]=[];xt_y[c][0]=false;xt_y[c][6]=true;xt_y[c][2]=-1;if(c<glb){xt_y[c][1]="u_base u_map u_SPB";xt_y[c][3]="BSP"+c;xt_y[c][4]="B"}else{if(c<glb*2){xt_y[c][1]="u_base u_map u_SPL";xt_y[c][3]="LSP"+c;xt_y[c][4]="L"}else{if(c<glb*3){xt_y[c][1]="u_base u_map u_SPS";xt_y[c][3]="SSP"+c;xt_y[c][4]="S"}else{if(c<glb*4){xt_y[c][1]="u_base u_map u_SPT";xt_y[c][3]="TSP"+c;xt_y[c][4]="T"}else{if(c<glb*5){xt_y[c][1]="u_base u_map u_SPG";xt_y[c][3]="GSP"+c;xt_y[c][4]="G"}else{xt_y[c][1]="u_base u_map u_SPM";xt_y[c][3]="MSP"+c;xt_y[c][4]="M"}}}}}}}function pg2v(){nry="";for(var a=0;a<20;a++){h60[a]=0}__w=0;kw7=null;ktlx=0;xh6=0}function _tdp(){var a=$("WesterosMapImg");if(!ls73){cvi_map.add(a,{opacity:25})}}var wq_=[];function d8k_(){for(var a=0;a<_1_f;a++){wq_[a]=[];switch(a){case 0:wq_[a][0]=65;wq_[a][1]=270;wq_[a][2]=45;wq_[a][3]=270;wq_[a][4]=25;wq_[a][5]=270;wq_[a][6]=85;wq_[a][7]=270;break;case 1:if(!xqss){wq_[a][0]=55;wq_[a][1]=1030;wq_[a][2]=35;wq_[a][3]=1030;wq_[a][4]=75;wq_[a][5]=1030;wq_[a][6]=15;wq_[a][7]=1030}else{wq_[a][0]=21;wq_[a][1]=584;wq_[a][2]=38;wq_[a][3]=584;wq_[a][4]=55;wq_[a][5]=584;wq_[a][6]=4;wq_[a][7]=584}break;case 2:wq_[a][0]=45;wq_[a][1]=661;wq_[a][2]=62;wq_[a][3]=661;wq_[a][4]=53;wq_[a][5]=627;wq_[a][6]=70;wq_[a][7]=627;break;case 3:wq_[a][0]=70;wq_[a][1]=805;wq_[a][2]=90;wq_[a][3]=795;wq_[a][4]=110;wq_[a][5]=785;wq_[a][6]=50;wq_[a][7]=815;break;case 4:if(!xqss){wq_[a][0]=50;wq_[a][1]=1245;wq_[a][2]=30;wq_[a][3]=1245;wq_[a][4]=70;wq_[a][5]=1245;wq_[a][6]=10;wq_[a][7]=1245}else{wq_[a][0]=80;wq_[a][1]=1375;wq_[a][2]=100;wq_[a][3]=1375;wq_[a][4]=120;wq_[a][5]=1375;wq_[a][6]=60;wq_[a][7]=1375}break;case 5:if(!xqss){wq_[a][0]=570;wq_[a][1]=1350;wq_[a][2]=590;wq_[a][3]=1350;wq_[a][4]=610;wq_[a][5]=1350;wq_[a][6]=630;wq_[a][7]=1350}else{wq_[a][0]=55;wq_[a][1]=1220;wq_[a][2]=75;wq_[a][3]=1245;wq_[a][4]=35;wq_[a][5]=1200;wq_[a][6]=55;wq_[a][7]=1180}break;case 6:if(!xqss){wq_[a][0]=519;wq_[a][1]=1185;wq_[a][2]=499;wq_[a][3]=1175;wq_[a][4]=539;wq_[a][5]=1195;wq_[a][6]=479;wq_[a][7]=1165}else{wq_[a][0]=565;wq_[a][1]=1345;wq_[a][2]=585;wq_[a][3]=1345;wq_[a][4]=605;wq_[a][5]=1345;wq_[a][6]=625;wq_[a][7]=1345}break;case 7:if(!xqss){wq_[a][0]=682;wq_[a][1]=1050;wq_[a][2]=665;wq_[a][3]=1050;wq_[a][4]=699;wq_[a][5]=1050;wq_[a][6]=648;wq_[a][7]=1050}else{wq_[a][0]=509;wq_[a][1]=1185;wq_[a][2]=489;wq_[a][3]=1175;wq_[a][4]=529;wq_[a][5]=1195;wq_[a][6]=469;wq_[a][7]=1165}break;case 8:if(!xqss){wq_[a][0]=541;wq_[a][1]=894;wq_[a][2]=524;wq_[a][3]=894;wq_[a][4]=558;wq_[a][5]=894;wq_[a][6]=531;wq_[a][7]=861}else{wq_[a][0]=682;wq_[a][1]=1068;wq_[a][2]=665;wq_[a][3]=1068;wq_[a][4]=699;wq_[a][5]=1068;wq_[a][6]=648;wq_[a][7]=1068}break;case 9:if(!xqss){wq_[a][0]=630;wq_[a][1]=535;wq_[a][2]=650;wq_[a][3]=535;wq_[a][4]=670;wq_[a][5]=535;wq_[a][6]=690;wq_[a][7]=535}else{wq_[a][0]=541;wq_[a][1]=894;wq_[a][2]=524;wq_[a][3]=894;wq_[a][4]=558;wq_[a][5]=894;wq_[a][6]=531;wq_[a][7]=861}break;case 10:if(!xqss){wq_[a][0]=640;wq_[a][1]=390;wq_[a][2]=620;wq_[a][3]=390;wq_[a][4]=660;wq_[a][5]=390;wq_[a][6]=680;wq_[a][7]=390}else{wq_[a][0]=630;wq_[a][1]=535;wq_[a][2]=650;wq_[a][3]=535;wq_[a][4]=670;wq_[a][5]=535;wq_[a][6]=690;wq_[a][7]=535}break;case 11:wq_[a][0]=640;wq_[a][1]=390;wq_[a][2]=620;wq_[a][3]=390;wq_[a][4]=660;wq_[a][5]=390;wq_[a][6]=680;wq_[a][7]=390;break;default:break}}}var bwjt=[];function xdg0(){if(!dpx){return}for(i=0;i<nq5l;i++){bwjt[i]=[]}bwjt[0][0]=268;bwjt[0][1]=189;bwjt[0][2]=251;bwjt[0][3]=189;bwjt[0][4]=285;bwjt[0][5]=189;bwjt[1][0]=65;bwjt[1][1]=732;bwjt[1][2]=48;bwjt[1][3]=732;bwjt[1][4]=82;bwjt[1][5]=732;bwjt[2][0]=95;bwjt[2][1]=882;bwjt[2][2]=112;bwjt[2][3]=882;bwjt[2][4]=78;bwjt[2][5]=882;bwjt[3][0]=103;bwjt[3][1]=1130;bwjt[3][2]=85;bwjt[3][3]=1130;bwjt[3][4]=120;bwjt[3][5]=1130;bwjt[4][0]=633;bwjt[4][1]=1275;bwjt[4][2]=616;bwjt[4][3]=1275;bwjt[4][4]=650;bwjt[4][5]=1275;bwjt[5][0]=594;bwjt[5][1]=1071;bwjt[5][2]=577;bwjt[5][3]=1071;bwjt[5][4]=611;bwjt[5][5]=1071;bwjt[6][0]=637;bwjt[6][1]=951;bwjt[6][2]=620;bwjt[6][3]=951;bwjt[6][4]=654;bwjt[6][5]=951;bwjt[7][0]=420;bwjt[7][1]=534;bwjt[7][2]=403;bwjt[7][3]=534;bwjt[7][4]=437;bwjt[7][5]=534}var p40=[];function l0q(){for(var a=0;a<vm25;a++){p40[a]=[];switch(a){case 0:p40[a][0]=450;p40[a][1]=120;p40[a][2]=421;p40[a][3]=120;p40[a][4]=479;p40[a][5]=120;p40[a][6]=392;p40[a][7]=120;break;case 1:p40[a][0]=362;p40[a][1]=335;p40[a][2]=332;p40[a][3]=335;p40[a][4]=320;p40[a][5]=375;p40[a][6]=290;p40[a][7]=375;break;case 2:p40[a][0]=536;p40[a][1]=212;p40[a][2]=565;p40[a][3]=212;p40[a][4]=594;p40[a][5]=212;p40[a][6]=507;p40[a][7]=212;break;case 3:p40[a][0]=150;p40[a][1]=400;p40[a][2]=180;p40[a][3]=400;p40[a][4]=120;p40[a][5]=400;p40[a][6]=166;p40[a][7]=435;break;case 4:p40[a][0]=420;p40[a][1]=421;p40[a][2]=390;p40[a][3]=421;p40[a][4]=405;p40[a][5]=385;p40[a][6]=435;p40[a][7]=385;break;case 5:p40[a][0]=465;p40[a][1]=435;p40[a][2]=465;p40[a][3]=471;p40[a][4]=488;p40[a][5]=403;p40[a][6]=518;p40[a][7]=403;break;case 6:p40[a][0]=300;p40[a][1]=497;p40[a][2]=330;p40[a][3]=497;p40[a][4]=300;p40[a][5]=534;p40[a][6]=270;p40[a][7]=534;break;case 7:p40[a][0]=190;p40[a][1]=543;p40[a][2]=220;p40[a][3]=543;p40[a][4]=205;p40[a][5]=506;p40[a][6]=235;p40[a][7]=506;break;case 8:p40[a][0]=118;p40[a][1]=571;p40[a][2]=131;p40[a][3]=535;p40[a][4]=86;p40[a][5]=571;p40[a][6]=101;p40[a][7]=535;break;case 9:p40[a][0]=342;p40[a][1]=616;p40[a][2]=372;p40[a][3]=616;p40[a][4]=312;p40[a][5]=616;p40[a][6]=342;p40[a][7]=653;break;case 10:p40[a][0]=275;p40[a][1]=650;p40[a][2]=245;p40[a][3]=650;p40[a][4]=245;p40[a][5]=610;p40[a][6]=215;p40[a][7]=580;break;case 11:p40[a][0]=460;p40[a][1]=590;p40[a][2]=490;p40[a][3]=590;p40[a][4]=430;p40[a][5]=590;p40[a][6]=460;p40[a][7]=626;break;case 12:p40[a][0]=120;p40[a][1]=670;p40[a][2]=150;p40[a][3]=690;p40[a][4]=120;p40[a][5]=707;p40[a][6]=90;p40[a][7]=690;break;case 13:p40[a][0]=435;p40[a][1]=670;p40[a][2]=405;p40[a][3]=670;p40[a][4]=375;p40[a][5]=696;p40[a][6]=395;p40[a][7]=731;break;case 14:p40[a][0]=275;p40[a][1]=729;p40[a][2]=305;p40[a][3]=729;p40[a][4]=335;p40[a][5]=729;p40[a][6]=258;p40[a][7]=763;break;case 15:p40[a][0]=506;p40[a][1]=743;p40[a][2]=476;p40[a][3]=743;p40[a][4]=486;p40[a][5]=706;p40[a][6]=456;p40[a][7]=706;break;case 16:p40[a][0]=170;p40[a][1]=840;p40[a][2]=202;p40[a][3]=840;p40[a][4]=170;p40[a][5]=877;p40[a][6]=202;p40[a][7]=803;break;case 17:p40[a][0]=357;p40[a][1]=785;p40[a][2]=327;p40[a][3]=785;p40[a][4]=343;p40[a][5]=822;p40[a][6]=373;p40[a][7]=822;break;case 18:p40[a][0]=293;p40[a][1]=858;p40[a][2]=262;p40[a][3]=858;p40[a][4]=262;p40[a][5]=895;p40[a][6]=293;p40[a][7]=821;break;case 19:p40[a][0]=466;p40[a][1]=815;p40[a][2]=497;p40[a][3]=815;p40[a][4]=435;p40[a][5]=815;p40[a][6]=451;p40[a][7]=846;break;case 20:p40[a][0]=630;p40[a][1]=845;p40[a][2]=660;p40[a][3]=845;p40[a][4]=630;p40[a][5]=882;p40[a][6]=660;p40[a][7]=882;break;case 21:p40[a][0]=348;p40[a][1]=930;p40[a][2]=318;p40[a][3]=930;p40[a][4]=333;p40[a][5]=894;p40[a][6]=363;p40[a][7]=894;break;case 22:p40[a][0]=450;p40[a][1]=951;p40[a][2]=480;p40[a][3]=951;p40[a][4]=420;p40[a][5]=951;p40[a][6]=420;p40[a][7]=914;break;case 23:p40[a][0]=170;p40[a][1]=975;p40[a][2]=170;p40[a][3]=938;p40[a][4]=139;p40[a][5]=975;p40[a][6]=139;p40[a][7]=938;break;case 24:p40[a][0]=448;p40[a][1]=1025;p40[a][2]=418;p40[a][3]=1025;p40[a][4]=433;p40[a][5]=1062;p40[a][6]=403;p40[a][7]=1062;break;case 25:p40[a][0]=285;p40[a][1]=1060;p40[a][2]=315;p40[a][3]=1060;p40[a][4]=255;p40[a][5]=1060;p40[a][6]=345;p40[a][7]=1060;break;case 26:p40[a][0]=483;p40[a][1]=1110;p40[a][2]=513;p40[a][3]=1110;p40[a][4]=543;p40[a][5]=1110;p40[a][6]=497;p40[a][7]=1073;break;case 27:p40[a][0]=170;p40[a][1]=1046;p40[a][2]=140;p40[a][3]=1029;p40[a][4]=200;p40[a][5]=1066;p40[a][6]=170;p40[a][7]=1090;break;case 28:if(!xqss){p40[a][0]=302;p40[a][1]=1170;p40[a][2]=336;p40[a][3]=1170;p40[a][4]=268;p40[a][5]=1170;p40[a][6]=285;p40[a][7]=1135}else{p40[a][0]=369;p40[a][1]=1172;p40[a][2]=339;p40[a][3]=1172;p40[a][4]=355;p40[a][5]=1137;p40[a][6]=385;p40[a][7]=1137}break;case 29:if(!xqss){p40[a][0]=162;p40[a][1]=1167;p40[a][2]=189;p40[a][3]=1204;p40[a][4]=131;p40[a][5]=1167;p40[a][6]=189;p40[a][7]=1241}else{p40[a][0]=260;p40[a][1]=1136;p40[a][2]=230;p40[a][3]=1136;p40[a][4]=290;p40[a][5]=1136;p40[a][6]=200;p40[a][7]=1136}break;case 30:if(!xqss){p40[a][0]=285;p40[a][1]=1286;p40[a][2]=254;p40[a][3]=1286;p40[a][4]=316;p40[a][5]=1286;p40[a][6]=285;p40[a][7]=1249}else{p40[a][0]=123;p40[a][1]=1170;p40[a][2]=109;p40[a][3]=1205;p40[a][4]=137;p40[a][5]=1135;p40[a][6]=93;p40[a][7]=1170}break;case 31:if(!xqss){p40[a][0]=405;p40[a][1]=1279;p40[a][2]=435;p40[a][3]=1279;p40[a][4]=420;p40[a][5]=1240;p40[a][6]=390;p40[a][7]=1240}else{p40[a][0]=175;p40[a][1]=1238;p40[a][2]=190;p40[a][3]=1203;p40[a][4]=205;p40[a][5]=1238;p40[a][6]=160;p40[a][7]=1203}break;case 32:if(!xqss){p40[a][0]=527;p40[a][1]=1250;p40[a][2]=557;p40[a][3]=1250;p40[a][4]=540;p40[a][5]=1285;p40[a][6]=510;p40[a][7]=1285}else{p40[a][0]=305;p40[a][1]=1230;p40[a][2]=275;p40[a][3]=1230;p40[a][4]=290;p40[a][5]=1195;p40[a][6]=260;p40[a][7]=1195}break;case 33:if(!xqss){p40[a][0]=80;p40[a][1]=1320;p40[a][2]=48;p40[a][3]=1320;p40[a][4]=20;p40[a][5]=1320;p40[a][6]=65;p40[a][7]=1285}else{p40[a][0]=425;p40[a][1]=1252;p40[a][2]=395;p40[a][3]=1252;p40[a][4]=410;p40[a][5]=1217;p40[a][6]=380;p40[a][7]=1217}break;case 34:p40[a][0]=530;p40[a][1]=1245;p40[a][2]=560;p40[a][3]=1255;p40[a][4]=500;p40[a][5]=1235;p40[a][6]=470;p40[a][7]=1235;break;case 35:p40[a][0]=295;p40[a][1]=1300;p40[a][2]=325;p40[a][3]=1300;p40[a][4]=265;p40[a][5]=1300;p40[a][6]=250;p40[a][7]=1265;break;case 36:p40[a][0]=72;p40[a][1]=1292;p40[a][2]=48;p40[a][3]=1318;p40[a][4]=20;p40[a][5]=1318;p40[a][6]=80;p40[a][7]=1325;break;case 37:p40[a][0]=477;p40[a][1]=1289;p40[a][2]=445;p40[a][3]=1289;p40[a][4]=412;p40[a][5]=1289;p40[a][6]=510;p40[a][7]=1289;break;default:break}}}var bkt=[];function _qpn(){var b=vm25+_1_f+nq5l+1;for(var a=0;a<b;a++){bkt[a]=[]}bkt[0][0]=355;bkt[0][1]=91;bkt[1][0]=400;bkt[1][1]=245;bkt[2][0]=536;bkt[2][1]=262;bkt[3][0]=165;bkt[3][1]=315;bkt[4][0]=447;bkt[4][1]=365;bkt[5][0]=490;bkt[5][1]=435;bkt[6][0]=345;bkt[6][1]=470;bkt[7][0]=162;bkt[7][1]=488;bkt[8][0]=58;bkt[8][1]=533;bkt[9][0]=320;bkt[9][1]=575;bkt[10][0]=204;bkt[10][1]=628;bkt[11][0]=520;bkt[11][1]=575;bkt[12][0]=143;bkt[12][1]=648;bkt[13][0]=550;bkt[13][1]=640;bkt[14][0]=260;bkt[14][1]=695;bkt[15][0]=538;bkt[15][1]=722;bkt[16][0]=160;bkt[16][1]=766;bkt[17][0]=375;bkt[17][1]=795;bkt[18][0]=219;bkt[18][1]=903;bkt[19][0]=540;bkt[19][1]=795;bkt[20][0]=593;bkt[20][1]=860;bkt[21][0]=221;bkt[21][1]=958;bkt[22][0]=450;bkt[22][1]=890;bkt[23][0]=105;bkt[23][1]=955;bkt[24][0]=531;bkt[24][1]=960;bkt[25][0]=275;bkt[25][1]=990;bkt[26][0]=435;bkt[26][1]=1115;bkt[27][0]=131;bkt[27][1]=1068;if(!xqss){bkt[28][0]=225;bkt[28][1]=1135;bkt[29][0]=133;bkt[29][1]=1235;bkt[30][0]=230;bkt[30][1]=1240;bkt[31][0]=365;bkt[31][1]=1230;bkt[32][0]=475;bkt[32][1]=1255;bkt[33][0]=35;bkt[33][1]=1300}else{bkt[28][0]=385;bkt[28][1]=1164;bkt[29][0]=295;bkt[29][1]=1115;if(dpx){bkt[30][0]=75;bkt[30][1]=1195}else{bkt[30][0]=90;bkt[30][1]=1120}bkt[31][0]=125;bkt[31][1]=1245;bkt[32][0]=295;bkt[32][1]=1180;bkt[33][0]=355;bkt[33][1]=1240;bkt[34][0]=590;bkt[34][1]=1220;bkt[35][0]=220;bkt[35][1]=1300;bkt[36][0]=30;bkt[36][1]=1295;bkt[37][0]=395;bkt[37][1]=1310}bkt[vm25+0][0]=55;bkt[vm25+0][1]=200;bkt[vm25+1][0]=10;bkt[vm25+1][1]=965;bkt[vm25+2][0]=12;bkt[vm25+2][1]=625;bkt[vm25+3][0]=20;bkt[vm25+3][1]=830;bkt[vm25+4][0]=165;bkt[vm25+4][1]=1340;bkt[vm25+5][0]=455;bkt[vm25+5][1]=1370;bkt[vm25+6][0]=610;bkt[vm25+6][1]=1155;bkt[vm25+7][0]=670;bkt[vm25+7][1]=1095;bkt[vm25+8][0]=530;bkt[vm25+8][1]=851;bkt[vm25+9][0]=655;bkt[vm25+9][1]=590;bkt[vm25+10][0]=655;bkt[vm25+10][1]=295;if(xqss){bkt[vm25+1][0]=2;bkt[vm25+1][1]=543;bkt[vm25+4][0]=180;bkt[vm25+4][1]=1335;bkt[vm25+5][0]=25;bkt[vm25+5][1]=1150;bkt[vm25+6][0]=490;bkt[vm25+6][1]=1355;bkt[vm25+7][0]=550;bkt[vm25+7][1]=1180;bkt[vm25+8][0]=670;bkt[vm25+8][1]=1020;bkt[vm25+9][0]=527;bkt[vm25+9][1]=848;bkt[vm25+10][0]=655;bkt[vm25+10][1]=590;bkt[vm25+11][0]=655;bkt[vm25+11][1]=295}if(dpx){bkt[vm25+_1_f+0][0]=225;bkt[vm25+_1_f+0][1]=205;bkt[vm25+_1_f+1][0]=19;bkt[vm25+_1_f+1][1]=745;bkt[vm25+_1_f+2][0]=50;bkt[vm25+_1_f+2][1]=895;bkt[vm25+_1_f+3][0]=76;bkt[vm25+_1_f+3][1]=1087;bkt[vm25+_1_f+4][0]=645;bkt[vm25+_1_f+4][1]=1290;bkt[vm25+_1_f+5][0]=590;bkt[vm25+_1_f+5][1]=1027;bkt[vm25+_1_f+6][0]=652;bkt[vm25+_1_f+6][1]=930;bkt[vm25+_1_f+7][0]=440;bkt[vm25+_1_f+7][1]=526}bkt[vm25+_1_f+nq5l][0]=-1000;bkt[vm25+_1_f+nq5l][1]=-1000}function t7vj(a){return _1_.charAt(a).f6xc()}function v0q(){return t7vj(0)+1+(cjy>10?d2t6("cycles")*10:0)}function sd_4(){return t7vj(1)}function g70(){return t7vj(2)*2}function d1x(){return t7vj(3)}function p5dx(){return sd_4()==0}function rh__(){return sd_4()==1}function j67p(){return sd_4()==2}function vz04(b){try{return b66.substr(b*8,8)}catch(a){return"n0000000"}}function xcjj(b,a){return a==0?vz04(b).charAt(a):parseInt(vz04(b).charAt(a))}function l0f(c,a,b){b66=b66.ybz_(c*8+a,b)}function lwl(b,a){if(a.jyc2(0,2)){l0f(b,4,a)}}function djx(b,a){l0f(b,0,a)}function rr_(b,a){_8bd=_8bd.ybz_(b*2,a)}function tv6p(a){return xcjj(a,0)}function vxs(a){return tv6p(nrkx(a))}function j8nz(a){return a<vm25}function q_5h(a){return !j8nz(a)&&!cz9(a)}function cz9(a){return a>=vm25+_1_f}function tx0_(b){try{if(cz9(b)){return vxs(b-vm25-_1_f)}else{if(q_5h(b)){return b12j(b-vm25)}}return tv6p(b)}catch(a){return"n"}}function hm4(a,b){return a==nw_(b)}function nw_(f){var b=rnv(f,2);for(var c=0;c<_nr1;c++){var e=lmm[c],d=_04m(e);for(var a=0;a<d.length;a+=3){if(b==d.substr(a,2)){return e}}}return"n"}function _0yd(a){return xcjj(a,4)}function fjrn(a){return _0yd(a)==1}function gl4(a){return _0yd(a)>1}function jhh(a){return xcjj(a,5)}function dr5m(a){return xcjj(a,5)>0}function vv3(a){return xcjj(a,7)}function _qks(a){return l_q0.substr(a*6,6)}function njm(c,d){var b=d<4?1:2,a=_qks(c).substr(d,b);return parseInt(a,10)}function pt9q(a,b){return njm(a,b)}function sv4(a){return njm(a,0)-1}function ff0(a){return njm(whyx(a),0)}function t3vt(a){return njm(whyx(a),1)}function s9m_(a){return njm(whyx(a),2)}function byxc(a){return njm(a,3)}function kd05(a){return njm(a,4)}function g4_(a){return _8bd.substr(a*2,2)}function b12j(a){return g4_(a).charAt(0)}function q3c8(c,e){var a=[],b=vm25+_1_f+nq5l;for(var d=0;d<b;++d){if(tx0_(d)==c&&(!e||hm_t(d)>0)){a.push(d)}}return a}function zxc8(a){a=a?a:j76();return a?byxc(whyx(a)):0}function zj_v(){if(p5dx()){var a=d1x(),b=_fxm();return(a==1&&b==5)||(a==2&&b==6)||(a==3&&b==14)}return false}function cdsz(){return p5dx()&&d1x()==1&&bmv_==1}function ysf(){return p5dx()&&d1x()==1&&bmv_==2}function lyys(){return p5dx()&&d1x()==2&&l89t==2}function mvtj(){return p5dx()&&d1x()==2&&(l89t==1||l89t==5)}function wb_j(){return p5dx()&&d1x()==3&&m5k==5}function d__q(){var a,c=[];for(var b=0;b<_nr1;b++){if(vd_(b)){a=parseInt(d2t6("bid"+lmm[b]));c.push(a)}}return c}function gf9p(){var c=d__q(),a,b=0;while(c.length>0){a=c.pop();b+=a>0?a:0}return b}function _h9(){return gf9p()}function q6_y(a,b){return sww(a,b,2)}function k94(a,b){return sww(a,b,1)}function y3x_(a,b){return sww(a,b,0)}function sww(b,c,d){var a=d==2?"_STATUS":(d==1?"_TTIP":"");if(c==3){return STR["EVT_WINTER"+a]}else{if(c==4){return STR["EVT_SUMMER"+a]}else{if(b==1){switch(c){case 0:return STR["EVT_DECK"+a]+" I";case 1:return STR["EVT_MUSTER"+a];case 2:return STR["EVT_SUPPLY"+a];case 5:return STR["EVT_BLADES"+a];default:break}}else{if(b==2){switch(c){case 0:return STR["EVT_DECK"+a]+" II";case 1:return STR["EVT_THRONES"+a];case 2:return STR["EVT_CLASH"+a];case 5:return STR["EVT_THRONES"+a];case 6:return STR["EVT_WINGS"+a];default:break}}else{if(b==3){switch(c){case 0:return STR["EVT_DECK"+a]+" III";case 5:return STR["EVT_WILDLINGS"+a];case 6:return STR["EVT_SWORDS"+a];case 7:return STR["EVT_STORMS"+a];case 8:return STR["EVT_FEAST"+a];case 9:return STR["EVT_RAINS"+a];case 10:return STR["EVT_STORMS"+a];case 11:return STR["EVT_FEAST"+a];case 12:return STR["EVT_RAINS2"+a];case 13:return STR["EVT_LIES"+a];case 14:return STR["EVT_SWORD"+a];default:break}}}}}}return"Unknown Event"}function _yh2(b,c){if(b>1&&v0q()==1&&sd_4()==0){return STR.EVT_SUMMER}var d=y3x_(b,c),a=[0,104,105,106,204,205,206,304,306,309,310,311,312];if(a.cdp(b*100+c)){d+='<div class="grey">'+STR.format(STR.EVT_SUB_WSTR,["+2"])+"</div>"}return d}function _fxm(){switch(d1x()){case 1:return bmv_;case 2:return l89t;case 3:return m5k;default:return 0}}function b331(a){var b=["throne","sword","raven"];try{return"./images/"+b[--a]+".gif"}catch(c){return""}}function xx9(a){return"./images/house"+a+".gif"}function _1d(a){return"./images/power"+a+".png"}function v4h(c,a){var b="mini"+zv0+" card_"+c;switch(a){case 0:return b+"_used";case 2:return b+"_select";default:return b}}function whyx(a){try{return lmm.indexOf(a)}catch(b){return -1}}function y3v(d,a){try{var c=a+d.f6xc();return $(c).title}catch(b){return""}}function fsz(b,a){if(a=="s"&&b<vm25){b+=vm25}else{if(a=="p"&&b<_1_f){b+=vm25+_1_f}}return b}function vrw(a){if(j8nz(a)){return a}else{if(dpx&&cz9(a)){return a-vm25-_1_f}}return a-vm25}function tn4f(a){if(a<vm25){return"l"}else{if(a<vm25+_1_f){return"s"}}return"p"}function r15w(b,a){return mkbf(b,a,false,true)}function mkbf(s,p,h,q){var c=_knq[s],r=c.length,o="";for(var k=0;k<r;k+=3){var b=c.charAt(k),m=c.substr(k+1,2).f6xc(),l=fsz(m,b),a=tx0_(l);if(!lmm.cdp(a)||(!h&&a==j76())||(h&&!h.cdp(a))){continue}var d=nc5(l),e=rnv(l,2)+vnmf(d),g=!p;for(var n=0;!g&&n<p.length;++n){g=p[n].snm(d,l)}if(g){o+=e;if(q){wb7("Order"+l)}}}return o}function x6x9(a,b){return brt(_04m(b),a)}function brt(b,a){return b.charAt(a*3+2)}function vnmf(a){if(typeof a==="number"){return a.toString(16).toUpperCase()}return a}function nc5(b){var a=sd_4()>2?d2t6("ordersall"):_04m(tx0_(b));return b_d(b,a)}function b_d(b,a){var d=rnv(b,2);for(var c=0;c<a.length;c+=3){if(d==a.substr(c,2)){return brt(a,c/3).f6xc()}}return 0}function _04m(a){if(!a){a=j76();if(!a){return""}}switch(a){case"B":return f0s;case"L":return y67;case"S":return _qnc;case"T":return n187;case"G":return x_05;case"M":return fsny;default:return""}}function t__(a,c){var d=c?c:_04m(j76());a=vnmf(a);for(var b=0;b<d.length;b+=3){if(a==d.charAt(b+2)){return d.substr(b,2).f6xc()}}return -1}function nxq(a){switch(a){case 1:return 348;case 12:return 98;case 16:return 212;case 20:return 678;case 27:return 199;case 34:return 585;case 32:if(!xqss){return 585}break;default:break}return Math.round((p40[a][0]+p40[a][2])/2)}function gv7g(a){switch(a){case 1:return 224;case 12:return 649;case 16:return 776;case 20:return 825;case 27:return 1079;case 34:return 1241;case 32:if(!xqss){return 1240}break;default:break}return Math.round((p40[a][1]+p40[a][3])/2)+5}function rms(){for(var b=0;b<_nr1;b++){if(_04m(lmm[b])=="1"){return _hm2(lmm[b])}}for(var b=0;b<_nr1;b++){var a=d2t6("bid"+lmm[b]);if(a==kt_h[0]){return _hm2(lmm[b])}}return STR.HOUSE_U}function s1p(a){return c2d_(a)&&m37f(a)!=j76()}function _j5z(a){return m37f(a)==j76()}function c2d_(a){return fq8.cdp(a)}function w900(){return d2t6("g-cid")!=1}function cl0(){return d2t6("cfg-tbcrds")==1}function w2br(a){return zzp4()?d2t6(a+"tob"):0}function f_vz(){return w2br("attacker")}function _q__(){return w2br("defender")}function nrkx(b){var a=xqss?[1,12,16,30,34,26,20,4]:[1,12,16,29,32,26,20,4];try{return a[b]}catch(c){return -1}}function hb7d(b){var a=xqss?[0,2,3,5,6,8,8,10]:[0,2,3,4,5,7,7,9];try{return a[b]}catch(c){return -1}}function q7r_(b){var a=xqss?[1,12,16,30,34,26,20,4]:[1,12,16,29,32,26,20,4];return a.indexOf(b)}function m37f(d){try{var b=fq8.indexOf(d);if(b>=0){var a=lmm[b];if(mymk(a)){return a}}}catch(c){alert(c)}return"n"}function dsbq(){return d2t6("cfg-dyn")}function j76(){return d2t6("p-phs")}function qjg(b){if(whyx(b)>=0){var a=d2t6("p-h"+b.toLowerCase());if(!a){return _hm2(b)}return decodeURIComponent(a)}return""}function _hm2(a){try{return STR["HOUSE_"+a]}catch(b){return STR.HOUSE_U}}function _9nc(b,a){switch(b){case 0:return b39(a);case 1:return p_zy(a);case 2:return ftq(a);default:return false}}function _sm(b){for(var a=0;a<_nr1;a++){if(_9nc(b,lmm[a])){return lmm[a]}}}function r6_(){return _sm(0)}function gn_6(){return _sm(1)}function fg_(){return _sm(2)}function b39(b){if(b){var a=f_fx.charAt(0);if(a==b||(a=="n"&&b==j6k5())){return true}}return false}function p_zy(b){if(b){var a=f_fx.charAt(1);if(a==b||(a=="n"&&t3vt(b)==1)){return true}}return false}function ftq(b){if(b){var a=f_fx.charAt(2);if(a==b||(a=="n"&&s9m_(b)==1)){return true}}return false}function _zg(a,d){var b=d?a:whyx(a?a:j76());try{return ll1q[b][0]}catch(c){return 0}}function k9d(a,d){var b=d?a:whyx(a?a:j76());try{return ll1q[b][1]}catch(c){return 0}}function qgyl(a){if(a==qjp4()){return vpx()}else{if(a==wt5()){return qws()}}return"n0"}function qjp4(){return d2t6("attacker")}function wt5(){return d2t6("defender")}function vpx(){return d2t6("attackercard")}function qws(){return d2t6("defendercard")}function qsy_(a){return qgyl(a).charAt(1)}function kypb(b){var a;switch(b){case"B":a=0;break;case"L":a=7;break;case"S":a=14;break;case"T":a=21;break;case"G":a=28;break;case"M":a=35;break;default:return"0000000"}return xh_.substr(a,7)}function vd_(a){try{return d2t6("activeplayers").charAt(a)=="1"}catch(b){return true}}function mymk(a){var b=whyx(a);return b>=0?vd_(b):false}function __1(c){for(var b=0;b<_nr1;b++){for(var a=0;a<_nr1;a++){if(b==pt9q(a,c)){if(vd_(a)){return lmm[a]}break}}}}function j6k5(){for(var a=0;a<_nr1;a++){var b=t062(a);if(mymk(b)){return b}}}function zrft(a){switch(a){case 3:return["1","2","3"];case 4:return["4","5","6"];case 5:return["F"];default:return[]}}function t062(a){var c=[];for(var b=0;b<_nr1;b++){c[sv4(b)]=lmm[b]}return c[a]}function sww_(){npv9=0;for(var a=0;a<_nr1;a++){if(vd_(a)){continue}npv9++;try{var c=$("activePlayer"+lmm[a]);c.innerHTML="<strike>"+c.innerHTML+"</strike>"}catch(b){}}if(npv9>0){g794()}}function hvc(){if(npv9>0&&dsbq()){switch(_nr1-npv9){case 6:return 6;case 3:return 8;default:return 7}}return _06}function _dby(a,b){sqy[a]=b}function d2t6(a){try{return sqy[a]}catch(b){return 0}}function x6p_(){this.trooper=0;this.knight=0;this.siege=0;this.ship=0}function gwm4(a){switch(a){case"FM":return sfb;case"KT":return p_qn;case"SE":return jcks;case"SP":return xt_y;default:return 0}}function y4v(c,a){var b=0,d=-1;while(++d<vm25){if(c==tv6p(d)){b+=xcjj(d,a)}}return b}function s5v(b){var a=0,c=-1;while(++c<_1_f){if(b==b12j(c)){a+=rypy(c)}}return a}function rqt1(c){var b=0,a=-1;while(dpx&&++a<nq5l){if(c==vxs(a)){b+=m6_(a)}}return b}function hkbt(a){return s5v(a)+rqt1(a)}function h0nv(a){return y4v(a,1)}function qzs(a){return y4v(a,2)}function k9tw(a){return y4v(a,3)}function sf50(){return k_2p()?s_dt()+lz32()+_r5():xl0()}function hm_t(a){if(a<vm25){return _9v(a)}else{if(a<vm25+_1_f){return rypy(a-vm25)}else{if(dpx){return m6_(a-vm25-_1_f)}else{return 0}}}}function rypy(a){return parseInt(g4_(a).charAt(1))}function m6_(a){return dpx?parseInt(_dmx.charAt(a)):0}function xnw3(a){return xcjj(a,1)}function h_0n(a){return xcjj(a,2)}function fnd(a){return xcjj(a,3)}function _x1g(a,c){if(c.jyc2(0,4)){try{pjh=pjh.ybz_(a,c)}catch(b){pjh="000".ybz_(a,c)}}}function t1f(a){_x1g(0,s_dt()+a)}function z0x(a){_x1g(1,lz32()+a)}function y9_(a){_x1g(2,_r5()+a)}function yc77(a){h0rw(xl0()+a)}function _1z(a){_x1g(0,a)}function _3b_(a){_x1g(1,a)}function _l47(a){_x1g(2,dp37>0?a:0)}function h0rw(a){pjh=a}function jk_(a){try{return typeof pjh!="number"?parseInt(pjh.charAt(a)):pjh}catch(b){return 0}}function s_dt(){return k_2p()?jk_(0):0}function lz32(){return k_2p()?jk_(1):0}function _r5(){return k_2p()&&dp37>0?jk_(2):0}function xl0(){return xy8()?jk_(0):0}function _9v(a){return xnw3(a)+h_0n(a)+fnd(a)}function h6_m(d,a){var c=0;for(var b=0;b<a.length;b++){if(!a[b][6]&&a[b][2]==d){c++}}return c}function bzv(a){return h6_m(a,gwm4("FM"))}function _10(a){return h6_m(a,gwm4("KT"))}function mf1(a){return h6_m(a,gwm4("SE"))}function _s8b(a){return h6_m(a,gwm4("SP"))}function y_tx(b,a,c){if(c.jyc2(0,9)){l0f(b,a,c)}}function _s3(a,b){y_tx(a,1,b)}function b9tq(a,b){y_tx(a,2,b)}function _3x6(a,b){y_tx(a,3,b)}function m3x(a,b){if(b<=glb){_8bd=b<1?_8bd.ybz_(a*2,"n0"):_8bd.ybz_(a*2+1,b)}}function s4m(a,b){if(b.jyc2(0,glb)){_dmx=_dmx.ybz_(a,b)}}function xm8_(f,d,b,g){var a,e;if(g==0){return}switch(b){case"FM":a=3;break;case"KT":a=4;break;case"SE":a=5;break;case"SP":a=5;if(f<vm25){f+=vm25}break;default:return false}e=z31.indexOf(d+rnv(f,2));if(e>=0){g=parseInt(z31.charAt(e+a))+g;z31=z31.ybz_(e+a,g<0?0:g)}else{if(g.jyc2(0,4)){var c=d+rnv(f,2)+"000";z31+=c.ybz_(a,g)}}z31=z31.replace(/[a-zA-Z][0-9][0-9]000/g,"")}function wtyr(b,a,c){xm8_(b,a,"FM",c)}function zn1(b,a,c){xm8_(b,a,"KT",c)}function c7v(b,a,c){xm8_(b,a,"SE",c)}function svt2(b,a,c){xm8_(b,a,"SP",c)}function _86(c,b,d){if(d==0){return}var a=xcjj(c,b);y_tx(c,b,a+d)}function py_f(a,b){_86(a,1,b)}function msb(a,b){_86(a,2,b)}function g10h(a,b){_86(a,3,b)}function jr3(a,b){m3x(a,rypy(a)+b)}function gs1g(a,b){s4m(a,m6_(a)+b)}function _0k(b,a){py_f(b,-1);py_f(a,1)}function rj3(b,a){msb(b,-1);msb(a,1)}function tq2(b,a){g10h(b,-1);g10h(a,1)}function cj1(b,a){b<SEA_UNITS?jr3(b,-1):gs1g(b-SEA_UNITS,-1);a<SEA_UNITS?jr3(a,1):gs1g(a-SEA_UNITS,1)}function xm69(a){x0nk(a,1)}function dqg(a){x0nk(a,2)}function _ry(a){x0nk(a,3)}function hg7(){if(b66!=d2t6("land")||_8bd!=d2t6("sea")||_dmx!=d2t6("port")){return true}}function gvp(){var d=j76(),e=whyx(d),g=e*jsx,b=e*y2b,f=e*dp37,c=e*glb;for(var a=g;a<g+jsx;a++){wb7(d+"FM"+a)}for(var a=b;a<b+y2b;a++){wb7(d+"KT"+a)}for(var a=f;a<f+dp37;a++){wb7(d+"SE"+a)}for(var a=c;a<c+glb;a++){wb7(d+"SP"+a)}}function x0nk(c,a){var d=k43(c),b=a>1?2:1;if(r70[d][1]>=b){q263();_86(c,a,1);p15z();pln_(b66,_8bd,_dmx);r70[d][1]-=b;if(a==1){f8b()}_40(d)}}function knp6(d,b){var a=sd_4(),e=k43(d);if(r70[e][1]>0){q263();py_f(d,-1);b?g10h(d,1):msb(d,1);if(a>4){if(bzv(d)>xnw3(d)){var c=tv6p(d);wtyr(d,c,-1);b?c7v(d,c,1):zn1(d,c,1)}}p15z();r70[e][1]--;if(a<6){f8b();_40(e)}else{if(a==10){ts_();m0d();jf3_()}}}}function by_n(c){var a,b=j76(),d=k43(c);_5l5();if(r70[d][1]<1){bhh(STR.EVT_MUSTER_NEW+"\n"+STR.EVT_MUSTER_NO_MP)}else{if(r70[d][1]==1&&h0nv(b)>=jsx){bhh(STR.EVT_MUSTER_NEW+"\n"+STR.EVT_MUSTER_NO_FOOTMEN)}else{a=b66.ybz_(c*8+1,xnw3(c)+1);if(!pln_(a,_8bd,_dmx,null,false)){bhh(STR.EVT_MUSTER_NEW+"\n"+STR.EVT_MUSTER_LOW_SUPPLY)}else{if(dp37==0||r70[d][1]==1||(y2b==qzs(b)&&dp37==k9tw(b))){xm69(c)}else{nh6b(c)}}}}}function _spc(d,c){var f=j76(),b=sd_4(),g=sfb[c][2];if(f&&[0,5,8,9,10].cdp(b)){if(b>7&&qws()=="M4"&&d=="M"&&g==c05y&&r70[0][0]==c05y&&r70[0][1]>0){knp6(g);return true}if(m0xj&&w58(d+"FM"+c)&&(b==5||b==10||cdsz())){q263();var h=k43(g),a=qzs(d),e=dp37>0?k9tw(d):0;if(h<0||r70[h][1]<1){bhh(STR.EVT_MUSTER_UP+"\n"+STR.EVT_MUSTER_NO_MP)}else{if(d==f&&(y2b>a||dp37>e)&&(b==0||b==5||(b==10&&y2b>a&&(vpx()=="B6"||qws()=="B6")))){if(b<6&&dp37>e){if(a==y2b){knp6(g,true)}else{nh6b(g,true)}}else{knp6(g)}}else{if(m0xj&&f==d){bhh(STR.EVT_MUSTER_UP+"\n"+STR.EVT_MUSTER_NO_KNIGHTS)}}}}}}function nh6b(c,a){var b=j76();content='<table cellspacing=8 cellpadding=2 class="musterwindow overlay_shadow"><tr><th colspan=3>'+y3v(c,"l")+":</th></tr><tr>";if(!a&&h0nv(b)<jsx){content+='<th><div onclick="xm69('+c+')" class="u_base u_FM'+b+'" style="cursor:pointer;"></div></th>'}else{content+='<th><div class="u_base u_FM'+b+' musternot">N/A</div></th>'}if(qzs(b)<y2b){content+="<th><div "+(a?'onclick="knp6('+c+')" ':'onclick="dqg('+c+')" ')+'class="u_base u_KT'+b+'" style="cursor:pointer;"></div></th>'}else{content+='<th><div class="u_base u_KT'+b+' musternot">N/A</div></th>'}if(k9tw(b)<dp37){content+="<th><div "+(a?'onclick="knp6('+c+', true)" ':'onclick="_ry('+c+')" ')+'class="u_base u_SE'+b+'" style="cursor:pointer;"></div></th>'}else{content+='<th><div class="u_base u_SE'+b+' musternot">N/A</div></th>'}_9c(content+"</tr></table>",p40[c][0]-50,p40[c][1]-80)}function g_lh(b){var a=_dmx,c=j76(),d=nrkx(b),e=k43(d);q263();_5l5();if(r70[e][1]<1){bhh(STR.EVT_MUSTER_NEW+"\n"+STR.EVT_MUSTER_NO_MP_SHIP)}else{if(r70[e][1]==1&&hkbt(c)>=glb){bhh(STR.EVT_MUSTER_NEW+"\n"+STR.EVT_MUSTER_NO_SHIPS)}else{gs1g(b,1);if(!pln_(b66,_8bd,_dmx)){_dmx=a;bhh(STR.EVT_MUSTER_NEW+"\n"+STR.EVT_MUSTER_LOW_SUPPLY)}else{_qd();r70[e][1]--;_40(e)}}}}function gm2k(e){var g=_knq[e+vm25].match(/.{1,3}/g),b="",k,f=_8bd;while(g.length>0){var c=g.pop(),a=c.charAt(0),h=c.substr(1);if(a=="l"&&vhz.cdp(c)){for(var d=0;d<8;d++){if(r70[d][0]&&r70[d][0]==h.f6xc()&&r70[d][1]>0){b+=c;break}}}}if(b.length<3){bhh(STR.EVT_MUSTER_NEW+"\n"+STR.EVT_MUSTER_NO_MP_SHIP)}else{if(b12j(e)=="n"){rr_(e,j76())}jr3(e,1);k=pln_(b66,_8bd,_dmx,null,false);_8bd=f;if(!k){bhh(STR.EVT_MUSTER_NEW+"\n"+STR.EVT_MUSTER_LOW_SUPPLY)}else{if(b.length>3){kvb9(e,b)}else{wl_(e,b.substr(1,2).f6xc())}}}}function wl_(b,a){q263();var c=-1;while(++c<8){if(r70[c][0]==a&&r70[c][1]>0){if(b12j(b)=="n"){rr_(b,j76())}jr3(b,1);_qd();pln_(b66,_8bd,_dmx);r70[c][1]--;_40(c);break}}}function f8b(){var c=j76(),a=c+"FM";for(var b=0;b<_nr1*jsx;b++){if(sfb[b][4]==c){n95(a+b);if(sfb[b][2]>=0&&dr5m(sfb[b][2])){wb7(a+b)}}}}function ym5y(b,a,f){var k=ysf();var d=false;if(m0xj&&a==j76()&&(k||wb_j())){var h=gwm4(f)[b][2];if(hzd<1){bhh(STR.EVT_SUPPLY_OK_ALREADY)}else{if(k&&pln_(b66,_8bd,_dmx)){bhh(STR.EVT_MUSTER_SUPPLY)}else{if(f!="SP"){var c=_9v(h)==1;if(k&&c){bhh(STR.EVT_SUPPLY_SINGLE_UNIT);return 0}switch(f){case"FM":py_f(h,-1);break;case"KT":msb(h,-1);hzd--;break;case"SE":g10h(h,-1);hzd--;break;default:break}if(c&&!fjrn(h)){j5ct(h);if(__zb(h)){_qd()}}p15z();d=!c}else{var g=h>=_1_f,e=g?m6_(h-_1_f):rypy(h),c=e==1;if(c&&k){bhh(STR.EVT_SUPPLY_SINGLE_UNIT);return 0}if(g){gs1g(h-_1_f,-1)}else{jr3(h,-1)}_qd();d=!c}}}hzd--;if(d){pln_(b66,_8bd,_dmx)}}}function zh0(){return false}function _09(){return true}function grj(){return"BATTLE_CARD2"}function b46l(a){return false}function rg2(c,a){if(c=="L7"&&!b46l(a)){var b=bv9("L",2);if(j76()!="L"){l9cf+="\n\n"+STR.format(STR.BATTLE_PT_GAIN_NAME,[STR.HOUSE_L,b])}else{l9cf+="\n\n"+STR.format(STR.BATTLE_PT_GAIN,[b])}document.finishBattleForm.Lannisterpos.value=_qks(1)}}function fyd(a){return["B6","L1"].cdp(a)}function bc_(b,a){if(b46l(a)){return false}if(b=="B6"){if(y2b>qzs("B")){return true}}else{if(b=="L1"){return true}}return false}function rc0(a){var c=[0,0,1,1,2,2,3,4],b=0,e=vpx(),d=qws();if(sd_4()>7){if(a==mn4x){b=parseInt(e.charAt(1))}else{if(a==msj){b=parseInt(d.charAt(1))}}}return c[b]}function rj7(){var a=_03h();content='<table class="box_extend box_game_state"><tr><th valign="top"><small>'+STR.DLG_MAIN_AOF+"<br></small>";if(_nr1>ff0(a)){content+='<br><br><span style="float:left;width:25px;"><img src="./images/throne.gif" title="'+STR.SPECIAL_TOKEN_THRONE+'"></span><span style="float:left;width:25px;"><input type="radio" style="cursor:pointer" name="token" id="throne" onclick="document.finishBattleForm.trackid.value=1"></span><label for="throne" style="cursor:pointer"><small>'+STR.TRACK_THRONE+"</small></label>"}if(_nr1>t3vt(a)){content+='<br><br><span style="float:left;width:25px;"><img src="./images/sword.gif" title="'+STR.SPECIAL_TOKEN_BLADE+'"></span><span style="float:left;width:25px;"><input type="radio" style="cursor:pointer" name="token" id="blade" onclick="document.finishBattleForm.trackid.value=2"></span><label for="blade" style="cursor:pointer"><small>'+STR.TRACK_FIEFDOMS+"</small></label>"}if(_nr1>s9m_(a)){content+='<br><br><span style="float:left;width:25px;"><img src="./images/raven.gif" title="'+STR.SPECIAL_TOKEN_RAVEN+'"></span><span style="float:left;width:25px;"><input type="radio" style="cursor:pointer" name="token" id="raven" onclick="document.finishBattleForm.trackid.value=3"></span><label for="raven" style="cursor:pointer"><small>'+STR.TRACK_COURT+"</small></label>"}content+="</th></tr></table>";$("leak_menu").innerHTML=content;$("leak_menu").style.left=-1;$("leak_menu").style.top=tb4($("gameStateField"))-23;_bq();_5l5()}function r06r(){if(__j()){return false}return true}function __j(){if(_8jj()=="S"&&(vpx()=="S6"||qws()=="S6")){return true}return false}function _h1(){if(sd_4()!=8||d2t6("bidL")==1||(vpx()!="L3"&&qws()!="L3")){return false}return true}function m8z_(){if(!mymk("G")||sd_4()!=8||d2t6("bidG")==1||ll1q[4][0]<2||kypb("G")._jj("1")==1||(vpx()!="G1"&&qws()!="G1")){return false}return true}function _z75(){var b=vpx(),a=qws();if(!mymk("G")||b46l(b)||b46l(a)||(b.sxk("G")&&d2t6("attackersupporters").length>0)||(a.sxk("G")&&d2t6("defendersupporters").length>0)||v70(c05y,"G")>0||hp_(c05y,"G")>0){return false}return true}function _8cc(){if(!mymk("G")||qws()!="G5"||b46l(vpx())||xy8()||b66.charAt(c05y*8+5)=="0"){return false}return true}function vjb(){if(!mymk("T")||sd_4()!=8||d2t6("bidT")==1||(vpx()!="T1"&&qws()!="T1")){return false}var d=xy8()?(c05y+vm25):c05y,c=[new nms()],b=mn4x!="T"?mn4x:msj,a=mkbf(d,c,b,false);return a.length>0}function nms(){this.areaOffset=k_2p()?0:-vm25}nms.prototype.snm=function(a,b){return a>0&&(!_ng_(a)||b+this.areaOffset!=_kn7)};function ryp3(){if(!mymk("T")||vpx()!="T6"||qws()=="M2"||sf50()<=0||b46l(qws())){return false}return true}function q2j(){if(!mymk("M")||sd_4()!=8||d2t6("bidM")==1||(vpx()!="M1"&&qws()!="M1")){return false}return true}function w59(){if(qws()!="M2"){return true}return false}function nq9v(c){var d=c.charAt(0),e=["G1","T1","M1"],a=c==vpx()?qws():vpx(),b=a.charAt(0);if(!z_ym(c)){return false}if(a!="G1"&&d2t6("bid"+b)!=1&&e.cdp(a)&&z_ym(a)&&ff0(d)>ff0(b)){return false}return true}function z_ym(a){if((a=="G1"&&!m8z_())||(a=="T1"&&!vjb())||(a=="M1"&&!q2j())){return false}return true}function mmt3(b){var e=0,c=b.charAt(0),d=c==mn4x,f=j073(c);switch(b){case"B2":e=1;break;case"B4":e=f?1:-1;break;case"B5":e=d2t6("cards").charAt(6)=="0"?1:0;break;case"L4":e=-2;break;case"L5":e=1;break;case"L6":e=3;break;case"S3":e=-2;break;case"S4":e=1;break;case"S7":e=2;break;case"T2":e=-1;break;case"T3":e=-1;break;case"T4":e=1;break;case"T5":e=2;break;case"G2":e=_z75()?(f?2:-1):0;break;case"G3":e=f?1:-1;break;case"G5":e=_8cc()?1:0;break;case"G7":e=1;break;case"M3":e=d?1:-1;break;case"M4":e=1;break;case"M5":e=1;break;case"M6":e=-1;break;case"M7":e=f?2:-1;break;default:break}if((e>0&&!f)||(e<0&&f)){e=0}if(cl0()){var a=j75(d?"attacker":"defender");if((a>0&&f)||(a<0&&!f)){e+=a}}if(e>0){if((d&&qws()=="S2")||(!d&&vpx()=="S2")){e=0}}return e}function cn1y(){var a=document.phaseAForm,b=a.type.value;if(b=="B6"){if(b66!=d2t6("land")){a.proceed.disabled=true;a.land.value=b66}else{if(!confirm(STR.CNFM_NO_UPGRADE)){return false}ts_()}}else{if(b=="L1"){if((f0s+y67+_qnc+n187+x_05+fsny)==d2t6("ordersall")){if(!confirm(STR.CNFM_NO_ENEMY_ORDER)){return false}}n95(a.proceed);a.proceed.disabled=true;a.ordersB.value=f0s;a.ordersL.value=y67;a.ordersS.value=_qnc;a.ordersT.value=n187;a.ordersG.value=x_05;if(_nr1==6){a.ordersM.value=fsny}a.routedunits.value=z31}}s45()}function srf(){var a=document.phaseAForm;if(!a.cardstring.value.length){if(!confirm(STR.CNFM_NO_ENEMY_CARD)){return false}a.cardstring.value="CONFIRMED";a.submit()}else{if(a.cardstring.value.length==7){a.proceed.disabled=true}}s45()}function _hnn(g){var e=j76();if(g=="B6"){if(k_2p()){var d=0,a=_knq[c05y],f=qws()!="M2"?c05y:_kn7;a+="l"+rnv(f,2);ggp();vhz="";for(var c=0;c<_nr1*jsx;c++){if(sfb[c][4]==e){var b=sfb[c][2];if(a.cdp("l"+rnv(b,2))&&(sfb[c][2]==f||(sfb[c][5]>6&&sfb[c][5]<10))){r70[d][0]=sfb[c][2];r70[d++][1]=1;ts_();ylkp("l"+b,"#FCFC00");wb7(e+"FM"+c)}else{n95(e+"FM"+c)}}}}}else{if(g=="L1"){if(e==mn4x){p83f(msj)}else{p83f(mn4x)}}}}function lmw(b,l){if(b46l(b)||b46l(l)){return}var e=false;if(b=="B3"&&(d2t6("attackersupport")>0||hp_(c05y,"B")||v70(c05y,"B"))){var a=msj;wr0x=wr0x-d2t6("attackerseasupport")+tp9(d2t6("attackersupporters"));qtv=qtv-hp_(c05y,a)-d2t6("defenderseasupport")+tp9(d2t6("defendersupporters")+a);if(xy8()){qtv=qtv-parseInt(_8bd.charAt(c05y*2+1))+_s8b(c05y)}}else{if(l=="B3"&&(d2t6("defendersupport")>0||hp_(c05y,"B")||v70(c05y,"B"))){var a=mn4x;qtv=qtv-d2t6("defenderseasupport")+tp9(d2t6("defendersupporters"));wr0x=wr0x-hp_(c05y,a)-d2t6("attackerseasupport")+tp9(d2t6("attackersupporters")+a);if(xy8()){wr0x-=xl0()}e=true}else{if(b=="B5"&&d2t6("cards").charAt(6)=="0"){wr0x+=1}else{if(l=="B5"&&d2t6("cards").charAt(6)=="0"){qtv+=1}else{if(b=="B7"&&ff0(mn4x)>ff0(msj)){wr0x+=1}else{if(l=="B7"&&ff0(msj)>ff0(mn4x)){qtv+=1}}}}}}if(b=="L2"&&k_2p()){var h=s_dt(),g=_99(c05y,"L");if(h>0&&l=="T7"){h--}wr0x+=h+g}if(l=="S1"){if(vrbs(_qnc,["A","B"],c05y)){qtv+=1}else{if(vrbs(_qnc,["C"],c05y)){qtv+=2}}}if(b=="T7"&&l!="S2"&&k_2p()){var c=xnw3(c05y);if(c>0){if(c>bzv(c05y)){qtv-=1}th_6[4]+=1;py_f(c05y,-1);if(_9v(c05y)==0){y6m(c05y,wt5());if(_0yd(c05y)==0){j5ct(c05y);var d=b66.charAt(c05y*8);if(d!="n"&&d!=d2t6("land").charAt(c05y*8)&&__zb(c05y)){_qd();var f=q7r_(c05y),k=vm25+_1_f+f;y6m(k,wt5())}}}p15z()}}else{if(l=="T7"&&b!="S2"&&s_dt()>0){th_6[4]+=1;availableTroopers=xnw3(_kn7);if(s_dt()==1&&!fjrn(_kn7)&&_9v(_kn7)==1){j5ct(_kn7);if(__zb(_kn7)){qd9(_kn7);_qd()}}else{if(availableTroopers>0){py_f(_kn7,-1)}}t1f(-1);wr0x-=1;p15z()}}if(b=="G4"){qtv-=rc0(msj)}else{if(l=="G4"){wr0x-=rc0(mn4x)}else{if(_8cc()){qtv+=1}else{if(!e&&b=="G6"){var m=_k0(c05y,"G");wr0x+=xl0()+m}}}}_15+=wr0x;kpc+=qtv}function wq_l(c){var e=vpx(),d=qws(),b=c==mn4x?e:d,a=b!=e?e:d;if(!bc_(b,a)){return}if(b=="B6"){if(!xy8()&&$("AvailKnightB").innerHTML.f6xc()!=y2b&&(_99(c05y,"B")>0||(d=="B6"&&xnw3(c05y)>0)||(e=="B6"&&s_dt()>0))){document.finishBattleForm.aphaseplayer.value=c}}else{document.finishBattleForm.aphaseplayer.value=c}}function _l70(c,a,b){extAreaOver("WesterosMapImg",c,a,b)}function ylkp(b,a){_l70(b,a,35)}function ts_(){extAreaOut("WesterosMapImg")}function _1j(b,a){k14(b,a,true)}function k14(c,b,a){if(a){ts_()}j_w6(c,0,b);x_6(c,0,b)}function zy89(){var a=["#FCFC00","#991100","#EEEEEE","#33EE33","#111111","#FFAA11"];k14("n","#3333F0",0);for(var b=0;b<_nr1;b++){if(vd_(b)){k14(lmm[b],a[b],0)}}}function j_w6(f,a,c){for(var d=0;d<vm25;d++){var e=b66.charAt(d*8),b=b66.charAt(d*8+a);if(e==f&&(a==0||(a!=4&&b!="0")||(a==4&&b=="1"))){ylkp("l"+d,c)}}}function x_6(d,a,b){for(var c=0;c<_1_f;c++){if(b12j(c)==d&&(a==0||rypy(c)>0)){_l70("s"+c,b,38)}}for(var c=0;c<nq5l;c++){if(m6_(c)>0&&vxs(c)==d){ylkp("p"+c,b)}}}function g3_v(){var e=_nr1*jsx,d=_nr1*y2b,c=_nr1*dp37,a=_nr1*glb;for(var b=0;b<e;b++){dyj6(sfb[b][3],sfb[b][1]);if(!sfb[b][6]){d75(sfb[b][3],"u_routed")}if(b<d){dyj6(p_qn[b][3],p_qn[b][1]);if(!p_qn[b][6]){d75(p_qn[b][3],"u_routed")}}if(b<c){dyj6(jcks[b][3],jcks[b][1]);if(!jcks[b][6]){d75(jcks[b][3],"u_routed")}}if(b<a){dyj6(xt_y[b][3],xt_y[b][1]);if(!xt_y[b][6]){d75(xt_y[b][3],"u_routed")}}}}function fvs(c,b){if(cdt>0&&cdt<4&&d2t6("bidcount")>=_nr1){var a=document.images["aof"+cdt+c];n95(a);if(b&&a.src.cdp("empty.gif")&&b39(j76())){a.src="./images/house_empty2.gif";mws(a)}else{if(a.src.cdp("empty2.gif")){a.src="./images/house_empty.gif"}}}}function v8k3(d,c){if(tx0_(d)!=j76()){var b="OrderSelect"+d,a="Order"+d;if(c&&w58(a)){$(b).style.left=$(a).style.left;$(b).style.top=$(a).style.top;dyj6(b,v0sd);d75(b,"o_map o_select2")}else{s2j(b)}}}function y6h(c,d){var b=sd_4(),e=parseInt(c.substr(3),10),a=d=="_select";type=c.substr(1,2),units=gwm4(type);if(units){if(a||(c05y<0&&((units[e][0]&&a)||(m0xj&&b>=4&&!units[e][0]&&units[e][6]&&units[e][4]==j76()&&units[e][5]>=4&&units[e][5]<=6&&kw7==_04m())))){dyj6(c,"u_base u_map");d75(c,"u_"+type+d);if(!a){wb7(c)}}}}var gbv=-1;function p65(d){var f=0,a=-1,e=d.substr(1,2),c=gwm4(e);if(sd_4()!=4||!c||c05y>=0||!w58(d)){return}while(c[f][3]!=d){f++}a=c[f][2];if(e=="SP"){a+=vm25}if(gbv>=0&&gbv!=a&&kw7==_04m()){a=c[f][2];lmgw(4);tc2()}if(m0xj&&!c[f][0]&&c[f][5]>=4&&c[f][5]<=6&&c[f][4]==j76()&&kw7==_04m()){y6h(d,"_select");c[f][0]=true;gbv=c[f][2];if(e=="SP"){gbv+=vm25}xh6++;var b=xh6;s_fh(c[f][5]);if(b!=xh6){y6h(d,"_select");c[f][0]=true;xh6++}}else{if(c[f][0]&&c[f][4]==j76()){c[f][0]=false;xh6--;y6h(d,"_hover");if(xh6<=0){vbb()}}}}function tc2(){var e=jsx*_nr1,d=y2b*_nr1,c=dp37*_nr1,a=glb*_nr1;xh6=0;vbb();for(var b=0;b<e;b++){if(sfb[b][0]){sfb[b][0]=false;dyj6(sfb[b][3],sfb[b][1])}if(b<d&&p_qn[b][0]){p_qn[b][0]=false;dyj6(p_qn[b][3],p_qn[b][1])}if(b<c&&jcks[b][0]){jcks[b][0]=false;dyj6(jcks[b][3],jcks[b][1])}if(b<a&&xt_y[b][0]){xt_y[b][0]=false;dyj6(xt_y[b][3],xt_y[b][1])}}}function s2j(a){zsz(a,-1250,0)}function zsz(f,a,d){try{var c=_xg(f);c.style.left=a+"px";c.style.top=d+"px"}catch(b){}}function b1l(c){if(!xqss){var a,d,b;if(c=="101"){b="crown";a=180;d=1240}else{if(c=="200"){b="stronghold";a=144;d=1200}}if(b){zsz("oldtownPosition",a,d);$("oldtownContent").innerHTML='<img name="oldtownE" src="./images/extra_'+b+'.gif">'}}}function dnj(){var a=[0,0,0,0,0,0,0],e,d;for(var c=0;c<_nr1;c++){for(var b=0;b<7;b++){e="supply"+b+c;document.images[e].src="./images/blind.gif"}}for(var c=0;c<_nr1;c++){d=zxc8(lmm[c]);e="supply"+d+""+a[d];document.images[e].src=xx9(lmm[c]);a[d]++}if(j76()){v6cc();pln_(b66,_8bd,_dmx)}}function _n0(){var c=sd_4(),e=["THRONE","FIEFDOMS","COURT"],g,d;if(c==0){l_q0=d2t6("houses")}for(var f=0;f<6;f++){d=whyx(lmm[f]);for(var b=1;b<4;b++){var a=pt9q(d,b-1);g="aof"+b+a;if(c!=0||cdt>b||_nr1<=f||!lyys()||(b==1&&(f_fx.charAt(0)==lmm[f]||(f_fx.charAt(0)=="n"&&g=="aof11")))){document.images[g].src=xx9(lmm[f])}else{document.images[g].src="./images/house_empty.gif"}document.images[g].title=STR["TRACK_"+e[b-1]]+" #"+a}if(f==4&&_nr1<6){break}}___c()}function ___c(){var e,f,c,b=[b331(1),b331(2),b331(3)];if(pfdm==1){b[1]="./images/sword_used.gif"}for(var a=0;a<3;a++){for(var d=1;d<_nr1+1;d++){f="bgAof"+(a+1)+""+d;$(f).style.backgroundImage=""}e=f_fx.charAt(a);if(e!="n"&&(!lyys()||(a==0&&d2t6("bidcount")<_nr1))){c=whyx(e);f="bgAof"+(a+1)+""+pt9q(c,a)}else{f="bgAof"+(a+1)+"1"}$(f).style.backgroundImage="url("+b[a]+")"}}function _hmv(){l_q0=d2t6("houses");for(var a=0;a<_nr1;a++){try{ll1q[a][0]=kd05(a);ll1q[a][1]=_1m(lmm[a],"power");$("AvailPower"+lmm[a]).innerHTML=ll1q[a][0]}catch(b){ll1q[a--]=[]}}}function w2m(){for(var d=0;d<_nr1;d++){for(var b=0;b<7;b++){var a=parseInt(xh_.charAt(d*7+b)),e=$("c_icon_"+lmm[d]+(b+1)),c=v4h(lmm[d],a);dyj6(e,c)}}if(sd_4()==10){j1hg()}}function tf8(b,a){l_q0=l_q0.ybz_(b*6+4,rnv(a,2))}function _mhb(){this.B=0;this.L=0;this.S=0;this.T=0;this.G=0;this.M=0}function p15z(){if(!b66){return}var p=sd_4(),u,n,q,b,m,o=new _mhb(),c=new _mhb(),f=new _mhb();try{for(var g=0;g<vm25;g++){u=0;q=tv6p(g);s2j("PT"+g);if(q=="n"){continue}if(!lmm.cdp(q)){throw (STR.format(STR.ERR_AREA_OWNER,[q,y3v(g,"l")]))}b=_0yd(g);if(b>1){dyj6("PT"+g,"default");$("PT"+g).src="./images/garrison.png";$("PT"+g).title=STR.format(STR.TTIP_GARRISON,[_hm2(q),b]);$("PT"+g).style.left=nxq(g)-6;$("PT"+g).style.top=gv7g(g)-4}else{if(b==1||(b==0&&c2d_(g)&&w900())){dyj6("PT"+g,"power_token"+(b==0?"100":""));$("PT"+g).src=_1d(b==1?q:m37f(g));$("PT"+g).title=STR.format(STR.TTIP_AREA_CTRL,[_hm2(q)]);$("PT"+g).style.left=nxq(g);$("PT"+g).style.top=gv7g(g)}}m=dp37>0?fnd(g):0;for(var v=0;v<m;v++){n=f[q]+dp37*whyx(q);$(jcks[n][3]).style.left=p40[g][u*2];$(jcks[n][3]).style.top=p40[g][u*2+1];$(jcks[n][3]).title=STR.format(STR.UNIT_OWNER,[STR.UNIT_SIEGE,_hm2(q)]);if(jcks[n][2]>=0&&jcks[n][2]!=g){wv2($(jcks[n][3]))}jcks[n][2]=g;f[q]+=1;u++;if(f[q]==dp37){break}}m=h_0n(g);for(var d=0;d<m;d++){n=c[q]+y2b*whyx(q);$(p_qn[n][3]).style.left=p40[g][u*2];$(p_qn[n][3]).style.top=p40[g][u*2+1];$(p_qn[n][3]).title=STR.format(STR.UNIT_OWNER,[STR.UNIT_KNIGHT,_hm2(q)]);if(p_qn[n][2]>=0&&p_qn[n][2]!=g){wv2($(p_qn[n][3]))}p_qn[n][2]=g;c[q]+=1;u++;if(c[q]==y2b){break}}m=xnw3(g);for(var r=0;r<m;r++){n=o[q]+jsx*whyx(q);$(sfb[n][3]).style.left=p40[g][u*2];$(sfb[n][3]).style.top=p40[g][u*2+1];$(sfb[n][3]).title=STR.format(STR.UNIT_OWNER,[STR.UNIT_FOOTMAN,_hm2(q)]);if(sfb[n][2]>=0&&sfb[n][2]!=g){wv2($(sfb[n][3]))}sfb[n][2]=g;o[q]+=1;u++;if(o[q]==jsx){break}}}var h=!ls73&&(p==5||cdsz());for(var g=0;g<6;g++){var a=lmm[g];$("AvailKnight"+a).innerHTML=!h?c[a]:y2b-c[a];$("AvailInf"+a).innerHTML=!h?o[a]:jsx-o[a];for(f[a];f[a]<dp37;f[a]++){n=f[a]+dp37*g;s2j(jcks[n][3]);jcks[n][2]=-1}for(c[a];c[a]<y2b;c[a]++){n=c[a]+y2b*g;s2j(p_qn[n][3]);p_qn[n][2]=-1}for(o[a];o[a]<jsx;o[a]++){n=o[a]+jsx*g;s2j(sfb[n][3]);sfb[n][2]=-1}if(g+1==5&&_nr1<6){break}}h_w();pqg7();if(z31||z31!=d2t6("routedunits")){vx5()}}catch(l){bhh(l+"\n"+STR.ERR_CONTACT);return}}function k4g(a){var l,g,h,k,f=_dmx.length;for(var c=0;c<f;c++){k=nrkx(c);l=tv6p(k);if(l=="n"||(sd_4()>=8&&k==c05y&&k_2p()&&d2t6("takeover")==0&&l!=d2t6("land").charAt(k*8))){s4m(c,0);continue}g=m6_(c);for(var b=0;b<g;b++){h=a[l]+glb*whyx(l);try{$(xt_y[h][3]).style.left=bwjt[c][b*2];$(xt_y[h][3]).style.top=bwjt[c][b*2+1];$(xt_y[h][3]).title=STR.format(STR.UNIT_OWNER,[STR.UNIT_SHIP,_hm2(l)]);if(xt_y[h][2]>=0&&xt_y[h][2]!=_1_f+c){wv2($(xt_y[h][3]))}xt_y[h][2]=_1_f+c;a[l]+=1;if(a[l]==glb){s4m(c,b+1);break}}catch(d){}}}return a}function _qd(){if(!_8bd){return}var l=sd_4(),h=0,k,m,b=new _mhb();try{for(var d=0;d<_1_f;d++){m=b12j(d);if(m=="n"){continue}if(!lmm.cdp(m)){throw (STR.format(STR.ERR_AREA_OWNER,[m,y3v(d,"s")]))}h=rypy(d);for(var c=0;c<h;c++){k=b[m]+glb*whyx(m);$(xt_y[k][3]).style.left=wq_[d][c*2];$(xt_y[k][3]).style.top=wq_[d][c*2+1];$(xt_y[k][3]).title=STR.format(STR.UNIT_OWNER,[STR.UNIT_SHIP,_hm2(m)]);if(xt_y[k][2]>=0&&xt_y[k][2]!=d){wv2($(xt_y[k][3]))}xt_y[k][2]=d;b[m]+=1;if(b[m]==glb){break}}}if(dpx){b=k4g(b)}var f=!ls73&&(l==5||cdsz());for(var d=0;d<6;d++){var a=lmm[d];$("AvailShip"+a).innerHTML=!f?b[a]:glb-b[a];while(b[a]<glb){k=b[a]+glb*d;s2j(xt_y[k][3]);xt_y[k][2]=-1;b[a]++}if(d==4&&_nr1<6){break}}if(z31||z31!=d2t6("routedunits")){vx5()}}catch(g){bhh(k+"\n"+g+"\n"+STR.ERR_CONTACT);return}}function h_w(){if(y7q){for(var b=15;b<vm25;b++){var a=b66.charAt(b*8);units=b66.charAt(b*8+1);if(a=="n"&&units!="0"){$("nf"+b).style.left=Math.round((p40[b][2]+p40[b][6])/2);$("nf"+b).style.top=Math.round((p40[b][3]+p40[b][7])/2);$("nf"+b).innerHTML=units}else{s2j("nf"+b)}}}else{s2j("klanding");s2j("eyrie");s2j("sunspear");if(b66.substr(15*8,2)=="n6"){$("eyrie").style.left=538;$("eyrie").style.top=736}if(b66.substr(22*8,2)=="n5"){$("klanding").style.left=460;$("klanding").style.top=908}if(!xqss&&b66.substr(32*8,2)=="n5"){$("sunspear").style.left=572;$("sunspear").style.top=1238}}}function pqg7(){for(var a=0;a<6;a++){var b=lmm[a];$("Stronghold"+b).innerHTML=_1m(b,"stronghold");$("City"+b).innerHTML=_1m(b,"castle");if(a==4&&_nr1<6){break}}}function c25(l){var c="",n=l.substr(1,2).f6xc();if(l.substr(0,4)=="card"){bfk=-255;ys1=-30;c+='<div class="card_base '+zv0+l.charAt(4)+" card"+l.charAt(5)+'"></div>'}else{if(xh6>0&&sd_4()==4&&((l.charAt(0)=="l"&&tv6p(n)!=j76())||(l.charAt(0)=="s"&&b12j(n)!=j76()&&b12j(n)!="n"))){var f,g;if(l.charAt(0)=="s"){f=y3v(n,"s");n+=vm25}else{f=y3v(n,"l")}g=lqm(n,2);c+='<table border=0 onmouseover="h343()" cellspacing=0 cellpadding=0 width="100%"><tr><th><small><i>'+f+'</i></small></th><th>&#160;<img src="'+w8_.src+'">&#160;</th></tr><tr><td><small>'+STR.MARCH_TTIP_STR+":</small></td><th>"+g[0]+"</th></tr><tr><td><small>"+STR.MARCH_TTIP_STR_E+":</small></td><th>"+g[1]+"</th></tr>";+(z5ny(n)?'<tr><th colspan=2 style="color:red;padding-top:5px;"><sub>'+STR.MARCH_TTIP_SUPPORT+"</sub></th></tr>":"")+"</table>"}else{if(l.sxk("AvailPower")){bfk=28;ys1=5;var a=l.charAt(10),h=whyx(a),b=ll1q[h][0],k=x3f-b-ll1q[h][1];if(fk0f>0){b+=fk0f;k-=fk0f}c+="<table cellspacing=0 cellpadding=0><tr><td><b>"+STR.TTIP_STATUS_POWER+" "+_hm2(a)+"</b><small><br>"+STR.TTIP_STATUS_POWER_A+": <b>"+b+"</b><br>"+STR.TTIP_STATUS_POWER_U+": <b>"+(x3f-b-k)+"</b><br>"+STR.TTIP_STATUS_POWER_P+": <b>"+k+"</b></small></td></tr></table>"}else{if(l.sxk("nf")){bfk=-60;ys1=-275;var n=l.substr(2,2);c='<table width="185" cellspacing=0 cellpadding=0><tr><td><b>'+y3v(n,"l")+"</b><small><br><i>"+STR.TTIP_NTRL_FORCES1+"</i><br>"+STR.format(STR.TTIP_NTRL_FORCES2,["<b>"+xnw3(n)+"</b>"])+"</small></td></tr></table>"}else{if(l.sxk("evt")){bfk=155;ys1=-183;var e=unescape(l),m=parseInt(e.substr(3)),d=parseInt(l.length>6?e.substr(-2,2):e.substr(-1));if(d==0){c+=STR.EVT_NO_INFO}else{c+="<b>"+y3x_(m,d)+"</b><br>"+k94(m,d)}c='<p style="text-align:center;width:230px;margin:0 auto">'+c+"</p>"}}}}}return c}function __zs(e,f){var l=false,g="tooltip",m=0,h=0,c=277,a=0;if(typeof e=="object"){l=true;m=e.offsetHeight;h=e.offsetWidth;c=l_r(e);a=tb4(e)}else{if(e=="map"&&xh6>0&&sd_4()<6){var b=f.charAt(0),k=f.substr(1,2).f6xc(),d=__k_();if(vhz.cdp(b+rnv(k,2))&&(c05y<0||c05y==k)&&((b=="l"&&tv6p(k)!=j76()&&(gl4(k)||_9v(k)>0))||(b=="s"&&b12j(k)!=j76()&&rypy(k)>0))){l=true;if(b=="l"){a=Math.round((p40[d][7]+p40[k][7])/2)}else{if(d<_1_f){a=Math.round((wq_[d][7]+wq_[k][7])/2)}else{if(dpx&&d>=_1_f&&d-_1_f<nq5l){a=Math.round((bwjt[d-_1_f][1]+wq_[k][7])/2)}}}}}}if(l){if(f.sxk("evt")){g="event-deck"}$("tooltipContent").innerHTML="<table"+(f.sxk("card")?">":' class="'+g+'" cellpadding=2>')+"<tr><td>"+c25(f)+"</td></tr></table>";if(khc.cdp(f+",")){c-=$("tooltipContent").offsetWidth-10}$("tooltip").style.left=c+h+ys1;$("tooltip").style.top=a-m+bfk}}function h343(){$("tooltipContent").innerHTML="";$("tooltip").style.left=-999;$("tooltip").style.top=-999;if(ys1!==0||bfk!==0){ys1=0;bfk=0}}function _zr(a){return a.f6xc().jyc2(1,3)}function _ng_(a){return a.f6xc().jyc2(4,6)}function fs1(a){return a.f6xc().jyc2(7,9)}function gbt(a){return a.f6xc().jyc2(10,12)}function cwm6(a){return a.f6xc().jyc2(13,15)}function _lm(a){return a.f6xc()==15}function k8sp(c){var b=[],d="",a=fj08+1;if(y7q){bhh(STR.NO_MAP_SUPPORT);return}if(c=="B"){if(_nr1>5){if(a>1){a=0}b[0]="205249"+(vm25+_1_f-4)+"4";b[1]="20524E"+(vm25+_1_f-4)+"9";d=b[a]}else{if(_nr1>3){d="206244"+(vm25+_1_f-4)+"5"}else{if(a>1){a=0}b[0]="204246"+(vm25+_1_f-4)+"5";b[1]="20624D"+(vm25+_1_f-4)+"5";d=b[a]}}}else{if(c=="L"){if(_nr1>4){if(a>1){a=0}b[0]="165186"+(vm25+3)+"1";b[1]="166189"+(vm25+3)+"1";d=b[a]}else{d="164185"+(vm25+3)+"6"}}else{if(c=="S"){d="014045"+(vm25+_1_f-1)+"6"}else{if(c=="T"){if(_nr1==6){d="27529D434"}else{if(!_hbv||_nr1==5){if(a>2){a=0}b[0]="274286385";b[1]="274285386";b[2]="274286387";d=b[a]}else{if(a>1){a=0}b[0]="274285387";b[1]="27428E385";d=b[a]}}}else{if(c=="G"){if(a>1){a=0}if(dpx&&m6_(1)>0){b[0]="075124"+(vm25+2)+"1"+(vm25+_1_f+1)+"D";b[1]="07E125"+(vm25+2)+"4"+(vm25+_1_f+1)+"D"}else{b[0]="075124"+(vm25+2)+"7";b[1]="07D124"+(vm25+2)+"5"}d=b[a]}else{if(c=="M"){d="346375459"}}}}}}fj08=a;y87(c,d);q38();cp0();xrv(j76())}function hvj(b,d){var c=dpx&&b=="p";if(vhz.cdp(b+rnv(d,2))){var a=sd_4();zdyw=fsz(d,b);if(m0xj&&(a==0||a==5)){if(b=="l"){if(xnw3(d)+h_0n(d)>3){bhh(STR.EVT_MUSTER_NEW+"\n"+STR.EVT_MUSTER_MAX_ARMY)}else{if($("AvailInf"+j76()).innerHTML=="0"&&$("AvailKnight"+j76()).innerHTML=="0"&&k9tw(j76())>=dp37){bhh(STR.EVT_MUSTER_NEW+"\n"+STR.EVT_MUSTER_NO_FOOTMEN)}else{by_n(d)}}}else{if((b=="s"&&rypy(d)>3)||(c&&m6_(d)>2)){bhh(STR.EVT_MUSTER_NEW+"\n"+STR.EVT_MUSTER_MAX_FLEET)}else{if($("AvailShip"+j76()).innerHTML=="0"){bhh(STR.EVT_MUSTER_NEW+"\n"+STR.EVT_MUSTER_NO_SHIPS)}else{if(b=="s"){gm2k(d)}else{if(c){g_lh(d)}}}}}}else{if(a<3&&document.sendOrdersForm){if(a==2&&kw7!=_04m()){lmgw(2);bhh(STR.RAVEN_ORDER_RESET)}_3nb(fsz(d,b))}else{if(m0xj&&a==4&&xh6>0){switch(b){case"l":zbc(d);break;case"p":c_4(m6_(d),d+_1_f);break;default:c_4(g4_(d),d);break}}else{if(m0xj&&a>7){g_w5(!c?d:d+_1_f)}}}}}}function km7(f,a,e,d){var b,h=0,c=0,g=0;if(f<vm25){b=tv6p(f);while((a>0||e>0)&&!pln_(b66,_8bd,_dmx,b)){if(a>0){h++;a--;py_f(f,-1);tgf.trooper++}else{if(e>0){c++;e--;msb(f,-1);tgf.knight++}}}}else{if(f<vm25+_1_f){f-=vm25;b=b12j(f);while(d>0&&!pln_(b66,_8bd,_dmx,b)){g++;d--;jr3(f,-1);tgf.ship++}}else{if(dpx){f-=vm25+_1_f;b=vxs(f);while(d>0&&m6_(f)>0&&(b=="n"||!pln_(b66,_8bd,_dmx,b))){g++;d--;gs1g(f,-1);tgf.ship++}}}}return[h,c,g]}function c2f(){return(vm25+_1_f+nq5l)+"0"}function htcb(){var f=document.sendOrdersForm,g=j76(),e=_04m();if(!e||e==c2f()){if(!confirm(STR.CNFM_NO_ORDERS)||!confirm(STR.CNFM_NO_ORDERS2)){return false}else{f.orders.value=c2f()}}else{if(sd_4()==2){var c=d2t6("orders"+g);if(e==c&&!confirm(STR.CNFM_NO_RAVEN)){return false}}else{var d=dzgf(g),b=e.length/3,a=wm0+jss1()-3;if(d>b&&a>b&&!confirm(STR.format(STR.CNFM_USABLE_ORDERS,[b]))){return false}}f.orders.value=e}n95(f.proceed);f.proceed.disabled=true;f.house.value=g;q38();vbb();sds()}function dzgf(c){var b=0;c=c;for(var a=0;a<vm25;a++){if(c==b66.charAt(a*8)&&_9v(a)>0){b++}}for(var a=0;a<_1_f;a++){if(c==_8bd.charAt(a*2)&&_8bd.charAt(a*2+1)!="0"){b++}}for(var a=0;a<nq5l;a++){if(c==vxs(a)&&m6_(a)>0){b++}}return b}function q38(){$("orderWindow").style.left=-500;$("orderWindowContent").innerHTML=""}function jss1(){var a=[3,3,2,1,0,0],c=s9m_(j76());if(_hbv){a=[3,2,1,0]}try{return a[c-1]}catch(b){return 0}}function k440(h){var c=0,d=sd_4(),e=nw_(h),b=nc5(h),g=_04m();if(b==0||(d==4&&c05y>=0)){return 0}if((d!=6&&d!=7)&&(d>=8||(rh__()&&document.sendOrdersForm)||(h==xp4g&&g==kw7)||(d>=3&&h!=xp4g))){if(tyl4()||d>=8||(d==4&&h>=vm25+_1_f)){if(d>=8){xp4g=-1;_jw0();t6n(e)}if(d==3&&tyl4()&&e!=j76()){if(b>=13&&(h<vm25||h>=(vm25+_1_f))){bv9(j76(),1);if(w3p){bv9(e,-1)}}}if(d==4||h!=xp4g){y87(e,nsr_(_04m(e),h));if(e==j76()){p5t=rnv(h,2)+vnmf(b)}c++;r__s(h)}if(d==4||d==5){vbb();if(d==4){m0d()}if(d==5&&(!_lm(b)||!hg7())){if(h<vm25){bv9(e,1+vv3(h))}else{if(dpx&&h>=vm25+_1_f){var f=_knq[h],a=f.substr(f.indexOf("s")+1,2).f6xc();if(rypy(a)==0||j76()==b12j(a)){bv9(e,1)}}}pvl()}}if(tyl4()&&e!=j76()){_jw0();ktlx++;if(d==3&&(w3p||nc5(xp4g)!=3)){ktlx++}if(d==3&&(ktlx==2||h==xp4g)){e=tx0_(xp4g);h=xp4g}else{$("OrderSelect"+xp4g).style.left=$("Order"+xp4g).style.left;$("OrderSelect"+xp4g).style.top=$("Order"+xp4g).style.top}}if(d==10||(tyl4()&&(ktlx==2||h==xp4g))){sds();xp4g=-1;ktlx=0}if(d==3&&ktlx==1){t6n(j76());ql5()}}if(j76()==e){if(d<8&&g==_04m()){_29[b][0]=0;y87(e,nsr_(g,h));r__s(h);c++}}if(rh__()){cp0()}if(d<3&&parseInt($("orderWindow").style.left)>=0){shj(zdyw)}}return c}function p27(b,a){l5r(b,a,false)}function y6m(b,a){l5r(b,a,true)}function l5r(e,d,b){var a=_04m(d),c=nsr_(a,e);if(a.length-c.length==3){y87(d,c);if(b){r__s(e)}}}function xrv(a){if(a){mbgw(a)}else{h9b()}if(p5dx()){return}for(var f=0;f<_nr1;f++){if(a&&a!=lmm[f]){continue}var b=qhf(lmm[f]),l=_04m(lmm[f]);if(rh__()&&l=="set"){b=q3c8(lmm[f],true)}for(var g=0;g<b.length;g++){try{var m=b[g],d=b_d(m,l),n=$("Order"+m),c=_29[d][1]+(d==0?lmm[f]:""),h=_hm2(lmm[f]);n.style.left=bkt[m][0];n.style.top=bkt[m][1];n.title=STR.format(STR.ORDER_OWNER,[h]);dyj6(n,"o_map");d75(n,c);if(!rh__()&&tyl4()&&nc5(xp4g)!=3){n95(n)}if(objClassBak!=n.className){wv2(n)}}catch(k){continue}}}}function wv2(a){if(r_mn){a.style.display="none";a.offsetHeight;a.style.display="block"}}function cp0(){var b=_04m();for(var a=1;a<16;a++){_29[a][0]=0;if(t__(a,b)>=0){_29[a][0]=1}}}function nsr_(b,e,a){var c=rnv(e,2);a=vnmf(a);for(var d=0;d<b.length;d+=3){if(c==b.substr(d,2)||(a&&a==b.charAt(d+2))){b=b.substring(0,d)+b.substr(d+3);d-=3}}return b}function _hwy(f,a){var b=rnv(f,2)+vnmf(a),e=a%3==0,d=nsr_(_04m(),c2f().substr(0,2)),c=-1;g_t();if(d){while((c=d.indexOf(rnv(f,2),c))>=0){if(c%3==0){break}c++}}if(m0xj){if(_29[a][0]==1){bhh(STR.RAVEN_ORDER_SWAP)}else{if(d&&(!e||(__w<jss1())||(c>=0&&d.charAt(c+2).f6xc()%3==0))){if(c>-1){d=d.substr(0,c)+d.substr(c+3)}d+=b;if(a>=13&&q_5h(f)){bhh(STR.PLAN_ORDER_NO_EFFECT)}}else{if(!d){d=b}else{bhh(STR.PLAN_ORDER_LIMIT)}}}}else{if(!e||__w<jss1()||(c>=0&&d.charAt(c+2).f6xc()%3==0)){if(d&&d.charAt(2)!="0"){d=nsr_(d,f,a)}d+=b;if(a>=13&&q_5h(f)){bhh(STR.PLAN_ORDER_NO_EFFECT)}}else{if(jss1()<1){bhh(STR.PLAN_NO_SPECIAL)}else{bhh(STR.PLAN_ORDER_LIMIT)}}}y87(j76(),d);xrv(j76());p83f(j76());q38();if(rh__()){cp0()}}function g_t(){var a=_04m();__w=0;for(var b=0;b<a.length;b+=3){if(a&&parseInt(a.charAt(b+2),16)%3==0){__w++}}}function _3nb(c){var b=$("orderWindow"),a=$("orderWindowContent");shj(c);b.style.left=0;b.style.top=bkt[c][1]-150;if(parseInt(b.style.top)>($("WesterosMapImg").offsetHeight-a.offsetHeight)){b.style.top=$("WesterosMapImg").offsetHeight-a.offsetHeight}else{if(c==0){b.style.top=0}}}function _3ky(){var c=j76();vhz="";for(var b=0;b<vm25;b++){if(tv6p(b)==c&&_9v(b)>0){vhz+="l"+rnv(b,2)}if(b<_1_f&&b12j(b)==c&&rypy(b)>0){vhz+="s"+rnv(b,2)}if(__zb(b)&&tv6p(b)==c){var a=q7r_(b);if(m6_(a)>0){vhz+="p0"+a}}}cyj(vhz)}function cyj(a){var d=a.length;for(var h=0;h<d;h+=3){var g="#AAFFAA",b=a.charAt(h),l=a.substr(h+1,2).f6xc(),c=b+l,f=$(c);if(b!="l"){g="#BBBBFF"}if(f){try{f.onclick=new Function("hvj('"+b+"', "+l+")");f.onmouseover=new Function("ts_(), ylkp('"+c+"', '"+g+"'), h343(), __zs('map', '"+c+"')");mws(f)}catch(k){bhh("cyj()\n"+k)}ylkp(c,g)}}vhz=a}function vbb(){var c=[vm25,_1_f,nq5l],b=["l","s","p"];ts_();for(var d=0;d<3;d++){for(var f=0;f<c[d];f++){var a=$(b[d]+f);try{a.onclick="";a.onmouseover="";n95(a)}catch(g){}}}}function d_5(b){for(var a=0;a<_nr1;a++){if(!b||b==lmm[a]){y87(lmm[a],d2t6("orders"+lmm[a]));xrv(lmm[a])}}}function qhf(d){var c=_04m(d),a=[];for(var b=0;b<c.length;b+=3){var e=c.substr(b,2).f6xc();if(e>=0){a.push(e)}}return a}function p83f(c){var a=qhf(c);for(var b=0;b<a.length;b++){wb7("Order"+a[b])}}function mbgw(c){var a=q3c8(c,false).concat(q3c8("n",false));for(var b=0;b<a.length;b++){r__s(a[b])}}function h9b(){var a=vm25+_1_f+nq5l;for(var b=0;b<a;b++){r__s(b)}}function t6n(c){var a=qhf(c);for(var b=0;b<a.length;b++){n95("Order"+a[b])}}function sds(){for(var a=0;a<_nr1;a++){t6n(lmm[a])}}function r__s(b){try{rs5(b);s2j("Order"+b)}catch(a){bhh(a)}}function rs5(b){try{s2j("OrderSelect"+b)}catch(a){bhh(a)}}function _jw0(){var a=vm25+_1_f+nq5l;for(var b=0;b<a;b++){rs5(b)}}function rjx(a){if(_zr(a)){return m5k==7||m5k==10}else{if(a==6){return m5k==12}else{if(fs1(a)){return m5k==13}else{if(gbt(a)){return m5k==6}else{if(cwm6(a)){return m5k==8||m5k==11}}}}}return false}function ppr(a){if(!_29[a][0]&&!rjx(a)){return true}return false}function shj(b){var c='<table width="210" class="tooltip" border="0" cellpadding="2"><tr><th colspan="3"><span style="font-size:13px"><b>'+y3v(vrw(b),tn4f(b))+"<br><small>"+STR.PLAN_DLG_SET_ORDER+'</small></b></span></th></tr><tr><td><table width="100%" border="0" cellpadding="3"><tr>';for(var a=1;a<16;a++){if(ppr(a)){c+='<th><div onclick="_hwy('+b+", "+a+')"      class="'+_29[a][1]+'"      style="cursor:pointer"></div></th>'}else{c+='<th><img src="./images/order_already_used.gif"></th>'}if(a<15&&a%3==0){c+="</tr><tr>"}}c+='</tr></table></td></tr><tr><td align="center"><span style="font-size:11px">'+STR.PLAN_DLG_SELECT_ORDER+'<br /><u style="cursor:pointer" onclick="q38()">'+STR.PLAN_DLG_CLOSE+"</u></span></td></tr></table>";$("orderWindowContent").innerHTML=c}function j5ct(a){w2gm(a,true)}function w2gm(d,b){var a=m37f(d),c=a+"0000";if(b&&gl4(d)){c=a+"0002"}b66=b66.ybz_(d*8,c)}function x9l0(c){var a=ff0(c);for(var b=a;b<_nr1;b++){if(t062(b)){return false}}return true}function kbw(d,c){if(d.cities<c.cities){return 1}else{if(d.cities>c.cities){return -1}else{if(d2t6("cfg-tbrkr")){if(d.strong<c.strong){return 1}else{if(d.strong>c.strong){return -1}}}if(d.supply<c.supply){return 1}else{if(d.supply>c.supply){return -1}else{if(d.power<c.power){return 1}else{if(d.power>c.power){return -1}else{if(d.throneTrack>c.throneTrack){return 1}return -1}}}}}}return 0}function f20(d,c,a,b){this.house=d;this.castle=c[0];this.strong=c[1];this.cities=c[0]+c[1];this.supply=a;this.power=b;this.throneTrack=ff0(d)}function msz(){var d=[];for(var a=0;a<_nr1;a++){var c=_1m(lmm[a],"castle"),b=_1m(lmm[a],"stronghold");d[a]=new f20(lmm[a],[c,b],zxc8(lmm[a]),_zg(a,true))}d.sort(kbw);return d}function l026(){var c=msz(),a=c[0].house,b=_hm2(a);m0xj=true;$("gameStateForm").innerHTML="";$("gameStateText").innerHTML='<center><br/><h3><font color="red">GAME OVER</font></h3><i><b>'+STR.format(STR.GAME_OVER_VICTORY,[b])+"</b></i></center>";$("stats_action").innerHTML='<p style="text-align:center;">-- GAME OVER --</p>';if(j76()){x87(a)}}function vhf(){for(var a=0;a<_nr1;a++){if(_1m(lmm[a],"winPoints")>=hvc()){l026();return true}}return false}function bv9(c,f){var d=whyx(c),a=ll1q[d][0],e=ll1q[d][1],b;if(f>0&&(x3f-a-e)<f){f=(x3f-a-e)}else{if(f<0){if(a+f<0){return 0}ll1q[d][1]-=f}}b=a+f;ll1q[d][0]=b;$("AvailPower"+c).innerHTML=b;tf8(d,b);return f}function vrbs(a,g,b){if(a){try{if(typeof b=="number"&&xy8()){b+=vm25}}catch(f){}for(var d=2;d<a.length;d+=3){for(var c=0;c<g.length;c++){if(a.charAt(d)==g[c]&&(typeof b!="number"||b==a.substr(d-2,2).f6xc())){return true}}}}return false}function m0d(){var e=_nr1*jsx,d=_nr1*y2b,c=_nr1*dp37,a=_nr1*glb;xh6=0;for(var b=0;b<e;b++){sfb[b][0]=false;sfb[b][5]=0;n95(sfb[b][3]);if(sfb[b][6]&&$(sfb[b][3]).className!=sfb[b][1]){dyj6(sfb[b][3],sfb[b][1]);wv2($(sfb[b][3]))}}for(var b=0;b<d;b++){p_qn[b][0]=false;p_qn[b][5]=0;n95(p_qn[b][3]);if(p_qn[b][6]&&$(p_qn[b][3]).className!=p_qn[b][1]){dyj6(p_qn[b][3],p_qn[b][1]);wv2($(p_qn[b][3]))}}for(var b=0;b<c;b++){jcks[b][0]=false;jcks[b][5]=0;n95(jcks[b][3]);if(jcks[b][6]&&$(jcks[b][3]).className!=jcks[b][1]){dyj6(jcks[b][3],jcks[b][1]);wv2($(jcks[b][3]))}}for(var b=0;b<a;b++){xt_y[b][0]=false;xt_y[b][5]=0;n95(xt_y[b][3]);if(xt_y[b][6]&&$(xt_y[b][3]).className!=xt_y[b][1]){dyj6(xt_y[b][3],xt_y[b][1]);wv2($(xt_y[b][3]))}}}function ql5(d){var e=vjb(),c=[],b=(d||d===0);if(e){c.push(new nms());return mkbf(d,c,_03h(),true)}else{var a=false;if(!b){d=xp4g;a=nc5(d)}c.push(new _dw4(d,a))}if(b){xp4g=d}return r15w(d,c)}function _dw4(b,a){this.areaId=b;this.isRaidAtSeaPossible=b>=vm25||sd_4()==10;this.raidableOrders=[1,2,3,7,8,9,13,14,15];if(w3p&&a&&a==3){this.raidableOrders.push(10);this.raidableOrders.push(11);this.raidableOrders.push(12)}}_dw4.prototype.snm=function(a,b){return this.raidableOrders.cdp(a)&&(b<vm25||this.isRaidAtSeaPossible)};function tyl4(){return !xp4g.isNaN&&xp4g.f6xc()>=0}function _s1v(d){var b=sd_4(),c=tx0_(d),a=nc5(d);if(rh__()&&w58("Order"+d)){k440(d)}if(m0xj&&b==3&&c!=j76()&&w58("Order"+d)){k440(d)}else{if(m0xj&&c==j76()&&kw7==_04m()){if(b==3&&_zr(a)){sds();if(tyl4()){d_5();ktlx=0}hq8_(d);ql5();lkpc(1,3)}else{if(b==4&&_ng_(a)){if(tyl4()&&xp4g!=d&&(xh6>0||hg7())){lmgw(4)}hq8_(d)}else{if(b==5&&cwm6(a)){if(tyl4()){lmgw(5)}hq8_(d);if(_lm(a)&&j8nz(d)&&jhh(d)>0){v39g(d);jf3_();r70[0][0]=d;r70[0][1]=jhh(d);f8b();f72()}}}}}}}function hq8_(b){var a=$("OrderSelect"+b);_jw0();dyj6(a,v0sd+" o_map o_select1");a.style.left=$("Order"+b).style.left;a.style.top=$("Order"+b).style.top;xp4g=b}function y87(a,b){switch(a){case"B":f0s=b;break;case"L":y67=b;break;case"S":_qnc=b;break;case"T":n187=b;break;case"G":x_05=b;break;case"M":fsny=b;break;default:break}}function vx5(){var l=0,c=0,n=0,a,f=_nr1*jsx,m=_nr1*y2b,o=_nr1*dp37,g=_nr1*glb,b=z31.length,h;for(var d=0;d<f;d++){sfb[d][6]=true;if(d<m){p_qn[d][6]=true}if(d<o){jcks[d][6]=true}if(d<g){xt_y[d][6]=true}}for(var e=0;e<b;e+=6){a=z31.charAt(e);h=z31.substr(e+1,2).f6xc();n=z31.charAt(e+5).f6xc();if(h<vm25){l=z31.charAt(e+3).f6xc();c=z31.charAt(e+4).f6xc();for(d=f-1;d>=0;d--){if(l>0&&sfb[d][2]==h&&sfb[d][4]==a){sfb[d][6]=false;l--}if(c>0&&d<m&&p_qn[d][2]==h&&p_qn[d][4]==a){p_qn[d][6]=false;c--}if(n>0&&d<o&&jcks[d][2]==h&&jcks[d][4]==a){jcks[d][6]=false;n--}}}else{for(d=g-1;d>=0;d--){if(n>0&&xt_y[d][2]==h-vm25&&xt_y[d][4]==a){xt_y[d][6]=false;n--}}}}g3_v()}function __zb(b){try{if(dpx&&_knq[b].cdp("p")){return true}}catch(a){}return false}function m9m(h){var e=q7r_(h);if(e>=0&&rf_&&d2t6("port").charAt(e)!="0"){var d=q7r_(zdyw),c=parseInt(d2t6("port").charAt(e)),g=m6_(d),b=parseInt(d2t6("port").charAt(d))-g,a=0;while(c-->0&&b-->0){var f=_dmx.ybz_(d,++g);if(pln_(b66,_8bd,f)){a++;_dmx=f}else{break}}if(a>0){_qd()}}rf_=false}function gxp(c){var b=j76();if(bv9(b,-1)==-1){djx(c,b);lwl(c,1);p15z()}lphh();if(__zb(c)){var a=q7r_(c);if(a+vm25+_1_f==p5t.substr(0,2).f6xc()){y87(b,_04m()+p5t);xrv(b)}_dmx=_dmx.ybz_(a,d2t6("port").charAt(a));_qd()}if(c05y>=0){zfkw()}}function pln_(g,r,t,b,e){if(!b){b=j76();if(!b){return false}}else{if(b=="n"){return true}}e=(typeof e==="undefined")?true:e;var a=zxc8(b),n=[0,0,0,0,0],p=0,s=0,q=[],d=g.length,u=r.length;for(var o=0;o<w4c[a].length;o++){n[w4c[a][o]]++}for(var m=0;m<d;m+=8){p=parseInt(g.charAt(m+1))+parseInt(g.charAt(m+2))+parseInt(g.charAt(m+3));if(p>1&&g.charAt(m)==b){if(p>4){return false}n[p]--;q.push(p)}}for(var h=0;h<u;h+=2){p=parseInt(r.charAt(h+1));if(r.charAt(h)==b){if(p>1){if(p>4){return false}n[p]--;q.push(p)}s+=p}}if(dpx){var c=t.length;for(var f=0;f<c;f++){p=parseInt(t.charAt(f));if(p>3){return false}else{if(g.substr(nrkx(f)*8,1)==b){if(p>1){n[p]--;q.push(p)}s+=p}}}}if(s>glb){return false}for(var o=2;o<5;o++){if((o==2&&n[o]+n[3]+n[4]<0)||(o==3&&n[o]+n[4]<0)||(o==4&&n[o]<0)){return false}}if(e&&b==j76()){qk0w(b,q)}return true}function qk0w(d,a){var f=zxc8(d);a.sort();a.reverse();var c=a.pop();for(var b=0;b<w4c[f].length;b++){var e=$("supplybox"+f+b);dyj6(e,"supply_red");e.innerHTML=w4c[f][b];if(w4c[f][b]>=c){if(w4c[f][b]>c){e.innerHTML=c+"/"+w4c[f][b];dyj6(e,"supply_green")}else{dyj6(e,"supply_blue")}c=a.pop()}}}function v6cc(){for(var c=0;c<=6;c++){for(var a=0;a<w4c[c].length;a++){var b=$("supplybox"+c+a);dyj6(b,"supply_red");b.innerHTML=w4c[c][a]}}}function zbc(r){if(c05y>=0){return}r=r.f6xc();var l=vz04(r),m=_nr1*jsx,n=_nr1*y2b,x=_nr1*dp37,k=j76(),B="",p=_dmx,v=false,q=_04m(),z=0,c=0,h=0,w=0,y=0,C,d,f,g;vhz="";for(var u=0;u<m;u++){if(sfb[u][0]){z++;d=sfb[u][2]}}for(var u=0;u<n;u++){if(p_qn[u][0]){c++;d=p_qn[u][2]}}for(var u=0;u<x;u++){if(jcks[u][0]){h++;d=jcks[u][2]}}f=vz04(d).ybz_(1,(xnw3(d)-z)+""+(h_0n(d)-c)+""+(fnd(d)-h));if(tv6p(r)==k||(_9v(r)==0&&!gl4(r))){if(f.substr(1,4)=="0000"){f=f.ybz_(0,m37f(d))}z=z+xnw3(r);c=c+h_0n(r);h=h+fnd(r);C=k+""+z+""+c+""+h+""+l.substr(4,4);if(l.charAt(4)=="1"&&l.charAt(0)!=k){C=C.ybz_(4,0)}B=b66.ybz_(r*8,C);B=B.ybz_(d*8,f);var b=q7r_(r),e=glb-parseInt($("AvailShip"+k).innerHTML,10);if(b>=0&&e<glb&&m6_(b)>0&&b66.charAt(r*8)!=k){if((e==0&&(!__zb(d)||m6_(q7r_(d))==0||B.charAt(d*8+4)!="0"||B.substr(d*8+1,3)!="000"))||!confirm(STR.CNFM_PORT_TAKEOVER_EASY)){_dmx=_dmx.ybz_(b,0)}else{var A=m6_(b),t=0;while(A>e||!pln_(B,_8bd,_dmx,null,false)){_dmx=_dmx.ybz_(b,--A);t++}if(t>0){bhh(STR.BATTLE_PORT_TAKEOVER);rf_=true}}}if(v=pln_(B,_8bd,_dmx)){b66=B;if(B.substr(d*8+1,4)=="0000"){if(kd05(whyx(k))>0){xp5(d)}else{_z7q(d)}}}else{bhh(STR.MARCH_SUPPLY)}}else{if(!mymk(tv6p(r))&&(_9v(r)>0||gl4(r))){w=lqm(r,0);y=lqm(r,1);if(f.substr(1,4)=="0000"){f=f.ybz_(0,m37f(d))}C=k+z+""+c+""+h+"0"+l.substr(5,3);B=b66.ybz_(r*8,C);B=B.ybz_(d*8,f);if(__zb(r)){p=_dmx.ybz_(q7r_(r),0)}if(w>=y&&(v=pln_(B,_8bd,p))){var a=l.charAt(0);if(a!="n"){y6m(r,a);if(__zb(r)){y6m(q7r_(r)+vm25+_1_f,a)}}k440(d);_dmx=p;b66=B;if(y7q&&r>=15){s2j("nf"+r)}else{if(r==15){s2j("eyrie")}else{if(r==22){s2j("klanding")}else{if(r==32&&_nr1<6){s2j("sunspear")}}}}if(B.substr(d*8+1,4)=="0000"&&b66.substr(d*8+5,3)!="000"){if(kd05(whyx(k))>0){xp5(d)}else{_z7q(d)}}}else{if(w<y){bhh(STR.MARCH_WEAKLING)}else{bhh(STR.MARCH_SUPPLY)}}h343()}else{C=k+z+c+h+l.substr(4,4);B=b66.ybz_(r*8,C);B=B.ybz_(d*8,f);if(__zb(r)){p=_dmx.ybz_(q7r_(r),0)}if(!pln_(B,_8bd,p,null,false)){bhh(STR.MARCH_SUPPLY_ATTACK)}else{$("battleImg").style.left=p40[r][6];$("battleImg").style.top=p40[r][7];$("attackerImg").style.left=p40[d][6];$("attackerImg").style.top=p40[d][7];$("OrderSelect"+d).className=v0sd+" o_map o_select2";mn4x=j76();msj=tv6p(r);_kn7=d;c05y=r;pjh=z+""+c+""+h;vbb();sds();if(_9v(d)==sf50()&&_0yd(d)==0){if(kd05(whyx(k))>0){xp5(d)}else{_z7q(d)}}}}}if(v&&c05y<0){b66=B;if(_9v(d)==0&&!w){k440(d)}}var s=-1;if(s1p(d)&&__zb(d)&&b66.substr(d*8+1,4)=="0000"){s=vm25+_1_f+q7r_(d);if(tp5s(s,k)>=0){k440(s)}km7(s,0,0,3)}else{if(__zb(d)&&!_j5z(d)&&_0yd(d)==0&&_9v(d)==0){s=vm25+_1_f+q7r_(d);if(tp5s(s,k)>=0){k440(s)}}}if(__zb(r)&&tv6p(r)==k&&d2t6("land").charAt(r*8)!=k){var o=d2t6("land").charAt(r*8);s=vm25+_1_f+q7r_(r);if(o!="n"&&_04m(o)==d2t6("orders"+o)&&tp5s(s,o)>=0){k440(s)}km7(s,0,0,3)}if(c05y<0){ltcv(r,d)}}function ltcv(b,a){g3v(b,a,true)}function fg_5(b,a){g3v(b,a,false)}function g3v(c,b,a){if(a){p15z()}if(!a||__zb(c)||__zb(b)){_qd()}vbb();m0d();ggp()}function c_4(h,o){var g=_nr1*glb,f=j76(),v=String(),s=false,n=_04m(),m=n.length,l=0,t=0,u=0,w,b,d,e,c=0;o=parseInt(o,10);vhz="";for(var r=0;r<g;r++){if(xt_y[r][0]){l++;b=xt_y[r][2]}}d=_8bd.substr(b*2,2);d=f+(parseInt(d.charAt(1))-l);e=nc5(b+vm25);if(dpx&&o>=_1_f){o-=_1_f;if(vxs(o)==f){c=_dmx.ybz_(o,m6_(o)+l);w=f+(parseInt(_8bd.charAt(b*2+1))-l);if(w.charAt(1)=="0"){w="n0"}v=_8bd.ybz_(b*2,w);if(s=pln_(b66,v,c)){_8bd=v;_dmx=c}else{bhh(STR.MARCH_SUPPLY)}}else{bhh(STR.MARCH_PORT)}}else{if(dpx&&b>=_1_f){var a=b-_1_f;if(rypy(o)==0){gs1g(a,-1*l);jr3(o,l);rr_(o,f);s=true;pln_(b66,v,c)}else{if(c05y<0&&parseInt(h.substr(1,2),10)>0&&!mymk(h.charAt(0))){u=parseInt(h.charAt(1));t=l+hp_(o+vm25,f);if(e==6){t+=1}else{if(e==4){t-=1}}c=_dmx.ybz_(a,m6_(a)-l);v=_8bd.ybz_(o*2,f+""+l);if(s=pln_(b66,v,c,null,false)&&t>=u){_8bd=v;_dmx=c;k440(a+vm25+_1_f)}else{if(t<u){bhh(STR.MARCH_WEAKLING)}else{bhh(STR.MARCH_SUPPLY)}}h343()}else{if(h.charAt(0)==f){c=_dmx.ybz_(a,m6_(a)-l);l=rypy(o)+l;v=_8bd.ybz_(o*2,f+""+l);if(s=pln_(b66,v,c)){_8bd=v;_dmx=c}else{bhh(STR.MARCH_SUPPLY)}}else{if(c05y<0&&mymk(h.charAt(0))){for(var p=0;p<g;p++){if(xt_y[p][0]){y6h(f+"SP"+p,"_select")}}$("battleImg").style.left=wq_[o][6];$("battleImg").style.top=wq_[o][7]+4;$("attackerImg").style.left=bwjt[a][0]-6;$("attackerImg").style.top=bwjt[a][1]-32;$("OrderSelect"+(a+vm25+_1_f)).className=v0sd+" o_map o_select2";mn4x=f;msj=_8bd.charAt(o*2);_kn7=a+_1_f;c05y=o;pjh=l;vbb();sds()}}}}if(m6_(a)==0){d="p0"}}else{if(c05y<0&&(h.charAt(0)=="n"||h.charAt(0)==f)){if(parseInt(d.substr(1,2),10)<=0){d="n0"}l=l+parseInt(_8bd.charAt(o*2+1));w=f+l;v=_8bd.substr(0,o*2)+w+_8bd.substr(o*2+2);v=v.substr(0,b*2)+d+v.substr(b*2+2);if(s=pln_(b66,v,_dmx)){_8bd=v}else{bhh(STR.MARCH_SUPPLY)}}else{if(c05y<0&&h.charAt(1)!="0"&&!mymk(h.charAt(0))){u=parseInt(h.charAt(1));t=l;if(e==6){t+=1}if(e==4){t-=1}t+=hp_(o+vm25,f);if(parseInt(d.substr(1,2),10)<=0){d="n0"}w=f+l;v=_8bd.substr(0,o*2)+w+_8bd.substr(o*2+2);v=v.substr(0,b*2)+d+v.substr(b*2+2);if(s=pln_(b66,v,_dmx,null,false)&&t>=u){_8bd=v;k440(b+vm25);y6m(o+vm25,h.charAt(0))}else{if(t<u){bhh(STR.MARCH_WEAKLING)}else{bhh(STR.MARCH_SUPPLY)}}h343()}else{if(c05y<0){for(var q=0;q<g;q++){if(xt_y[q][0]){y6h(f+"SP"+q,"_select")}}w=f+l;v=_8bd.substr(0,o*2)+w+_8bd.substr(o*2+2);v=v.substr(0,b*2)+d+v.substr(b*2+2);if(!pln_(b66,v,_dmx,null,false)){bhh(STR.MARCH_SUPPLY_ATTACK)}else{$("battleImg").style.left=wq_[o][6];$("battleImg").style.top=wq_[o][7]+4;$("attackerImg").style.left=wq_[b][6];$("attackerImg").style.top=wq_[b][7]+3;$("OrderSelect"+(b+vm25)).className=v0sd+" o_map o_select2";mn4x=f;msj=_8bd.charAt(o*2);_kn7=b;c05y=o;_15=lqm(o+vm25,0);kpc=lqm(o+vm25,1);pjh=l;vbb();sds()}}}}}}if(s&&c05y<0&&parseInt(d.charAt(1))<=0&&!t){k440(b+vm25)}if(c05y<0){fg_5(o,b)}}function hb22(){if(kw7==_04m()){bhh(STR.CP_ACTION);return false}var b=document.cpOrdersForm,a=whyx(j76());b.proceed.disabled=true;document.revokeForm.elements[0].disabled=true;if(hg7()){if(!pln_(b66,_8bd,_dmx)){bhh(STR.EVT_MUSTER_LOW_SUPPLY);return false}pvl();b.routedunits.value=z31;b.land.value=b66;b.sea.value=_8bd;b.port.value=_dmx}else{if(l_q0!=d2t6("houses")||ll1q[a][0]+ll1q[a][1]==x3f){b.hpositions.value=_qks(whyx(j76()))}}b.orders.value=_04m()}function lkpc(e,d){var g=_04m();for(var f=0;f<g.length;f+=3){var c=g.charAt(f+2).f6xc();if(c.jyc2(e,d)){var h=g.substr(f,2).f6xc();wb7("Order"+h)}}}function f8yy(){var h=sd_4(),l=c__c(),k=j76(),f='<input type="hidden" name=',c=' target="setDataFrame" action="./setGameData.php?game='+d8m+"&crc="+s2x,m="";lphh();if(l==k&&zj_v()){m0xj=true;t0st();d4ss();m='<form name="eventForm"'+c+'" onsubmit="return m7l()" method="post">'+f+'"eventChoice">'+f+'"eventDeck"></form>'}else{if(l==k&&cdsz()){m0xj=true;w4xt();v39g(false);qc0(k);f8b();f72();m='<form name="eventForm"'+c+'" onsubmit="return _kr3()" method="post">'+f+'"land">'+f+'"sea">'+f+'"ports"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>&#160;&#160;&#160;<form name="revokeForm"><input class="button" type="button" value="'+STR.REVOKE+'" onclick="lmgw('+h+')"></form>'}else{if(l==k&&ysf()){m0xj=true;t0st();jdd7();m='<form name="eventForm"'+c+'" onsubmit="return t_g3()" method="post">'+f+'"house" value="'+j76()+'">'+f+'"positions">'+f+'"land">'+f+'"sea">'+f+'"ports">';if(!pln_(b66,_8bd,_dmx)){hzd=15;gvp();m+='<input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>&#160;&#160;&#160;<form name="revokeForm"><input class="button" type="button" value="'+STR.REVOKE+'" onclick="lmgw('+h+')">'}m+="</form>"}else{if(k==l&&mvtj()){m0xj=true;w4xt();m='<form name="eventForm"'+c+'" onsubmit="return t_g3()" method="post">'+f+'"Baratheon">'+f+'"Lannister">'+f+'"Stark">'+f+'"Tyrell">'+f+'"Greyjoy">'+f+'"Martell"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>';gnx()}else{if(lyys()){m0xj=false;var g=d2t6("bidcount")>=_nr1;if(k&&!g){t0st();_n0();$("menue").innerHTML="";if(j76()&&ll1q[whyx(j76())][0]>0){fk0f=-1;m='<form name="eventForm"'+c+'" onsubmit="return zq8h()" method="post">'+f+'"bidvalue"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>';xw50();qzc("CoK Bid")}else{fk0f=0;m=STR.STATUS_WAITING}}else{if(g&&b39(k)){m0xj=true;t0st();_n0();$("menue").innerHTML='<small>&#160;<a href="javascript:pb90()">'+STR.DLG_MENU_BIDS+"</a> |</small>";m='<form name="eventForm"'+c+'" onsubmit="return t_g3()" method="post">'+f+'"track" value='+cdt+">"+f+'"Baratheon">'+f+'"Lannister">'+f+'"Stark">'+f+'"Tyrell">'+f+'"Greyjoy">'+f+'"Martell"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>&#160;&#160;&#160;<form name="revokeForm"><input class="button" type="button" value="'+STR.REVOKE+'" onclick="lmgw('+h+')"></form>';bpd();pb90()}else{m=STR.EVT_CLASH_WAITING;_n0();if(g){$("menue").innerHTML='<small>&#160;<a href="javascript:pb90()">'+STR.DLG_MENU_BIDS+"</a> |</small>";bpd();pb90()}}}}else{if(wb_j()){var g=d2t6("bidcount")>=_nr1;m0xj=false;_5l5();if(!g){if(j76()&&ll1q[whyx(j76())][0]>0){t0st();fk0f=-1;m='<form name="eventForm"'+c+'" onsubmit="return zq8h()" method="post">'+f+'"bidvalue"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>';xw50();qzc("Wildling Attack")}else{fk0f=0;m=STR.STATUS_WAITING}}else{var n=b1p();if($("menue").innerHTML.length<25){$("menue").innerHTML='<small>&#160;<a href="javascript:pb90()">'+STR.DLG_MENU_BIDS+"</a> |</small>";pb90()}m="<b><i>"+STR.PHASE_TITLE_EVENTS+": ("+STR.EVT_DECK+" 3)</i></b><br>";if(n==0||n==1){m+="<small><b>"+STR.EVT_WILDLINGS+"(2):</b></br>"+STR.EVT_WILDLINGS_LOST+"</small>"}else{m+="<small><b>"+STR.EVT_WILDLINGS+"(2):</b></br>"+STR.EVT_WILDLINGS_WIN+"</small>"}$("gameStateText").innerHTML=m;m="";if(n>0&&!b39(k)){m=STR.STATUS_WAITING_THRONE}else{if(k&&n<=0){var e=d2t6("ordersall");if(n==0&&(_04m()||(!e&&kt_h[0]==d2t6("bid"+k)))){m0xj=true;t0st();b2j=kypb(j76());cp3()}else{if(n==0){for(var d=0;d<_nr1;d++){var b=lmm[d];if(_04m(b)||(!e&&kt_h[0]==d2t6("bid"+b))){l=b}}if(l){m=STR.format(STR.STATUS_WAITING_NAME,[qjg(l)])}}else{if(n<0&&k==l){m0xj=true;t0st();gvp();m='<form name="eventForm"'+c+'" onsubmit="return t_g3()" method="post">'+f+'"house" value="'+j76()+'">'+f+'"positions">'+f+'"land">'+f+'"sea">'+f+'"ports"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>&#160;&#160;&#160;<form name="revokeForm"><input class="button" type="button" value="'+STR.REVOKE+'" onclick="lmgw('+h+')"></form>';hzd=2;if(_04m()=="1"||(!e&&kt_h[0]==d2t6("bid"+k))){hzd=4}var a="You have to remove "+hzd+" Mustering Points.";if(hzd==2){a+="\nHouse "+rms()+" was chosen to remove 4..."}bhh(a)}else{m=STR.format(STR.STATUS_WAITING_NAME,[qjg(l)])}}}}}}}else{if(h==3&&l==k){m0xj=true;m='<form name="raidOrdersForm"'+c+'" onsubmit="return h6n()" method="post">'+f+'"ordersB">'+f+'"ordersL">'+f+'"ordersS">'+f+'"ordersT">'+f+'"ordersG">'+f+'"ordersM">'+f+'"house">'+f+'"housepositions"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>&#160;&#160;&#160;<form name="revokeForm"><input class="button" type="button" value="'+STR.REVOKE+'" onclick="lmgw('+h+')"></form>';lkpc(1,3);w4xt()}else{if(h==4&&l==k){m0xj=true;m='<form name="marchOrdersForm"'+c+'" onsubmit="return klc()" method="post">'+f+'"takeover" value=1>'+f+'"ordersB">'+f+'"ordersL">'+f+'"ordersS">'+f+'"ordersT">'+f+'"ordersG">'+f+'"ordersM">'+f+'"land">'+f+'"sea">'+f+'"ports">'+f+'"house">'+f+'"housepositions">'+f+'"boarea">'+f+'"btarea">'+f+'"bstrattacker">'+f+'"bstrdefender">'+f+'"baunits"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>&#160;&#160;&#160;<form name="revokeForm"><input class="button" type="button" value="'+STR.REVOKE+'" onclick="lmgw('+h+')"></form>';lmgw(4);w4xt()}else{if(h==5&&k==l&&w3p){m0xj=true;p15z();_qd();lkpc(13,15);w4xt();m='<form name="cpOrdersForm"'+c+'" onsubmit="return hb22()" method="post">'+f+'"land">'+f+'"sea">'+f+'"port">'+f+'"hpositions">'+f+'"orders">'+f+'"routedunits"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>&#160;&#160;&#160;<form name="revokeForm"><input class="button" type="button" value="'+STR.REVOKE+'" onclick="lmgw('+h+')"></form>'}else{if(!k||(h<6&&k)){m=STR.format(STR.STATUS_WAITING_NAME,[qjg(l)])}}}}}}}}}}if(m!=""){$("gameStateForm").innerHTML=m}}function ggp(){var e=_04m(0),k=e.length,m=whyx(j76()),h=m*jsx,b=m*y2b,d=m*dp37,l=m*glb;for(var g=0;g<k;g+=3){var a=parseInt(e.substr(g,2),10),c=parseInt(e.charAt(g+2),16);if(a<vm25){for(var f=h;f<h+jsx;f++){if(sfb[f][6]&&sfb[f][2]==a){sfb[f][5]=c}}for(var f=b;f<b+y2b;f++){if(p_qn[f][6]&&p_qn[f][2]==a){p_qn[f][5]=c}}for(var f=d;f<d+dp37;f++){if(jcks[f][6]&&jcks[f][2]==a){jcks[f][5]=c}}}else{for(var f=l;f<l+glb;f++){if(xt_y[f][6]&&xt_y[f][2]==a-vm25){xt_y[f][5]=c}}}}}function s_fh(a){var b,c=j76();if(a==847713){c=f_jx(c05y);if(k_2p()){b=c05y}else{b=c05y+vm25}}q20k(b,c,a)}function q20k(r,a,c){if(xh6==1||c==847713){if(c<16){var q=_04m();for(var o=0;o<q.length;o+=3){if(c==parseInt(q.charAt(o+2),16)){r=parseInt(q.substr(o,2),10);_s1v(r);break}}}vhz=_knq[r];var s=vhz.length;if(r<vm25){var g,p=_8bd.length;for(var e=0;e<s;e+=3){if(vhz.charAt(e)=="s"){for(var h=0;h<p;h+=2){if(_8bd.charAt(h)==a&&(parseInt(vhz.substr(e+1,2),10))==(h/2)){g=_knq[parseInt(vhz.substr(e+1,2),10)+vm25];for(var b=0;b<s;b+=3){g=g.replace(vhz.substr(b,3),"")}vhz+=g;s+=g.length}}}}for(var f=0;f<s;f+=3){while(vhz.charAt(f)=="s"||vhz.charAt(f)=="p"||vhz.substr(f,3)=="l"+rnv(r,2)){vhz=vhz.replace(vhz.substr(f,3),"");s-=3}}}else{if(r>=vm25){r-=vm25;for(var d=0;d<s;d+=3){while(vhz.charAt(d)=="l"||vhz.substr(d,3)=="s"+rnv(r,2)){vhz=vhz.replace(vhz.substr(d,3),"");s-=3}}}}if(c!=847713&&s>0){cyj(vhz)}}else{if(xh6<=0){vhz=""}}}function klc(){if($("playerMessageContent").innerHTML.indexOf(STR.CNFM_INVEST_PT.substr(10,15),0)>0){bhh(STR.MARCH_POWER);return false}if(c05y<0&&kw7==_04m()){bhh(STR.MARCH_ACTION);return false}else{if(!pln_(b66,_8bd,_dmx,null,false)){bhh(STR.MARCH_SUPPLY);lmgw(4);return false}else{var d,m=j76(),h=document.marchOrdersForm;if(dpx&&c05y>=0&&k_2p()){d=q7r_(c05y)}document.forms.marchOrdersForm.takeover.value=1;if((hkbt(m)==glb&&(!_kn7||_kn7<0||!__zb(_kn7)||m6_(q7r_(_kn7))==0||fjrn(_kn7)||_9v(_kn7)>sf50()))||(d>=0&&m6_(d)>0&&!confirm(STR.CNFM_PORT_TAKEOVER))){document.forms.marchOrdersForm.takeover.value=0}h.proceed.disabled=true;document.revokeForm.elements[0].disabled=true;h.ordersB.value=f0s;h.ordersL.value=y67;h.ordersS.value=_qnc;h.ordersT.value=n187;h.ordersG.value=x_05;if(_nr1==6){h.ordersM.value=fsny}h.land.value=b66;h.sea.value=_8bd;h.ports.value=dpx?_dmx:"";h.house.value=m;h.housepositions.value=_qks(whyx(m));h.baunits.value="";if(c05y>=0){if(_04m(m)!=d2t6("orders"+m)){bhh(STR.ERR_ORDER_REMOVED);return false}h343();var b=c05y,c=s_dt(),n=lz32(),a=_r5(),g=xl0(),k=dp37>0?STR.BATTLE_UNITS_LIST2:STR.BATTLE_UNITS_LIST,f=g>0?g+" "+STR.UNIT_SHIPS:STR.format(k,[c,n,a]),l=y3v(_kn7,g>0?"s":"l"),e=y3v(c05y,g>0?"s":"l");if(g>0){b+=vm25;if(_kn7>=_1_f){l=y3v(_kn7-_1_f,"p")}}if(!confirm(STR.format(STR.CNFM_ATTACK,[e,l,f]))){lmgw(4);h.proceed.disabled=false;document.revokeForm.elements[0].disabled=false;return false}h.boarea.value=_kn7;h.btarea.value=c05y;h.bstrattacker.value=lqm(b,0);h.bstrdefender.value=lqm(b,1);h.baunits.value=pjh;c05y=-1}}}}function h6n(){if(kw7==_04m()){bhh(STR.RAID_ACTION);return false}else{var a=document.raidOrdersForm;a.proceed.disabled=true;document.revokeForm.elements[0].disabled=true;a.ordersB.value=f0s;a.ordersL.value=y67;a.ordersS.value=_qnc;a.ordersT.value=n187;a.ordersG.value=x_05;if(_nr1==6){a.ordersM.value=fsny}a.house.value=j76();a.housepositions.value=_qks(whyx(j76()))}}function j073(a){if(a==_8jj()){return true}return false}function vx5k(){if(sd_4()==8&&pfdm!=1&&(h8v9()==false||(pfdm!=2&&cl0()))){var b=t3vt(mn4x),a=t3vt(msj);if((p_zy(mn4x)&&((cl0()&&pfdm==0)||(b<a&&kpc-_15==1)||(b>a&&kpc==_15)))||(p_zy(msj)&&((cl0()&&pfdm==0)||(a<b&&_15-kpc==1)||(a>b&&kpc==_15)))){return true}}return false}function hm3g(b){var c=j76(),a=d2t6("stolentokens");if(b=="throne"){a=c+""+a.substr(1,2)}else{if(b=="blade"){a=a.charAt(0)+""+c+""+a.charAt(2)}else{if(b=="raven"){a=a.substr(0,2)+""+c}}}document.phaseAForm.stolentokens.value=a}function z5ny(d){var b=-1,a;if(d>=vm25){a=_8bd.substr((d-vm25)*2,1)}else{a=b66.charAt(d*8)}while(++b<_nr1){var c=lmm[b];if(c!=j76()&&c!=a&&(hp_(d,c)>0||(d<vm25&&v70(d,c)>0))){return true}}return false}function v70(b,a){return m9x(b,a,0)}function _99(b,a){return m9x(b,a,2)}function _w5v(b,a){return m9x(b,a,3)}function mtb(b,a){return m9x(b,a,4)}function m9x(p,b,l){var o=_04m(b),c=0,m=0,k=0,n=0;if(sd_4()>5&&xy8()){return 0}for(var h=0;h<_knq[p].length;h+=3){if(_knq[p].charAt(h)=="l"){for(var g=0;g<o.length;g+=3){var e=o.charAt(g+2),f=o.substr(g,2).f6xc(),r=_knq[p].substr(h+1,2).f6xc();if(fs1(e)&&f==r&&tv6p(r)==b){var d=xnw3(r)-bzv(r),q=h_0n(r)-_10(r),a=fnd(r)-mf1(r);k+=q;if(a>0&&tv6p(p)!=tv6p(r)){n+=a}if(m5k!=9){m+=d}if(e=="9"){c++}}}}}switch(l){case 1:return n+k+m;case 2:return m;case 3:return k;case 4:return n;case 9:return c;default:break}return c+m+k*2+(n>0&&dr5m(p)?n*4:0)}function v11b(f,d){var a=_04m(d),e=_knq[f],b="";if(xy8()){e=_knq[f+vm25]}for(var c=0;c<e.length;c+=3){if(e.charAt(c)=="s"||(e.charAt(c)=="p"&&xy8())){b+=e.substr(c,3)}}return w0j(b,a,"9")}function w0j(f,b,e){var g,a;for(var d=0;d<f.length;d+=3){g=parseInt(f.substr(d+1,2),10);if(f.charAt(d)!="l"){g+=vm25;if(f.charAt(d)=="p"){g+=_1_f}}for(var c=0;c<b.length;c+=3){a=b.charAt(c+2);if(e.cdp(a)&&b.substr(c,2).f6xc()==g){return true}}}return false}function _k0(b,a){return y2gs(b,a,1)}function hp_(b,a){return y2gs(b,a,0)}function y2gs(o,a,h){var c,n=_04m(a),b=0,p=0,k=0;if(sd_4()>=6&&xy8()){c=_knq[o+vm25]}else{c=_knq[o]}for(var e=0;e<c.length;e+=3){var g=parseInt(c.substr(e+1,2),10);if(c.charAt(e)=="s"){for(var f=0;f<n.length;f+=3){var d=parseInt(n.charAt(f+2),16);if(g+vm25==parseInt(n.substr(f,2),10)&&d>=7&&d<=9&&_8bd.charAt(g*2)==a){var m=parseInt(_8bd.charAt(g*2+1))-_s8b(g);k+=m;if(d==9){b++}}}}else{if(c.charAt(e)=="p"&&(o>=vm25||(sd_4()>=6&&xy8()))){for(var f=0;f<n.length;f+=3){var d=parseInt(n.charAt(f+2),16);if((g+vm25+_1_f)==parseInt(n.substr(f,2),10)&&d>=7&&d<=9&&vxs(g)==a){var m=m6_(g)-_s8b(g+_1_f);p+=m;if(d==9){b++}}}}}}switch(h){case 1:return k+p;case 2:return k;case 2:return p;case 4:return b;default:break}return b+k+p}function __k_(){for(var a=0;a<_nr1*jsx;a++){if(sfb[a][0]){return sfb[a][2]}if(a<_nr1*y2b&&p_qn[a][0]){return p_qn[a][2]}if(a<_nr1*dp37&&jcks[a][0]){return jcks[a][2]}if(a<_nr1*glb&&xt_y[a][0]){return xt_y[a][2]}}return 0}function lqm(k,l){var o=_04m(),q,n,a=0,d=0,c=0,m=0,b,f,p,h=[0,0];for(var g=0;g<jsx*_nr1;g++){if(sfb[g][0]){a++;q=sfb[g][2]}if(g<y2b*_nr1&&p_qn[g][0]){d++;q=p_qn[g][2]}if(g<dp37*_nr1&&jcks[g][0]){c++;q=jcks[g][2]}if(g<glb*_nr1&&xt_y[g][0]){m++;q=xt_y[g][2]}}if(m==0){n=tv6p(k);h[0]+=a+d*2+c*(dr5m(k)?4:0)+v70(k,j76())+hp_(k,j76());h[1]+=xnw3(k)+h_0n(k)*2+v70(k,n)+hp_(k,n)-bzv(k)-_10(k)*2;if(gl4(k)){h[1]+=2}}else{n=b12j(k-vm25);h[0]+=m+hp_(k,j76());h[1]+=rypy(k-vm25)+hp_(k,n)-_s8b(k-vm25)}q=m==0?rnv(q,2):""+(q+vm25);for(var e=0;e<o.length;e++){if(o.substr(e*3,2)==q){b=o.charAt(e*3+2);if(b=="4"){h[0]-=1}else{if(b=="6"){h[0]+=1}}break}}p=_04m(n);for(var g=0;g<p.length;g++){if(p.substr(g*3,2)==rnv(k,2)){f=p.charAt(g*3+2);break}}if(f=="A"||f=="B"){h[1]+=1}else{if(f=="C"){h[1]+=2}}if(l==0||l==1){return h[l]}return h}function gb0h(a,h,b,f){z31=d2t6("routedunits");for(var c=0;c<z31.length;c+=6){var k=z31.charAt(c),l=parseInt(z31.substr(c+1,2),10);if(k!=tx0_(l)){z31=z31.substr(0,c)+z31.substring(c+6,z31.length)}}if(!(f instanceof Array)){return}if(k_2p()){h=rnv(h,2);b=rnv(b,2)}else{h+=vm25;b+=vm25}try{if(r06r()){var g=z31.indexOf(a+b);if(g>=0&&h!=b){z31=z31.substr(0,g)+z31.substring(g+6,z31.length)}}if(k_2p()){wtyr(h,a,f[0]);zn1(h,a,f[1]);c7v(h,a,f[2])}else{svt2(h,a,f[2])}}catch(d){}}function g_w5(a){r26(a,false)}function r26(r,a){var b=r06r(),B=b||mn4x=="S",D=B?msj:mn4x,u=B?mn4x:msj,m=B?c05y:_kn7,g=B?_kn7:c05y,C=g,n=xy8()?b12j(m):tv6p(m),h=[0,0,0];r=parseInt(r,10);if(!a){vhz="";vbb()}if(k_2p()){var p,x,F,A,y,E=xnw3(m),w=h_0n(m),z=fnd(m),l=s_dt(),q=lz32(),d=_r5();if(!B){n=qjp4();E=l;w=q;z=d;C=m}if(!B||r!=m){p=E;x=w;tgf.siege+=z;if(B){A=bzv(m);y=_10(m);p-=A;x-=y;tgf.trooper+=A;tgf.knight+=y}h=[p,x,0];if(p+x>0){py_f(r,p);msb(r,x);djx(r,n)}else{if(_0yd(r)==0&&_9v(r)==0){j5ct(r)}}}else{if(!a){th_6[4]+=E;th_6[5]+=w;th_6[6]+=z}}if(w59()){p=xnw3(C)-l;x=h_0n(C)-q;F=fnd(C)-d;if(p+x+F>0){_s3(C,p);b9tq(C,x);_3x6(C,F)}else{if(!fjrn(C)){j5ct(C)}else{_s3(C,0);b9tq(C,0);_3x6(C,0)}}}if(B){w2gm(m,false);if(w59()&&l+q+d>0){djx(m,u);_s3(m,l);b9tq(m,q);_3x6(m,d)}}else{_s3(C,p);b9tq(C,x)}if(!pln_(b66,_8bd,_dmx,n,!a)){if(!a){bhh(STR["BATTLE_RETREAT_SUPPLY"+(b?"":"2")])}if(E+w>0){var c=km7(r,E,w,0);h[0]-=c[0];h[1]-=c[1]}th_6[2]+=z}if(dpx){var s=false;if(__zb(m)){m92(m,a);s=true}if(__zb(C)){m92(C,a);s=true}if(!a&&s){_qd()}}if(!a){gb0h(n,r,m,h);m0d();p15z()}}else{var o=r>=_1_f,v=xl0(),e=m>=_1_f?m6_(m-_1_f):rypy(m),f=e;if(!B){n=qjp4();e=v;f=e;C=m}if(o||!B||r!=m){f-=B?_s8b(m):0;h=[0,0,f];if(C!=r){if(o){f+=m6_(r-_1_f);s4m(r-_1_f,f)}else{f+=rypy(r);m3x(r,f);rr_(r,n)}}}else{if(!a){th_6[7]+=e}}if(w59()&&C!=r){if(C<_1_f){f=rypy(C)-v;m3x(C,f)}else{gs1g(C-_1_f,-1*v)}}if(B){if(w59()&&v>0){m3x(m,v);rr_(m,u)}else{m3x(m,0)}}else{if(C<_1_f&&C!=r){m3x(C,f)}}if(!pln_(b66,_8bd,_dmx,n,!a)){if(!a){bhh(STR["BATTLE_RETREAT_SUPPLY"+(b?"":"2")])}if(e>0){var c=km7((r+vm25),0,0,e);h[2]-=c[2]}}if(!a){gb0h(n,r,m,h);m0d();_qd()}}if(!a){n95("WesterosMapImg");zgc();m+=k_2p()?0:vm25;if(hm4(D,m)){k440(m)}xrv(D);xrv(u)}}function zgc(){s2j("battleImg");s2j("attackerImg")}function s45(){_5l5();zgc();c05y=-1}function r7b4(){for(var a=0;a<8;a++){th_6[a]=0}}function fqf0(a){if(a==2){return true}return false}function zzp4(){return sd_4()>7&&cl0()&&(zh0()||(!_h1()&&!nq9v("G1")&&!nq9v("T1")&&!nq9v("M1")))}function wmt(){var h=[qws(),vpx()],a=[f_vz(),_q__()],g=[c05y,_kn7];while(a.length>0){var f=0,m=h.pop(),d=a.pop(),n=g.pop(),e=n!=c05y;if(fqf0(d)&&!(_09()&&m=="S2")){if(xy8()){var k=!e?rypy(n):xl0(),l=cz9(n+vm25);if(k>0){f=7;if(l){gs1g(n-_1_f,-1)}else{jr3(n,-1)}if(e){yc77(-1)}if(!e&&k==1){y6m(n+vm25,msj)}_qd()}}else{var c=!e?xnw3(n):s_dt(),p=!e?h_0n(n):lz32(),o=!e?fnd(n):_r5(),b=c+p+o==1;if(c>0){f=4;py_f(n,-1);if(e){t1f(-1)}}else{if(p>0){f=5;msb(n,-1);if(e){z0x(-1)}}else{if(o>0){f=6;g10h(n,-1);if(e){y9_(-1)}}}}if(b){if(!e){y6m(n,msj)}if(_0yd(n)==0&&_9v(n)==0){j5ct(n);if(__zb(n)){qd9(n);_qd()}}}p15z()}if(f>0){th_6[f]+=1}}}}function j75(b){var a=w2br(b);switch(a){case 4:return -1;case 3:return 1;default:break}return 0}function t0_k(a){if(!a.jyc2(0,6)){a=0}return m_18+a}function wpzj(a){if(cl0()){switch(a){case 6:return 3;case 5:return 2;case 4:return 1;case 3:return 1;default:break}}return 0}function vtg(){qtv=0;wr0x=0;tgf=new x6p_();r7b4();mn4x=qjp4();msj=wt5();_kn7=d2t6("originarea");c05y=d2t6("targetarea");pjh=d2t6("attackingunits");_15=d2t6("attackerstr")+d2t6("attackersupport")+wpzj(f_vz());kpc=d2t6("defenderstr")+d2t6("defendersupport")+wpzj(_q__());if(sd_4()>8&&d2t6("steelbladeused")==1){if(p_zy(mn4x)){_15+=1}else{if(p_zy(msj)){kpc+=1}}}}function tp9(b){var a=0;for(var c=0;c<b.length;c++){if(v11b(c05y,b.charAt(c))){a++}}return a}function tp5s(g,f){var b=_04m(f),a=b.length/3,e=k_2p(),c;if(c05y>=0){for(var d=0;d<a;d++){c=parseInt(b.substr(d*3,2),10);if((e&&c==g)||(!e&&c==g+vm25)){return d}}}else{for(var d=0;d<a;d++){c=parseInt(b.substr(d*3,2),10);if(c==g||c==g+vm25||c==g+vm25+_1_f){return d}}}return -1}function f__(b,a){return z2b(b,a,false)}function z2b(o,e,a){var t=s_dt(),m=lz32(),s=xl0();if(xy8()){var n=0,p=s;if(o!=_kn7){p=o<_1_f?rypy(o):m6_(o-_1_f);if(!a&&o==c05y){var b=_s8b(o),r=tx0_(o+vm25);n+=b;svt2(o,r,-1*b)}}while(e>0){if(p>n&&(_kn7!=o||s>n)){n++}e--}if(n>0){th_6[3]+=n;s-=n;if(o==_kn7){h0rw(p-n)}if(o<_1_f){jr3(o,-1*n);if(rypy(o)==0){if(o==c05y){k440(o+vm25)}}}else{if(dpx){gs1g(o-_1_f,-1*n)}}_qd()}}else{var c=0,d=0,l=0,f=xnw3(o),h=h_0n(o),g=fnd(o);if(!a&&o==c05y){var k=tx0_(o),q=bzv(o);routedKnights=_10(o);c+=q;d+=routedKnights;wtyr(o,k,-1*q);zn1(o,k,-1*routedKnights)}else{if(o==_kn7){g=_r5();if(a){f=s_dt();h=lz32()}else{l=g}}}while(e>0){if(a&&h>d){d++}else{if(a&&g>l){l++}else{if(f>c&&(_kn7!=o||t>c)){c++}else{if(h>d&&(_kn7!=o||m>d)){d++}}}}e--}if(c+d+l>0){th_6[0]+=c;th_6[1]+=d;th_6[2]+=l;if(o==_kn7){t-=c;m-=d;_1z(f-c);_3b_(h-d);_l47(g-l)}if(fjrn(o)||_9v(o)>c+d+l){py_f(o,-1*c);msb(o,-1*d);g10h(o,-1*l)}else{j5ct(o);if(o==c05y){k440(o)}if(__zb(o)&&(o==_kn7||d2t6("takeover")==0)){qd9(o);_qd()}}p15z()}}if(o==_kn7){return[t,m,s]}return[0,0,0]}function qf9(p){var g=k_2p(),b="",d=b66,m=_8bd,c=_dmx,n=tgf.ship,l=4,a=4;for(var f=0;f<p.length;f+=3){var k=p.charAt(f)=="p",o=p.substr(f+1,2).f6xc(),h=0,e=0;if(g){if(o!=_kn7){e=-1*_9v(o)}r26(o,true);e+=_9v(o);h=tgf.trooper+tgf.knight;tgf.trooper=0;tgf.knight=0;tgf.siege=0;b66=d}else{if((!k?o:o+_1_f)!=_kn7){e=-1*(k?m6_(o):rypy(o))}r26(!k?o:o+_1_f,true);e+=k?m6_(o):rypy(o);h=tgf.ship-n;tgf.ship=n;_8bd=m;_dmx=c}if(l>h){l=h}if(e>0&&a>=h){if(a>h){b="";a=h}b+=p.substr(f,3)}}pln_(b66,_8bd,_dmx);return b}function f_jx(a){return k_2p()?tv6p(a):b12j(a)}function m0_(e){var g="",c=!xy8();if(c){for(var b=1;b<vhz.length;b+=3){var d=vhz.substr(b,2).f6xc(),a=b66.charAt(d*8);if(vhz.charAt(b-1)=="l"&&d!=_kn7&&(a==e||(a=="n"&&b66.substr(d*8+1,4)=="0000"))){var f="l"+d;if(!$(f)){continue}g+=vhz.substr(b-1,3)}}}else{for(var b=1;b<vhz.length;b+=3){var d=parseInt(vhz.substr(b,2),10),a=_8bd.charAt(d*2);if((vhz.charAt(b-1)=="p"&&vxs(d)==e)||(vhz.charAt(b-1)=="s"&&d!=_kn7&&(a=="n"||a==e))){g+=vhz.substr(b-1,3)}}}_kn7=d2t6("originarea");if(g){g=qf9(g)}if(g.length>3){cyj(g)}vhz=g;return g}function _bq(){$("battleFormWrapper").style.display="";m0xj=true}function n6td(a){message='<br><center><table style="display:none" id="battleFormWrapper"><tr><td><form name="finishBattleForm" action="./setGameData.php?sendorders=1&game='+d8m+"&crc="+s2x+'" target="setDataFrame" onsubmit="return q32()" method="post"><input type="hidden" name="steelblade"><input type="hidden" name="textability"><input type="hidden" name="ordersB"><input type="hidden" name="ordersL"><input type="hidden" name="ordersS"><input type="hidden" name="ordersT"><input type="hidden" name="ordersG"><input type="hidden" name="ordersM"><input type="hidden" name="land"><input type="hidden" name="sea"><input type="hidden" name="ports"><input type="hidden" name="house"><input type="hidden" name="houseWinner"><input type="hidden" name="housepositions"><input type="hidden" name="routedunits"><input type="hidden" name="Lannisterpos"><input type="hidden" name="trackid" value=0><input type="hidden" name="aphaseplayer">';if(a){message+='<input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>&#160;&#160;&#160;<form name="revokeForm"><input class="button" type="button" value="'+STR.REVOKE+'" onclick="lmgw('+sd_4()+')"></form>'}message+="</td></tr></table></center>";$("gameStateForm").innerHTML=message}function _8jj(){var c=t3vt(mn4x),b=t3vt(msj),a=msj;if(_15>kpc||(kpc==_15&&b>c)){a=mn4x}if(zh0()&&cl0()&&sd_4()==10){var g=vpx(),f=qws();if(fyd(g)&&fyd(f)){var e=c05y+(k_2p()?0:vm25),d=tx0_(e);if(d==msj){a=msj}else{if(d!="n"){a=mn4x}}}else{if(fyd(g)){a=mn4x}else{a=msj}}}return a}function k_2p(){try{return sd_4()>5?d2t6("attackingunits").length==3:pjh.length==3}catch(a){return 0}}function xy8(){try{return sd_4()>5?d2t6("attackingunits").length==1:parseInt(pjh).jyc2(1,4)}catch(a){return 0}}function h8v9(){var a=0,b=false;if(zh0()){if(sf50()==0){a++;b=msj}if((xy8()&&rypy(c05y)==0)||(k_2p()&&_9v(c05y)==0&&!gl4(c05y))){a++;b=mn4x}if(a>1){b=false}}return b}var l9cf="";function f2x(){var m=vpx(),z=qws(),t=k_2p(),b="",k,r,x,h=0,s=h8v9();l9cf="";n6td(true);if(s==msj){r=msj;x=mn4x;rg2(z,m);if(j76()==mn4x){_bq();document.revokeForm.elements[0].disabled=true;m0d();if(t){k440(_kn7);if(_9v(c05y)==0){k440(c05y)}}else{k440(_kn7+vm25);if(rypy(c05y)==0){k440(c05y+vm25)}}zgc()}}else{if(s==mn4x){r=mn4x;x=msj;rg2(m,z);if(j76()==msj){_bq();g_w5(c05y+(t?0:vm25));m0d();k440(_kn7+(t?0:vm25))}}else{if(_8jj()==msj&&r06r()){var v=-1*mmt3(m),d=mmt3(z)-(v>0?v:0);k=f__(_kn7,d);rg2(z,m);r=msj;x=mn4x;if(j76()==mn4x){_bq();document.revokeForm.elements[0].disabled=true;m0d();k440(_kn7+(t?0:vm25));if(t&&_9v(c05y)==0){k440(c05y)}zgc()}gb0h(mn4x,_kn7,_kn7,k);vx5()}else{var l=c05y,c=m,A=z,a=r06r(),v,d;r=mn4x;x=msj;if(!a&&mn4x!="S"){r=msj;x=mn4x;l=_kn7,c=z;A=m}v=-1*mmt3(A),d=mmt3(c)-(v>0?v:0);if(d>0){f__(l,d)}rg2(c,A);if((j76()==x&&a)||(j76()==r&&!a)){_bq();if((!a&&x==mn4x&&sf50()>_r5())||(t&&(_9v(c05y)>fnd(c05y)||(!a&&gl4(c05y))))||(!t&&rypy(c05y)>0)){if(a){s_fh(847713)}else{q20k(c05y+(t?0:vm25),x,847713);_kn7=-1}b=m0_(x)}h=b.length/3;if(h<1){g_w5(l)}else{if(h==1){var y=b.charAt(0)!="p"?b.substr(1,2):parseInt(b.substr(1,2),10)+_1_f;g_w5(y)}}m0d();if(ryp3()){var o=_kn7+(t?0:vm25),n=c05y+(t?0:vm25);j72f(r,o,n);if(b.length<4){xrv("T")}}else{k440(_kn7+(t?0:vm25))}}}}}wq_l(r);var p="";if(j76()==r){p+=STR.BATTLE_RESULT_WIN}else{if(j76()==x){p+=STR.BATTLE_RESULT_LOSE}else{var e=_hm2(r);houseNameL=_hm2(x);p+=STR.format(STR.BATTLE_RESULT_SPEC,[e,houseNameL])}}var w=th_6[0]+th_6[4]+tgf.trooper,f=th_6[1]+th_6[5]+tgf.knight,g=th_6[2]+th_6[6]+tgf.siege,q=th_6[3]+th_6[7]+tgf.ship;if(w+f+g+q>0){p+="\n\n"+STR.BATTLE_KILLED+":";if(w>0){p+="\n "+w+" "+STR.UNIT_FOOTMEN}if(f>0){p+="\n "+f+" "+STR.UNIT_KNIGHTS}if(g>0){p+="\n "+g+" "+STR.UNIT_SIEGES}if(q>0){p+="\n "+q+" "+STR.UNIT_SHIPS}}if(j76()!=x&&h>0){p+="\n\n"+STR.BATTLE_RETREAT_SPEC}if(a&&j76()==msj&&j76()==x){if(h>1){p+="\n\n"+STR.BATTLE_RETREAT_CHOOSE}else{if(h==1){var u=$(b.charAt(0)+b.substr(1,2).f6xc()).title;p+="\n\n"+STR.format(STR.BATTLE_RETREAT_FORCE,[u])}else{p+="\n\n"+STR.BATTLE_NO_RETREAT}}}if(j76()==mn4x||j76()==msj){bhh(p+l9cf)}if(x=="S"&&[m,z].cdp("S7")&&[m,z].cdp("L1")){d3t()}}function j72f(f,e,g){var d=d2t6("orders"+f),b=_04m(f),a;p27(g,tx0_(g));for(var c=0;c<d.length;c+=3){if(e==parseInt(d.substr(c,2),10)){a=g+""+d.charAt(c+2);b+=rnv(a,3);for(var c=0;c<b.length;c+=3){if(e==parseInt(b.substr(c,2),10)){b=b.substr(0,c)+b.substr(c+3);break}}if(b!=d){y87(f,b)}break}}}function qd9(a){m92(a,false)}function m92(e,c){if(__zb(e)){var b=d2t6("land").charAt(e*8),d=q7r_(e),a;km7(d+vm25+_1_f,0,0,3);if(!c&&(m6_(d)==0||b66.charAt(e*8)!=b)){k440(d+vm25+_1_f)}}}function fz0(d){var c=sd_4(),h=d.charAt(4),b=document.sendCardsForm,g="c_icon_"+h+d.charAt(5);b2j=kypb(j76());if((c==7||(c==8&&j76()=="G"&&xh_.charAt(28)!=d2t6("cards").charAt(28)))&&document.sendCardsForm&&j76()==h&&b2j.substr(parseInt(d.charAt(5))-1,1)=="1"){var f=b.card.value.indexOf(d.substr(4,2));if(f>=0){$(g).className=v4h(j76(),1);b.card.value=b.card.value.substr(0,f)+""+b.card.value.substr(f+2,b.card.value.length)}else{if(!_v1||b.card.value.length>=6){w2m();b.card.value=d.substr(4,2)}else{b.card.value+=d.substr(4,2)}$(g).className=v4h(j76(),2)}}else{if(m0xj&&document.phaseAForm&&(c==11||(c==10&&_zg(j76())>0))){var a=_03h();b2j=kypb(a);if(h==a&&b2j.substr(parseInt(d.charAt(5))-1,1)=="1"){w2m();if(!$(g).className.cdp("used")){b2j=b2j.substr(0,parseInt(d.charAt(5))-1)+"0"+b2j.substr(parseInt(d.charAt(5)));$(g).className=v4h(a,2);document.phaseAForm.house.value=a;document.phaseAForm.cardstring.value=b2j}}}else{if(m0xj&&(c==10||(d.length<2&&wb_j()))){for(var e=1;e<8;e++){if($("usedCard"+e)&&$("usedCard"+e).className.cdp("select")){$("usedCard"+e).className=v4h(j76(),1)}}$("usedCard"+d).className=v4h(j76(),2);b2j=b2j.substr(0,parseInt(d,10)-1)+"1"+b2j.substr(parseInt(d,10));b.card.value=d.substr(4,2)}}}}function _03h(){return j76()==mn4x?msj:mn4x}function j1hg(){var b=qjp4(),a=wt5();$("c_icon_"+qgyl(b)).className=v4h(b,0);$("c_icon_"+qgyl(a)).className=v4h(a,0)}function p9t(){var b=document.sendSupportForm;if(!b.elements[0].checked&&!b.elements[1].checked&&!b.elements[2].checked){bhh(STR.BATTLE_SUPPORT_SELECT);return false}if(dp37>0&&dr5m(c05y)&&b.supportstrland.value>3&&$("radioSupportDefender").checked){var a=mtb(c05y,j76());b.supportstrland.value-=a*4}b.proceed.disabled=true;n95(b.proceed)}function fyw7(){var a=sd_4(),b=j76();fObj=document.sendCardsForm;card=fObj.card.value;if((a==0||a==10)&&b2j==kypb(b)&&b2j.length==7&&b2j!="1111111"){if(!confirm(STR.CNFM_NO_CARD)){return false}else{if(a==0){fObj.nocardconfirm.value="OK"}}}if(!_v1&&(a==7||a==8)&&fObj.card.value.length!=2){bhh(STR.BATTLE_HOUSE_CARD);return false}else{if(_v1&&(a==7||a==8)&&fObj.card.value.length!=6){bhh(STR.BATTLE_3HOUSE_CARDS);return false}else{try{fObj.proceed.disabled=true}catch(c){}if(a==7||a==8){fObj.house.value=b;if(_v1){card=b+"0"}if(mn4x==j76()){fObj.actor.value="attacker";_dby("attackercard",card)}else{fObj.actor.value="defender";_dby("defendercard",card)}}else{fObj.cardstring.value=b2j;fObj.house.value=b;if(a!=10){jf_8()}fObj.houseposition.value=l_q0;l_q0+="x";_5l5()}}}return true}function zfkw(){var k=sd_4(),e=k_2p(),a=e?3:4,h=["FM","KT","SE","SP"],f=[jsx,y2b,dp37,glb],g=[s_dt(),lz32(),_r5(),xl0()];for(var c=e?0:3;c<a;c++){if(g[c]>0){var d=gwm4(h[c]),l=_nr1*f[c];for(var b=0;b<l;b++){if(g[c]>0&&k<10&&d[b][6]&&d[b][4]==mn4x&&d[b][2]==_kn7){y6h(mn4x+h[c]+b,"_select");if(--g[c]==0){break}}}}}if(e){$("battleImg").style.left=p40[c05y][6];$("battleImg").style.top=p40[c05y][7]+4;$("attackerImg").style.left=p40[_kn7][6];$("attackerImg").style.top=p40[_kn7][7]+3}else{$("battleImg").style.left=wq_[c05y][6];$("battleImg").style.top=wq_[c05y][7]+4;if(_kn7<_1_f){$("attackerImg").style.left=wq_[_kn7][6];$("attackerImg").style.top=wq_[_kn7][7]+3}else{$("attackerImg").style.left=bwjt[_kn7-_1_f][0]-6;$("attackerImg").style.top=bwjt[_kn7-_1_f][1]-32}}}function q32(n){lphh();var q=j76(),o=document.finishBattleForm,k=r06r(),d=nq9v("T1"),g=!d&&q2j(),l=ryp3(),b=n==1||n==2;if(!n&&!d&&!g&&vhz.length/3>1){if(!k){bhh(STR.BATTLE_RETREAT2)}else{if(j76()==msj){bhh(STR.BATTLE_RETREAT)}}return false}else{if(n>1){if(b){if(!confirm(STR.CNFM_NO_BLADE)){q4dc();return false}o.steelblade.value=2}else{if(!confirm(STR.CNFM_NO_TEXT_ABILITY)){var f=wt5()==q?qws():vpx();mw9(f);return false}o.textability.value=2;m0xj=false}}else{if(n){if(b){o.steelblade.value=1}else{o.textability.value=n;if(n=="G1"){xh_=xh_.ybz_(28,"0");w2m();_q4(0,7);document.sendCardsForm.house.value=q;document.sendCardsForm.textability.value=n;return false}else{if(n=="T1"){_5l5();var m=c05y;if(xy8()){m+=vm25}ql5(m);_bq();return false}else{if(n=="M1"){rj7();return false}}}}}else{if(g&&o.trackid.value=="0"&&!confirm(STR.CNFM_NO_TEXT_ABILITY)){return false}else{if(!g){var a=d?_03h():mn4x,p=_04m(a),c=d2t6("orders"+a);if(p==c||p.length>c.length){bhh(d?STR.BATTLE_CARD_OLENNA:STR.ERR_ORDER_ATTACKER);return false}}}}}if(l&&q!="T"&&j073("T")&&!n&&!o.textability.value&&!vrbs(n187,[4,5,6],c05y)){bhh("ERROR: "+STR.ERR_CONTACT);return false}try{o.proceed.disabled=true;document.revokeForm.elements[0].disabled=true}catch(h){}o.ordersB.value=f0s;o.ordersL.value=y67;o.ordersS.value=_qnc;o.ordersT.value=n187;o.ordersG.value=x_05;if(_nr1==6){o.ordersM.value=fsny}o.land.value=b66;o.sea.value=_8bd;o.ports.value=dpx?_dmx:"";o.house.value=q;o.houseWinner.value=_8jj();o.housepositions.value=_qks(whyx(q));o.routedunits.value=z31}wp6();if(n){o.submit()}}function zhyn(a){var h=$("eventDecks"),g=d2t6("altwphase")==1,f="<table cellpadding=0 cellspacing=0><tr>",e="carddeck";$("event-reminder-field").style.display="";if(a>0&&g){e="nextcard"}if(v0q()>1&&d2t6("carddeck3")!="0"&&(g||d2t6(e+"1")=="0")){$("event-reminder-field").style.display="table-row";$("event-card-reminder").innerHTML=c25("evt3:"+d2t6("carddeck3"))}for(var d=1;d<4;d++){f+="<th width=155>";var c=g||a==0?d2t6(e+d):"0",b=c!="0"?_yh2(d,c):"";className="event-deck"+(c!="0"?"":" event-deck-cover event-deck-cover"+d);f+='<table width=125 height=70 class="'+className+'" onmouseover="__zs(this, \'evt'+d+":"+c+'\')" onmouseout="h343()">';f+="<tr><th>"+b+"</th></tr></table>";f+="</th>"}h.innerHTML=f+"</tr></table>";h.style.left=145;h.style.top=15}function jf_8(){var e,f,d=_nr1<6?5:_nr1;_hmv();if(!cdt.jyc2(1,3)){cdt=1}for(var c=0;c<d;c++){var b=c*6+cdt-1,a=0;while(d>a++){if(document.images["aof"+cdt+a].src.cdp("house"+lmm[c])){break}}l_q0=l_q0.ybz_(b,a);f=d2t6("bid"+lmm[c]);if(f>0){e=ll1q[c][0]-f;tf8(c,e)}}}function xw50(){var b,c;c='<img src="./images/wildlings.png" width=22>';if(lyys()){c='<img src="'+b331(cdt)+'">'}b='<table class="box_extend box_game_state"><tr> <td width=50>'+c+"</td><th>"+STR.DLG_BID_TITLE+'</th><td width=50 align="right">'+c+'</td></tr> <tr><td colspan=3 align="center"><nobr>';for(var a=0;a<_nr1;a++){b+=' <img src="'+_1d(lmm[a])+'" width=11> <div id="'+lmm[a]+'BidTokens">'+ll1q[a][0]+"</div>&#160;"}b+=' </nobr></td></tr> <tr><th colspan=3>    <table width="75%" align="center"><tr>     <th align="left"><span style="cursor:pointer;color:red;font-size:48px" onclick="jz0_(-1)">&#9660;</span></th>     <th> <span style="font-size:36px"> <div id="jz0_">'+(fk0f<0?"?":fk0f)+'</div> </span> </th>     <th align="right"><span style="cursor:pointer;color:green;font-size:48px" onclick="jz0_(1)">&#9650;</span></th>    </tr></table> </th></tr></table>';$("leak_menu").innerHTML=b;jz0_(d2t6("mybid"),"SET");$("leak_menu").style.left=-1;$("leak_menu").style.top=tb4($("gameStateField"))-23}function xr7(a){var e=document.images["aof"+cdt+a];if(b39(j76())&&d2t6("bidcount")>=_nr1&&e.src.cdp("empty")){for(j=1;j<=_nr1;j++){var d=document.images["AoFSel"+j],c=document.images["AoF"+j];if(kt_h[j-1]&&d.src.cdp("sword")){if(rsdx[j-1].cdp(a)){e.src=c.src;d.src="./images/blind.gif";c.src="./images/house_empty.gif";n95(e);n95(c);for(var b=1;b<=_nr1;b++){if(kt_h[b-1]&&!document.images["AoF"+b].src.cdp("empty")){document.images["AoFSel"+b].src="./images/sword_attacker.gif";break}}}else{bhh(STR.EVT_CLASH_TIED)}break}}}}function djg0(a){if(!document.images["AoF"+a].src.cdp("house_empty.gif")){for(var b=1;b<=_nr1;b++){if(kt_h[b-1]){document.images["AoFSel"+b].src="./images/blind.gif"}}document.images["AoFSel"+a].src="./images/sword_attacker.gif"}}function d_pr(){var k,c,f=0,h=[],g=[];for(var e=0;e<_nr1;e++){g[e]=[]}for(var d=0;d<_nr1;d++){if(kt_h[d]){k=d2t6("bid"+lmm[d]);$("AoFBid"+(d+1)).innerHTML=k;g[f][0]=k;g[f++][1]=d}else{g.pop()}h[d]=false;if(document.images["aof"+cdt+(d+1)].src.cdp("empty")){h[d]=true}rsdx[d]=""}g.sort(w77);c=0;k=g[0][0];for(var e=0;e<g.length;e++){if(k==g[e][0]){while(!h[c++]){}for(var a=0;a<g.length;a++){if(g[a][0]==k){rsdx[g[a][1]]+=""+c}}}else{k=g[e--][0]}}}function vlm(){var a="./images/sword_attacker.gif",c='<table class="box_extend box_aof"><tr><th colspan=3>'+STR.DLG_TIED_BIDS_TITLE+"</th></tr>";for(var b=1;b<=_nr1;b++){if(kt_h[b-1]){c+="<tr>";c+='<th><img id="AoFSel'+b+'" width="40" src="'+a+'"></th>';c+='<th><img id="AoF'+b+'" width="40" height="40" src="'+kt_h[b-1]+'" onclick="djg0('+b+')" style="cursor:pointer"></th>';c+='<th><div id="AoFBid'+b+'"></div></th>';c+="</tr>";a="./images/blind.gif"}}c+="</table>";$("leak_menu").innerHTML=c;$("leak_menu").style.left=-1;$("leak_menu").style.top=tb4($("AoFField"))-24;d_pr()}function bpd(){var e,c=_nr1<6?5:_nr1,d=[];for(var b=0;b<c;b++){d[b]=[];d[b][0]=d2t6("bid"+lmm[b]);d[b][1]=xx9(lmm[b]);d[b][2]=b}d.sort(w77);if(cdt==1){document.images.aof11.src="./images/house_empty.gif"}for(var b=0;b<c;b++){document.images["aof"+cdt+(b+1)].src="./images/house_empty.gif";kt_h[d[b][2]]=false;if(d[b][0]>=0){for(var a=0;a<c;a++){if(b!=a&&d[b][0]==d[a][0]){e=true;kt_h[d[b][2]]=d[b][1];break}}}if(!kt_h[d[b][2]]){document.images["aof"+cdt+(b+1)].src=d[b][1]}}if(e&&b39(j76())){vlm()}}function cp3(){var b=j76();b2j=kypb(b),availableCards=false,content='<table class="box_extend box_game_state"><tr><th colspan='+(b2j._jj("0")+2)+">"+STR.DLG_SELECT_CARD+"</th></tr><tr><th></th>";for(var a=1;a<8;a++){if(b2j.charAt(a-1)=="0"){content+='<td width=28><div id="usedCard'+a+'" class="mini'+zv0+" card_"+b+'" style="cursor:pointer" onclick="fz0(\''+a+"')\" onmouseover=\"__zs(this, 'card"+b+a+'\')" onmouseout="h343()" /></td>';availableCards=true}}if(!availableCards){content+="<small><i>"+STR.DLG_SELECT_CARD_NONE+"</i></small>"}content+='<th></th></tr></table><form name="sendCardsForm" action="./setGameData.php?game='+d8m+"&crc="+s2x+'" target="setDataFrame" method="post"><input type="hidden" name="card"><input type="hidden" name="cardstring"><input type="hidden" name="nocardconfirm"><input type="hidden" name="house"><input type="hidden" name="houseposition">';if(sd_4()==10){content+='<input type="hidden" name="type" value="'+qgyl(b)+'">'}content+="</form>";$("leak_menu").innerHTML=content;$("gameStateForm").innerHTML='<input class="button" type="button" onclick="if (fyw7()){document.sendCardsForm.submit();$(\'gameStateForm\').innerHTML=\'\';}" value="'+STR.PROCEED+'">';$("leak_menu").style.left=-1;$("leak_menu").style.top=tb4($("gameStateField"))-23}function j_m(d,e){var c=String();c='<form name="wildlingHouseChoiceForm" action="./setGameData.php?housechoice='+e+"&game="+d8m+"&crc="+s2x+'" target="setDataFrame" onsubmit="return _5l5()" method="post"><table class="box_extend box_game_state"><tr><th colspan=2>'+STR.DLG_TIED_BIDS_TITLE+"</th></tr><tr><td colspan=2><small>";if(e==2){c+=STR.EVT_WILDLINGS_4MP}else{c+=STR.EVT_WILDLINGS_RETURN_CARD}c+=":</small></td></tr>";for(var a=0;a<_nr1;a++){var b=lmm[a];if(d[0]==d2t6("bid"+b)){c+='<tr><th style="padding-right:8px;height:18px;width:35%;" align="right"><img src="'+xx9(b)+'" height=16></th><td><input style="cursor:pointer" type="radio" name="house" value="'+b+'" id="radio'+b+'"><small><label for="radio'+b+'" style="cursor:pointer">'+_hm2(b)+"</label></small></td></tr>"}}c+="</table></form>";$("leak_menu").innerHTML=c;document.wildlingHouseChoiceForm.elements[0].checked=true;$("gameStateForm").innerHTML='<input class="button" type="button" onclick="document.wildlingHouseChoiceForm.submit();$(\'gameStateForm\').innerHTML=\'\'" name="proceed" value="'+STR.PROCEED+'">';$("leak_menu").style.left=-1;$("leak_menu").style.top=tb4($("gameStateField"))-23}function b1p(){var a=d__q();if(_h9()>=g70()){a.sort(ls1w);kt_h=a;if(a[0]==a[1]&&!d2t6("ordersall")){if(b39(j76())){j_m(a,1)}return 1}return 0}else{a.sort();kt_h=a;if(a[0]==a[1]&&!d2t6("ordersall")){if(b39(j76())){j_m(a,2)}return 2}return -1}}function jz0_(c,a){var b=whyx(j76());if(a=="SET"){if(c>=0&&c<=ll1q[b][0]){fk0f=c;ll1q[b][0]=kd05(b)-fk0f}else{return}}else{if(c>0&&ll1q[b][0]>0){if(++fk0f>0){ll1q[b][0]--}}else{if(c<0&&fk0f>0){fk0f--;ll1q[b][0]++}else{return}}document.eventForm.bidvalue.value=fk0f}$("jz0_").innerHTML=fk0f;$(j76()+"BidTokens").innerHTML=ll1q[b][0]}function _1m(e,d,b){var g=0,a;switch(d){case"power":a=4;break;case"castle":a=5;break;case"stronghold":a=5;break;case"winPoints":a=5;break;case"barrel":a=6;break;case"crown":a=7;break;default:return 0}for(var c=0;c<vm25;c++){if(tv6p(c)==e){var f=xcjj(c,a);if(f>1){if(d=="castle"||d=="power"){continue}else{if(d=="stronghold"||d=="winPoints"){f--}}}else{if(d=="stronghold"){continue}}g+=f}}if(g>6&&d=="barrel"){return 6}return g}function jdd7(){var b=j76(),a=whyx(b)*6+3,c=_1m(b,"barrel");l_q0=d2t6("houses").ybz_(a,c);_xnx(c)}function q3m(c){var b,d=0;for(var a=0;a<_dmx.length;a++){b=hb7d(a);if(m6_(a)>0&&vxs(a)==c&&(b12j(b)==c||b12j(b)=="n")){d++}}return d}function gnx(){var b,c=_nr1<5?5:_nr1;l_q0=d2t6("houses");for(var a=0;a<c;a++){b=_1m(lmm[a],"crown");if(dpx){b+=q3m(lmm[a])}if(ll1q[a][0]+ll1q[a][1]+b>x3f){b=x3f-(ll1q[a][0]+ll1q[a][1])}tf8(a,b+ll1q[a][0])}}function v39g(l){var k=sd_4(),a=j76(),m="";for(var f=0;f<vm25;f++){var h=rnv(f,2),b;if((k==0&&dr5m(f)&&tv6p(f)==a)||(k==5&&h==l)){m+="l"+h;b=_knq[f].match(/.{1,3}/g);while(b.length>0){var d=b.pop(),c=d.charAt(0);if(c=="s"){var e=d.substr(1).f6xc(),g=b12j(e);if(g=="n"||g==a){m=m.replace(d,"")+d}}else{if(c=="p"){m+=d}}}}}vhz=m;cyj(m)}function _40(c){var a=d6kx.length;d6kx[a]=[];d6kx[a]["land"]=b66;d6kx[a]["sea"]=_8bd;d6kx[a]["ports"]=_dmx;d6kx[a]["mpoints"]=new Array();for(var b=0;b<8;b++){d6kx[a].mpoints[b]=new Array();d6kx[a].mpoints[b][0]=r70[b][0];d6kx[a].mpoints[b][1]=r70[b][1]}if(sd_4()==5&&r70[c][1]==0){k440(xp4g)}f72()}function k43(b){var a=-1;while(++a<8){if(r70[a][0]==b){return a}}return -1}function jf3_(){while(d6kx.length>0){d6kx.pop()}for(var a=0;a<8;a++){r70[a][1]=0}pvl()}function qc0(c){var b=0;jf3_();for(var a=0;a<vm25;a++){if(b<8&&tv6p(a)==c&&dr5m(a)){r70[b][0]=a;r70[b++][1]=jhh(a)}}}function m_41(){for(var a=0;a<8;a++){if(r70[a][1]>0&&m_h(r70[a][0])){return false}}return true}function m_h(m){var c=k43(m),a=j76(),b=h0nv(a)<jsx,n=qzs(a)<y2b,p=k9tw(a)<dp37,o=hkbt(a)<glb;if(c<0||r70[c][1]<=0){return false}var q,k=b66,h=xnw3(m);if(h>0&&(n||p)){return true}else{if(b){py_f(m,1);q=pln_(b66,_8bd,_dmx,null,false);b66=k;if(q){return true}}else{if(r70[c][1]>=2&&(n||p)){msb(m,1);q=pln_(b66,_8bd,_dmx,null,false);b66=k;if(q){return true}}}}if(o){var l=_knq[m];k=_8bd;for(var g=1;g<l.length;g+=3){if(l.charAt(g-1)!="s"){continue}var d=l.substr(g,2).f6xc(),e=b12j(d);if(e=="n"){return true}else{if(e==a){rr_(d,a);jr3(d,1);q=pln_(b66,_8bd,_dmx,null,false);_8bd=k;if(q){return true}}}}k=_dmx;var f=-1;while(dpx&&++f<nq5l){if(m==nrkx(f)){gs1g(f,1);q=pln_(b66,_8bd,_dmx,null,false);_dmx=k;if(q){return true}}}}return false}function _kr3(){var a=true;if(vhz.length>0&&!hg7()){if(!confirm(STR.CNFM_NO_NEW_UNITS)){return false}a=false}if(a&&!m_41()&&!confirm(STR.CNFM_NOT_ALL_MP)){return false}if(a&&!pln_(b66,_8bd,_dmx)){bhh(STR.EVT_MUSTER_LOW_SUPPLY);return false}document.eventForm.proceed.disabled=true;document.revokeForm.elements[0].disabled=true;document.eventForm.land.value=b66;document.eventForm.sea.value=_8bd;document.eventForm.ports.value=dpx?_dmx:"";vbb();vhz="";m0d();jf3_()}function t_g3(){var c=document.eventForm;c.proceed.disabled=true;if(lyys()){for(var a=1;a<=_nr1;a++){if(document.images["aof"+cdt+a].src.cdp("empty")){bhh(STR.EVT_CLASH_EMPTY_SLOTS);c.proceed.disabled=false;return false}}jf_8()}if(ysf()||wb_j()){if(!pln_(b66,_8bd,_dmx)){dnj();bhh(STR.EVT_SUPPLY_INFO);c.proceed.disabled=false;return false}else{var b=j76();if(wb_j()){if(hzd>0&&(h0nv(b)>0||qzs(b)>0||k9tw(b)>0||hkbt(b)>0)){bhh(STR.EVT_SUPPLY_NOT_READY);c.proceed.disabled=false;return false}}else{c.positions.value=_qks(whyx(b));dnj()}m0d();if(hg7()){document.revokeForm.elements[0].disabled=true;c.land.value=b66;c.sea.value=_8bd;c.ports.value=dpx?_dmx:""}}}else{c.proceed.disabled=true;c.Baratheon.value=_qks(0);c.Lannister.value=_qks(1);c.Stark.value=_qks(2);c.Tyrell.value=_qks(3);c.Greyjoy.value=_qks(4);if(_nr1>5){c.Martell.value=_qks(5)}l_q0=""}}function m7l(a){var b=document.eventForm;if(m0xj&&a){lphh();b.eventChoice.value=a;b.eventDeck.value=d1x();b.submit()}}function zq8h(){var a=document.eventForm;a.proceed.disabled=true;if((lyys()||wb_j())){var b=parseInt(a.bidvalue.value,10);if(fk0f<0){a.proceed.disabled=false;bhh(STR.BID_MISSING);return false}else{if(fk0f==d2t6("mybid")){_hmv();_q4(v0q(),sd_4());bhh(STR.format(STR.BID_ALREADY,[fk0f]));cty_();return false}else{if(!b||b<=0){if(!confirm(STR.CNFM_NO_BID)){a.proceed.disabled=false;return false}else{a.bidvalue.value="0confirmed"}}}}}}function w8y(){var a=STR.DLG_SWITCH_TITLE+"<br /><br />";a+="<i>"+STR.DLG_SWITCH+"</i><br />"+STR.CNFM_PBEM_SWITCH+"<br />";a+='<div onclick="x10()">'+STR.YES+"</div>";a+='<div onclick="lphh()">'+STR.NO+"</div>";flg(a)}function kvb9(d,b){var c='<table width=125 cellspacing=0 cellpadding=0 class="requestwindow">';for(var a=1;a<b.length;a+=3){c+='<tr onclick="wl_('+d+","+(parseInt(b.substr(a,2),10))+')"><td onmouseover="style.backgroundColor=\'#FFFFFF\'" onmouseout="style.backgroundColor=\'\'" style="cursor:pointer">&#160;&raquo;<small>&#160;'+y3v(b.substr(a,2),"l")+"</small></td> </tr>"}c+="</table>";_9c(c,d<5?25:wq_[d][0]-50,wq_[d][1]+40)}function x10(){flg("processing...");__b("set=switchmode",dwgr)}function dwgr(a){lphh();document.images.pbemSwitchImg.style.display="none"}function r9g8(a){try{var b=JSON.parse(a);$("nText").innerHTML=b.notes}catch(c){bhh(STR.ERR_NOTES_LOADING);lphh()}}function b5_h(){var a=sd_4();if(a>5){if(parseInt($("actionWindow").style.left)>0){_5l5()}else{_xnx(a)}}}function v__(){if(parseInt($("playerMessageDialog").style.left)>0){lphh();return}$("playerMessageContent").innerHTML='<form name="notesForm" action="./setGameData.php?updateNotes=1&game='+d8m+"&crc="+s2x+'" target="setDataFrame" method="post"><table class="notes"><tr><td width=19></td><td>'+STR.DLG_NOTES_TITLE+'</td><td width=19><img id="xNotes" src="./images/x0.gif" border=0 style="cursor:pointer" onmouseover="document.images[\'xNotes\'].src=\'./images/x1.gif\'" onmouseout="document.images[\'xNotes\'].src=\'./images/x0.gif\'" onclick="lphh()"></td></tr><tr><td colspan="3"><textarea id="nText" name="notes" rows=18 cols=32 maxlength=1024>Loading...</textarea></td></tr><tr><td colspan="3" align="center"><input type="submit" value="'+STR.UPDATE+'"></td></tr></table></form>';r16_();fd0s("get=GAMENOTES",r9g8)}function r16_(){$("playerMessageDialog").style.left=($("mainTable").offsetWidth-$("playerMessageContent").offsetWidth)/2;$("playerMessageDialog").style.top=(screen.height/2)-200}function x87(b){var c=_hm2(b),a="<br /><br /><small>";if(j76()==b){a=STR.GAME_OVER_WIN+a+STR.format(STR.GAME_OVER_TXT,[c])}else{a=STR.GAME_OVER_DEFEAT+a+STR.format(STR.GAME_OVER_TXT_NAME,[c,"<nobr>"+qjg(b)+"</nobr>"])}a+='</small><br /><div onclick="lphh()">'+STR.OK+"</div>";if(d8m%7<2){a+='<br /><br /><hr><small><i>If you enjoy playing, please consider a <a title="More information here!" href="https://www.thronemaster.net/?goto=donation">donation</a> to support our project. Thank you!</i><br /><br /></small><form action="https://www.paypal.com/cgi-bin/webscr" method="post"><input type="hidden" name="cmd" value="_s-xclick"><input type="hidden" name="hosted_button_id" value="55MNTVAV7G2R4"><input type="image" src="https://www.paypalobjects.com/en_GB/i/btn/btn_donate_SM.gif" border=0 name="submit" alt="Donate" title="Your donation is much appreciated!"></form>'}c9qg(a)}function pb90(){var f=[],e=0,d='<table width=180 cellspacing=5 class="actionwindow overlay_shadow dlg_battle" style="background-image:url('+q1x.src+'); background-image:repeat;"><tr><th colspan=3>'+STR.DLG_MENU_BIDS+"</th></tr>";for(var b=0;b<_nr1;b++){var c=lmm[b];if(mymk(c)){f[e]=[];f[e][0]=d2t6("bid"+c);f[e][1]=_hm2(c);f[e][2]=_1d(c);e++}}f.sort(yvc);while(f.length>0){var a=f.pop();d+='<tr><td align="right" width="30%"><img src="'+a[2]+'" width="11"></td><th><small>'+a[0]+"</small></th><td><small>"+a[1]+"</small></td></tr>"}d+='<td colspan="3"><table align="center" style="cursor:pointer" onclick="lphh()" onmouseover="style.backgroundColor=\'#EEFFEE\'" onmouseout="style.backgroundColor=\'\'" class="actionwindow"><tr><th>'+STR.O_K+"</th></tr></table> </td></tr></table>";$("playerMessageContent").innerHTML=d;if(!b39(j76())){_5l5()}r16_();qzc(STR.DLG_MENU_BIDS)}function xp5(b){if(!_j5z(b)){var a="<b>"+STR.MARCH_AREA_CONTROL+"</b><br /><br />"+STR.format(STR.CNFM_INVEST_PT,[y3v(b,"l")])+'<br /><div onclick="gxp('+b+')">'+STR.YES+'</div><div onclick="lphh(),m9m('+b+')">'+STR.NO+"</div>";c9qg(a)}}function _z7q(b){if(!_j5z(b)){var a="<b>"+STR.MARCH_NO_POWER+"</b><br /><br />"+STR.format(STR.MARCH_NO_POWER_TXT,[y3v(b,"l")])+'<br /><div onclick="lphh()">'+STR.OK+"</div>";c9qg(a)}}function q4dc(){var a="<b>"+STR.BATTLE_STEELBLADE+"</b><br /><br />"+(!cl0()||pfdm==2?STR.CNFM_BLADE:STR.CNFM_BLADE_TOB)+'<br /><div onclick="q32(1)">'+STR.YES+'</div><div onclick="q32(2)">'+STR.NO+"</div>";c9qg(a,"q4dc()")}function mw9(a){var b="<b>"+STR.BATTLE_CARD_ABILITY_TITLE+"</b><br /><br />"+STR.CNFM_TEXT_ABILITY+"<br /><div onclick=\"q32('"+a+"')\">"+STR.YES+'</div><div onclick="q32(3)">'+STR.NO+"</div>";c9qg(b)}function z7k(a){$("playerMessageContent").innerHTML='<div class="box-alert-minified" onclick="'+a+'">></div>';$("playerMessageDialog").style.left=285;$("playerMessageDialog").style.top=(screen.height/2)-200}function d4ss(){var a=d1x(),b=[[2,1],[2,1],[6,12]],c="<b>"+y3x_(a,_fxm())+"</b><br /><br />"+STR.EVT_CHOICE_TEXT+'<br /><div style="width:150px" onclick="m7l(\'A\')">a) '+y3x_(a,b[a-1][0])+'</div><div style="width:150px" onclick="m7l(\'B\')">b) '+y3x_(a,b[a-1][1])+'</div><div style="width:150px" onclick="m7l(\'C\')">c) '+STR.EVT_CHOICE_C+"</div>";c9qg(c,"d4ss()")}function c9qg(b,c){var a='<div class="box-alert">'+b;if(c){a+='<div class="box-minifier" onclick="z7k(\''+c+"')\"><</div>"}a+="</div>";$("playerMessageContent").innerHTML=a;r16_()}function flg(a){$("playerMessageContent").innerHTML='<div class="box-alert box_admin">'+a+"</div>";r16_()}function f72(){if(cdsz()||sd_4()==5){var c=0,m="";for(var e=0;e<8;e++){var n=r70[e][1];if(n>0){++c;var k=r70[e][0];var f=jhh(k);var a=f-n;var h=f==2;var d=h?"stronghold":"city";var l=STR.format(h?STR.DLG_MAIN_NFO_CASTLE:STR.DLG_MAIN_NFO_CITY,[f]);m+='<tr><td valign="bottom"><img width=35 height=19 src="./images/'+d+'.gif" title="'+l+'"></td>';m+="<td>"+y3v(k,"l")+":</td><td>"+a+"/"+f+" "+STR.EVT_MUSTER_POINTS_USED;if(!m_h(k)){m+=" ("+STR.EVT_MUSTER_NOT_POSSIBLE+")"}m+="</td></tr>"}}if(c==0){m="<tr><td>"+STR.DLG_MUSTER_NO_POINTS+"</tr></td>"}var b='<div onclick="zj2()" class="box-minifier">&lt;</div>';var g='<div class="dlg-muster"><table><tbody>'+m+"</tbody></table>"+b+"</div>";$("musteringDlgContent").innerHTML=g;$("musteringDialog").style.display="block"}}function zj2(){var a='<img width=35 height=19 src="./images/city.gif">';var b='<table><tbody><tr><td valign="bottom">'+a+"</td></tr></tbody></table>";$("musteringDlgContent").innerHTML='<div class="dlg-muster-minified" onclick="f72()">'+b+"</div>"}function t0st(){if(t7mc){try{new Audio("./sounds/turn-pedantic.mp3").play()}catch(a){console.log("No Audio / HTML5")}}}function w4xt(){var a=STR.ALRT_TURN;qzc(STR.ALRT_TURN+" ("+d2t6("lastaction")+")");t0st();if(sd_4()==1){a="<b>"+STR.PHASE_TITLE_PLANNING.toUpperCase()+"</b><br /><br />"+STR.PLAN_SET_ORDERS}a+='<br /><div onclick="lphh()">'+STR.OK+"</div>";c9qg(a)}function _xnx(v){var h=sd_4(),s="",b=0,m=0;if(h==0){s+='<table border=0 cellspacing="8" class="actionwindow" style="background-image:url('+q1x.src+'); background-image:repeat;"><tr><th>'+STR.format(STR.EVT_SUPPLY_NEW,["<big>"+v+"</big>"])+'</th></tr><tr><td align="center"><table style="cursor:pointer" onclick="_5l5(), t_g3()" onmouseover="style.backgroundColor=\'#EEEEEE\'" onmouseout="style.backgroundColor=\'\'" class="actionwindow"><tr><th>'+STR.O_K+"</th></tr></table></td></tr></table>"}else{if(h>=6){var f=xy8()?"s":"l",o=h>6?vpx():"",w=h>6?qws():"",x=f_vz(),l=_q__(),r=wpzj(x),d=wpzj(l),q=v70(c05y,mn4x),e=v70(c05y,msj),c=hp_(c05y,mn4x),n=hp_(c05y,msj),p=d2t6("attackersupport"),a=d2t6("defendersupport"),t=rc0(mn4x),g=rc0(msj),k=_15,u=kpc;if(h>8&&d2t6("steelbladeused")==1){if(p_zy(mn4x)){m=1}else{b=1}}if(h==7){k+=t;u+=g}s+='<table><tr><td rowspan=2 valign="top" width=195><div class="card_container_battle"><div class="card_base '+zv0+mn4x+" card"+(o.length!=2?'00">':o.charAt(1)+'">')+"</div>"+(h>7&&cl0()?'<div class="'+t0_k(x)+'"></div>':"")+'</div></td><td valign="top"><table cellpadding=5 class="actionwindow overlay_shadow dlg_battle" style="background-image:url(\''+q1x.src+'\'); background-repeat:repeat;"><tr><th><img src="'+w8_.src+'"></th><th>&#160;'+STR.format(STR.BATTLE_STR_TITLE,[y3v(c05y,f)])+'&#160;</th><th><img src="'+w8_.src+'"></th></tr><tr><td colspan=3 align="center"><table width="100%"><tr><td valign="top"><small><i>'+_hm2(mn4x)+'</i></small>  <table class="inneractionwindow" cellspadding=0 style="background-image:url(\'./images/bg_'+mn4x+".gif');\">   <tr><td><nobr>"+STR.BATTLE_STR_BASE+":</nobr></td><th>"+(k-r-wr0x-m-q-c-p-t)+"</th></tr>   <tr><td>"+STR.BATTLE_STR_SUPPORT_LAND+":</td><th>"+q+"</th></tr>   <tr><td>"+STR.BATTLE_STR_SUPPORT_SEA+":</td><th>"+c+"</th></tr>   <tr><td>"+STR.BATTLE_STR_SUPPORT_NEUTRAL+":</td><th>"+p+"</th></tr>"+(h>7&&cl0()?"   <tr><td>"+STR.BATTLE_STR_TOB+':</td><th valign="top">'+(h<8?"-":r)+"</th></tr>":"")+'   <tr><td style="font-size:15px"><b>'+STR.BATTLE_STR_TOTAL+':</b></td><th style="font-size:18px">'+k+'</th></tr>  </table> </td><td valign="top">&#160;</td> <td align="right" valign="top"><small><i>'+_hm2(msj)+'</i></small>  <table class="inneractionwindow" cellspadding=0 style="background-image:url(\'./images/bg_'+msj+".gif');\">   <tr><td><nobr>"+STR.BATTLE_STR_BASE+":</nobr></td><th>"+(u-d-qtv-b-e-n-a-g)+"</th></tr>   <tr><td>"+STR.BATTLE_STR_SUPPORT_LAND+":</td><th>"+e+"</th></tr>   <tr><td>"+STR.BATTLE_STR_SUPPORT_SEA+":</td><th>"+n+"</th></tr>   <tr><td>"+STR.BATTLE_STR_SUPPORT_NEUTRAL+":</td><th>"+a+"</th></tr>"+(h>7&&cl0()?"   <tr><td>"+STR.BATTLE_STR_TOB+':</td><th valign="top">'+(h<8?"-":d)+"</th></tr>":"")+'   <tr><td style="font-size:15px"><b>'+STR.BATTLE_STR_TOTAL+':</b></td><th style="font-size:18px">'+u+'</th></tr>  </table> </td></tr></table><small onclick="_5l5()" style="line-height:20px;cursor:pointer"><u>'+STR.PLAN_DLG_CLOSE+'</u></small></td></tr></table></td><td rowspan=2 valign="top" align="right" width=195><div class="card_container_battle"><div class="card_base '+zv0+msj+" card"+(w.length!=2?'00">':w.charAt(1)+'">')+"</div>"+(h>7&&cl0()?'<div class="'+t0_k(l)+'"></div>':"")+"</td>";if(m||b){s+='<tr><th height=75><img src="./images/sword_'+(m?"attacker":"defender")+'.gif"></th>'}s+="</tr></table>"}}$("actionWindowContent").innerHTML=s;if(parseInt($("actionWindow").style.left)<0){$("actionWindow").style.left=($("mainTable").offsetWidth-$("actionWindow").offsetWidth)/2;$("actionWindow").style.top=document.body.scrollTop+(screen.height/2)-245}}function h3w(){var b=chat.domObj;if(b.style.left!="-500"){var a=document.body.scrollTop+25;b.style.top=a}}function _9c(a,c,b){$("map_menu").style.left=c;$("map_menu").style.top=b;$("map_menu").innerHTML=a;$("map_menu").style.display=""}function q263(){$("map_menu").style.display="none"}function wp6(){s2j("leak_menu")}function _5l5(){s2j("actionWindow");if(sd_4()<8){wp6()}}function pvl(){$("musteringDialog").style.display="none";$("musteringDlgContent").innerHTML=""}function lphh(){$("playerMessageContent").innerHTML="";s2j("playerMessageDialog")}function t_74(){$("connerror").style.display="";$("connerror").innerHTML="<span>CONNECTION<br>ERROR</span>"}function k5s(){$("connerror").style.display="none"}function d3t(){var a=$("whereuheaded");if(a.className!="spike"){dyj6($("whereuheaded"),"spike")}}function fzw(){var a=$("whereuheaded");if(a.className=="spike"){d75(a,"unspike")}}function _lp(){this.x=587;this.y=document.body.scrollTop+30;this.doAlert=true;this.offsetX;this.offsetY;this.modeDrag=false;this.notify=false;this.history=[];this.histIndex=0;this.lastEntryId=0;this.heightDiff;this.domObj;this.domObjHdr;this.domObjMain;this.domObjContent;this.domInput;this.classHdrDefault="chat_hdr chat_hdr_pulse";this.classHdrBlink="chat_hdr chatblink";this.classDefault="chatframe";this.classMove="chatframe chatopacity";try{this.audioNewMessage=new Audio("./sounds/com-channel.mp3")}catch(a){console.log("No Audio / HTML5")}}function g6f(){var a=document.chatSendForm.chat,b=a.value;if(typeof String.xr9_=="function"){b=b.xr9_()}a.focus();a.value="";chat.history.push(b);chat.histIndex=chat.history.length;__b("set=chat&lce="+chat.lastEntryId+"&value="+encodeURIComponent(b),s9_)}function z00(a){var b;a=window.event||a;b=a.charCode||a.keyCode;if(b==38&&chat.histIndex>0){chat.domInput.value=chat.history[--chat.histIndex]}else{if(b==40){if(chat.histIndex<chat.history.length-1){chat.domInput.value=chat.history[++chat.histIndex]}else{chat.domInput.value="";chat.histIndex=chat.history.length}}}}function r__v(){chat=new _lp();chat.domObj=$("chatWindow");chat.domObjHdr=$("chatWindowHdr");chat.domObjMain=$("chatMain");chat.domObjContent=$("chatContent");chat.domInput=$("chatInput");if(chat.domObj.addEventListener){chat.domObjHdr.addEventListener("mousedown",lv_9,false);chat.domObjHdr.addEventListener("mouseup",cwj,false);chat.domObjHdr.addEventListener("dblclick",nh8,false);if(chat.domInput){chat.domInput.addEventListener("keydown",z00,false)}}else{chat.domObjHdr.onmousedown=lv_9;chat.domObjHdr.onmouseup=cwj;chat.domObjHdr.ondblclick=nh8;if(chat.domInput){chat.domInput.onkeydown=z00}}document.onmousemove=pkkt;lzt()}function fmzh(a){chat.domObjContent.innerHTML+=hq85(a);y7_()}function hq85(c){if(c.cdp("<img src=")){var b="https://www.thronemaster.net/images/avatars/";for(var a=0;a<_nr1;a++){c=c.split('<img src="_avt_'+lmm[a]).join('<img src="'+b+_jx[a])}}return c}function y7_(){chat.domObjContent.scrollTop=chat.domObjContent.scrollHeight}function r00(c){if(c.length==1&&c[0].length>0){bhh(c[0])}else{if(c.length==4){var b=parseInt(c[2]);if(c[3].length>0){if(b>chat.lastEntryId){var a=chat.lastEntryId>0;fmzh(c[3]);chat.lastEntryId=b;if(a){if(c[3].cdp("has been kicked")){m0xj=false;_n6k()}if(parseInt(c[0])>0){q_v()}}}}if(chat.doAlert&&parseInt(c[1])>0){chat.doAlert=false;bhh(STR.format(STR.CHAT_PM,[c[1]]))}}}}function q_v(){qzc(STR.CHAT_NEW_TITLE+" ("+chat.lastEntryId+")");if(t7mc){try{chat.audioNewMessage.currentTime=0.39;chat.audioNewMessage.play()}catch(a){}}if(chat.modeDrag){chat.notify=true}else{if(chat.domObj.style.display=="none"){c_h("");if(d2t6("g-pbem")&&!m0xj){_n6k()}}p26(1800)}}function p26(a){if(a>0){if(a%900==0){chat.domObjHdr.className=chat.classHdrBlink}else{chat.domObjHdr.className=chat.classHdrDefault}a-=450;window.setTimeout(p26,450,a)}else{chat.domObjHdr.className=chat.classHdrDefault}}function lv_9(){chat.modeDrag=true;chat.offsetX=cd_-chat.domObj.offsetLeft;chat.offsetY=xh_m-chat.domObj.offsetTop}function cwj(){chat.modeDrag=false;chat.domObj.className=chat.classDefault;if(chat.notify){chat.notify=false;window.setTimeout(q_v,500)}}function pkkt(a){cd_=document.all?window.event.clientX:a.pageX;xh_m=document.all?window.event.clientY:a.pageY;if(chat.modeDrag){if(chat.domObj.className!=chat.classMove){chat.domObj.className=chat.classMove}chat.x=cd_-chat.offsetX;chat.y=xh_m-chat.offsetY;chat.domObj.style.left=chat.x+"px";chat.domObj.style.top=chat.y+"px"}}function c_h(a){chat.domObj.style.left=chat.x;chat.domObj.style.top=chat.y;chat.domObj.style.display="";chat.domObjMain.style.display="";if(!y02x||a){if(j76()){chat.domInput.focus();chat.domInput.value=a}}y7_()}function _b2(){try{if(chat.domObj.style.display!="none"){p_m()}else{c_h("")}}catch(a){bhh(STR.CHAT_INIT_FAILED+"\n"+a)}}function nh8(){if(chat.domObjMain.style.display!="none"){chat.domObjMain.style.display="none";chat.x=chat.domObj.style.left;chat.y=chat.domObj.style.top;chat.domObj.style.left=window.innerWidth-chat.domObj.scrollWidth-50;chat.domObj.style.top=window.innerHeight-chat.domObj.scrollHeight-25}else{chat.domObj.style.left=chat.x;chat.domObj.style.top=chat.y;chat.domObjMain.style.display=""}cwj()}function klk(){return chat&&chat.domObj&&chat.domObj.style.display!="none"}function n23(){return chat&&chat.domObjMain&&chat.domObjMain.style.display=="none"}function p_m(){chat.domObj.style.display="none";cwj()}function bhh(a){if(j76()){alert(a)}}function lzt(){fd0s("get=CHAT&lce="+chat.lastEntryId,s9_)}function _n6k(){fd0s("get=GAMEALL&lce="+chat.lastEntryId+"&crc="+s2x+"&lga="+n7b0,s9_)}function s9_(c){try{var b=JSON.parse(c),f=b.error.f6xc(),a="";b9j.setTime(b.time)}catch(d){alert("Unexpected error while retrieving data from b9j!")}if(isNaN(f)||f>0){alert("WARNING: Possible connection problem!")}else{if(b.setup.length>0){zcc(b.setup)}if(b.data.length>0){zcc(b.data);z6lb()}if(b.chat.length>0){r00(b.chat)}if(b.logs.length>0){cj0(b.logs)}if(b.online.length>0){pbq(b.online)}if(b.stats.length>0){ps9(b.stats)}}}function cj0(b){var c=$("stats_action"),d="";if(c.innerHTML.sxk("<img")){c.innerHTML=""}for(var a=0;a<b.length;a++){d+="&#10151; "+b[a]+"<br />"}c.innerHTML=d+c.innerHTML}function mhs7(){w8z();cty_();m0xj=false;y6l();_n6k()}function ffwd(a,b){switch(a){case"ffrfrsh":mhs7();break;case"ffshtcht":p_m();break;case"ffclstp":h343();break;case"ffchngmg":y6h(b[0],b[1]);break;case"ffswtchpbm":w8y();break;case"fftltp":__zs(b[0],b[1]);break;case"ffhghhs":_1j(b[0],b[1]);break;case"ffhghll":zy89();break;case"ffhghlnd":j_w6(b[0],b[1],b[2]);break;case"ffhghs":x_6(b[0],b[1],b[2]);break;case"ffhvrf":fvs(b[0],b[1]);break;case"ffrdhvr":v8k3(b[0],b[1]);break;case"ffmncht":nh8();break;case"ffrmnt":ym5y(b[0],b[1],b[2]);break;case"ffrmrdr":k440(b[0]);break;case"ffstf":xr7(b[0]);break;case"ffstr":hvj(b[0],b[1]);break;case"ffslctcrd":fz0(b[0]);break;case"ffslctmg":p65(b[0]);break;case"ffslrdr":_s1v(b[0]);break;case"ffhghnst":ts_();break;case"ffpgrd":_spc(b[0],b[1]);break;case"ffchtmt":g6f();break;case"ffsnd":j_0();break;case"ffnts":v__();break;case"ffchtbx":_b2();break;case"ffcht":c_h(b[0]);break;default:break}}function hf_(){var f=d2t6("cfg-tbrkr"),g=msz(),c='<table border=0 width="98%" align="center" style="font-size:small"><tr><td width=15 align="center">&#8896;</td><td><b>'+STR.PLAYER+"</b></td><th>C</th><th>S</th><th>P</th><th>T</th></tr>";for(var a=0;a<_nr1;a++){var b=g[a].house;if(mymk(b)){c+='<tr><td><img src="./images/house'+b+'.gif" style="height:15px;vertical-align:bottom;border:0px;"></td><td>'+qjg(b)+"</td><th>";try{if(f&&((a>0&&g[a].cities==g[a-1].cities)||g[a].cities==g[a+1].cities)){c+=g[a].strong+"+"+g[a].castle}else{throw 1}}catch(d){c+=g[a].cities}c+='</th><td align="center">'+g[a].supply+'</td><td align="center">'+g[a].power+'</td><td align="center">'+g[a].throneTrack+"</td></tr>"}}$("stats_ladder").innerHTML=c+"</table>"}function ps9(e){var h=d2t6("g-pbem")?"min":"sec",c=e.length,g='<table border=0 width="98%" align="center" style="font-size:small">';for(var f=0;f<c;f++){var k=e[f].split(","),a=k[0],d=k[1],b=k[2];g+="<tr><td width=15>"+(qjg(a)?'<img src="./images/house'+a+'.gif" style="height:15px;vertical-align:bottom;border:0px;"> ':"")+'</td><td width="55%">'+qjg(a)+'</td><td class="avg_speed '+(f+1==c?" overline000":"")+'">'+d+" "+h+" / "+b+"</td></tr>"}$("stats_speed").innerHTML=g+"</table>"}function nkc(){if(m0xj||d2t6("g-pbem")&&(!nnj||!klk())){lzt()}else{_n6k()}}function g794(){$("dlg_main_win_txt").innerHTML=STR.format(STR.DLG_MAIN_WIN_TXT,["<b>"+hvc()+"</b>"])}function _m7(){g794();$("dlg_main_aof").innerHTML=STR.DLG_MAIN_AOF;$("dlg_track_1").innerHTML="&#160;"+STR.TRACK_THRONE;$("dlg_track_2").innerHTML="&#160;"+STR.TRACK_FIEFDOMS;$("dlg_track_3").innerHTML="&#160;"+STR.TRACK_COURT;$("dlg_main_supply").innerHTML=STR.DLG_MAIN_SUPPLY;$("dlg_main_status").innerHTML=STR.DLG_MAIN_STATUS;$("dlg_main_houses").innerHTML=STR.DLG_MAIN_HOUSES;$("dlg_main_ladder").innerHTML=STR.DLG_MAIN_LADDER;$("dlg_main_speed").innerHTML=STR.DLG_MAIN_SPEED;$("dlg_main_action").innerHTML=STR.DLG_MAIN_ACTION;$("menu_reload").innerHTML=STR.MENU_RELOAD;$("menu_review").innerHTML=STR.MENU_REVIEW;$("menu_log").innerHTML=STR.MENU_LOG;$("menu_sound").innerHTML=$("menu_sound").innerHTML.replace("Sound:ON",STR.MENU_SOUND+":"+STR.ON);$("menu_sound").innerHTML=$("menu_sound").innerHTML.replace("Sound:OFF",STR.MENU_SOUND+":"+STR.OFF);$("menu_chat").innerHTML=STR.MENU_CHAT;try{$("chatSubmitButton").value=STR.SUBMIT;$("menu_notes").innerHTML=STR.MENU_NOTES;$("pbemSwitchImg").title=STR.DLG_MENU_SWITCH_TITLE}catch(b){}for(var a=0;a<6;a++){try{$("dlg_main_nfo_castle"+a).title=STR.format(STR.DLG_MAIN_NFO_CASTLE,[2]);$("dlg_main_nfo_city"+a).title=STR.format(STR.DLG_MAIN_NFO_CITY,[1]);$("dlg_main_nfo_knight"+a).title=STR.format(STR.DLG_MAIN_NFO_KNIGHT,[2]);$("dlg_main_nfo_footmen"+a).title=STR.format(STR.DLG_MAIN_NFO_FOOTMEN,[1]);$("dlg_main_nfo_ship"+a).title=STR.format(STR.DLG_MAIN_NFO_SHIP,[1]);if(!$("onlineStatus"+lmm[a])){$("dlg_main_housename"+lmm[a]).innerHTML=_hm2(lmm[a])}$("dlg_main_usr_profile"+a).title=STR.DLG_MAIN_USR_PROFILE;if(j76()){var c=$("dlg_main_usr_whisper"+a).title.replace("Whisper to ","");$("dlg_main_usr_whisper"+a).title=STR.format(STR.DLG_MAIN_USR_WHISPER,[c])}}catch(b){}}$("battleImg").firstChild.title=STR.BATTLE_TITLE_AREA;$("attackerImg").firstChild.title=STR.BATTLE_TITLE_FLAG}function j_0(){t7mc=!t7mc;$("menu_sound").innerHTML=STR.MENU_SOUND+":"+(t7mc?STR.ON:STR.OFF);fd0s("audio="+(t7mc?"ON":"OFF"),null)}function pbq(f){var b=f[0],d=parseInt(f[1]),a="",h="";$("watchers").style.display="";if(d>0){$("watchers").style.display="table-row";$("watchers_text").innerHTML=d+" "+(d>1?"users are":"user is")+" currently watching"}for(var c=0;c<_nr1;c++){switch(parseInt(b.charAt(c))){case 1:a="";h="/ "+STR.ONLINE;break;default:a="#96A";h="/ "+STR.OFFLINE;break}try{$("onlineStatus"+lmm[c]).style.color=a;$("onlineStatus"+lmm[c]).innerHTML=h}catch(g){}}}function zcc(d){for(var c=0;c<d.length;c++){var e=d[c].split(","),f=e[0]=="1",b=e[1],a=e[2],g=f?a.f6xc():a;_dby(b,g)}}function z6lb(){if(_1_){if(s2x!=d2t6("crc")){s9zc()}}else{kt2_()}}function qzc(a){document.title=slf+" - "+a}function w8z(){document.title=slf}function skr(){var b=v0q(),a=g70(),c='<div class="head-info head-info-main"><div>'+b+'</div><div class="head-info-turn" title="'+STR.format(STR.TURNS,[b,cjy])+'"></div><div>'+a+'</div><div class="head-info-wild" title="'+STR.WILDLINGS+'" : "'+a+'"></div></div>';$("gameStateContent").innerHTML=c}function c_g(b){var e,c,a;if(b<1440){c=Math.floor(b/60);a=Math.round(b-(c*60));return rnv(c,2)+":"+rnv(a,2)}else{if(b>14400){e=Math.floor(b/(24*60));return(e+"<small> days</small>")}else{e=Math.floor(b/(24*60));c=Math.round((b-(e*24*60))/60);return e+"<small>d, </small>"+c+"<small>h</small>"}}}function jq8(a){$("playTimeContent").innerHTML='<div class="head-info head-info-time">'+c_g(a)+"</div>";return setTimeout(jq8,60000,++a)}function ntw(){$("playTime").style.left=5;$("playTime").style.top=5;return jq8((d2t6("lastaction")-rcfw)/60)}function vvd(b,a){b=vnmf(b);if(!a){a=_04m()}for(var c=0;c<a.length;c+=3){if(b==a.charAt(c+2)){return true}}return false}function c__c(){var h=sd_4(),a,g=-1;if(nry){for(var f=0;f<_nr1;f++){if(lmm[f]==nry){g=sv4(f);break}}}if(h==0){if(zj_v()){var l=[0,2,1],b=l[d1x()-1];a=_sm(b);if(!mymk(a)){a=__1(b)}return a}else{for(var d=0;d<_nr1;d++){a=t062(++g);if(mymk(a)){break}}}}else{if(h>2&&h<6){var c,e=zrft(h);for(var d=0;d<_nr1;d++){if(++g>=_nr1){g=0}a=t062(g);c=_04m(a);if(mymk(a)&&vrbs(c,e,false)){if(h==5){var k=t__("F",c);if(k>=vm25||!dr5m(k)){continue}}break}}}}return a}function s9zc(){var f=false,a;s2x=d2t6("crc");z507=d2t6("lastaction");n7b0=d2t6("lastactionid");sww_();if(_1_!=d2t6("gamestate")){_1_=d2t6("gamestate");if(sd_4()==1){pg2v()}skr();f=true}a=sd_4();if(a>7||a!=cnn){f=true}if(a<6&&cnn>5){s45();m0d();d_5()}if(nry!=d2t6("lasthouse")){nry=d2t6("lasthouse")}if(bmv_!=d2t6("carddeck1")||l89t!=d2t6("carddeck2")||m5k!=d2t6("carddeck3")){bmv_=d2t6("carddeck1");l89t=d2t6("carddeck2");m5k=d2t6("carddeck3");zhyn(a)}if(a==0&&cdt!=d2t6("bidarea")){cdt=d2t6("bidarea");f=true}if(l_q0!=d2t6("houses")){l_q0=d2t6("houses");_n0();dnj();_hmv()}if(pfdm!=d2t6("steelblade")||f_fx!=d2t6("stolentokens")){pfdm=d2t6("steelblade");f_fx=d2t6("stolentokens");___c()}if(z31!=d2t6("routedunits")){z31=d2t6("routedunits");if(a<2){vx5()}}if(b66!=d2t6("land")){b66=d2t6("land");p15z();_hmv()}if(_8bd!=d2t6("sea")||_dmx!=d2t6("port")){if(dpx){_dmx=d2t6("port")}_8bd=d2t6("sea");_qd()}for(var b=0;b<_nr1;b++){var d=lmm[b],h=_04m(d),c=d2t6("orders"+d);if(h!=c&&(a==0||c.length%3==0)&&(a!=1||cnn!=1||d!=j76())){y87(lmm[b],c);xrv(d)}}if(xh_!=d2t6("cards")){xh_=d2t6("cards");w2m();if(kypb("S").charAt(6)=="1"){fzw()}}hf_();try{clearTimeout(wv_)}catch(g){}wv_=ntw();if(!f&&[0,3,4,5].cdp(a)){if(a>0||(!lyys()&&!wb_j())){f=true}else{if(d2t6("bidcount")>=_nr1){f8yy()}}}if(f){_q4(v0q(),a);cnn=a}else{if(a==7&&parseInt($("actionWindow").style.left)>0){_xnx(a)}}}function _q4(m,o){var h="",p="",c,b;$("gameStateText").innerHTML="";$("gameStateForm").innerHTML="";$("menue").innerHTML="";if(o>=6){$("menue").innerHTML='<small>&#160;<a href="javascript:b5_h()">'+STR.DLG_MENU_BATTLE+"</a> |</small>"}if(o==0){var n=d1x(),e=_fxm();m0xj=false;if(cnn>=8){m0d();_jw0();_5l5()}if(n=="3"){if(l89t==1){_hmv()}else{if(l89t==2){_n0()}}}else{if(bmv_==1){p15z();_qd()}}h="<b><i>"+STR.PHASE_TITLE_EVENTS+": ("+STR.EVT_DECK+" "+n+")</i></b><br /><small><b>"+y3x_(n,e)+":</b><br />"+STR.format(q6_y(n,e),[g70()]);f8yy()}else{if(o==1){var a=j76();m0xj=false;h="<b><i>"+STR.PHASE_TITLE_PLANNING+": (1)</i></b>";if(mymk(a)){if(cnn>1){zhyn(1);pln_(b66,_8bd,_dmx)}if(h0nv(a)>0||qzs(a)>0||k9tw(a)>0||hkbt(a)>0){h+="<small><br />"+STR.PLAN_STATUS+"<br />"+STR.PLAN_PROCEED;p83f(a);p='<form name="sendOrdersForm" action="./setGameData.php?game='+d8m+"&crc="+s2x+'" target="setDataFrame" onsubmit="return htcb()" method="post"><input type="hidden" name="orders" value="null"><input type="hidden" name="house"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'">&#160;&#160;&#160;<input class="button" type="'+(m==1?"button":"hidden")+'" onclick="k8sp(j76())" value="'+STR.ORDER_ADVICE+'"></form>';w4xt();_3ky();cp0()}else{h+="<small><br />"+STR.PLAN_STATUS0+"<br /><br /><br /><br /><center><b>"+STR.STATUS_WAITING+"</b></center>"}}else{h+="<small><br />"+STR.PLAN_STATUS_SPEC}}else{if(o==2){xrv();h="<b><i>"+STR.PHASE_TITLE_PLANNING+": (3)</i></b><small><br />"+STR.RAVEN_STATUS+"<br />";if(mymk(j76())&&ftq(j76())){m0xj=true;w4xt();_3ky();cp0();kw7=_04m();h+="<b>"+STR.RAVEN_STATUS1+"</b><br />"+STR.RAVEN_STATUS2+"<br />"+STR.PLAN_PROCEED;p='<form name="sendOrdersForm" action="./setGameData.php?raven=1&game='+d8m+"&crc="+s2x+'" target="setDataFrame" onsubmit="return htcb()" method="post"><input type="hidden" name="orders" value="null"><input type="hidden" name="house"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>&#160;&#160;&#160;<form name="revokeForm"><input class="button" type="button" value="'+STR.REVOKE+'" onclick="lmgw('+o+')"></form>'}else{h+=STR.RAVEN_STATUS_SPEC;p=STR.RAVEN_STATUS_WAITING}}else{if(o.jyc2(3,5)){p5t="";if(cnn>=8){lmgw(4);_5l5()}vbb();if(m==cjy&&o==5&&d2t6("ordersall")==""){l026()}else{if(!vhf()){kw7=_04m();h="<b><i>"+STR.PHASE_TITLE_ACTION+": ("+(o-2)+")</i></b><small><br /><b>";if(o==3){h+=STR.PHASE_ACTION_RAID+":</b><br />"+STR.RAID_STATUS}else{if(o==4){xrv();h+=STR.PHASE_ACTION_MARCH+":</b><br />"+STR.MARCH_STATUS}else{if(o==5){h+=STR.PHASE_ACTION_CP+":</b><br />"+STR.CP_STATUS}}}f8yy()}}}else{if(o>=6){var g=sd_4();if(o==6){m0d()}vtg();if(g>=8){_15+=rc0(mn4x);kpc+=rc0(msj);lmw(vpx(),qws());if(zzp4()){wmt()}}if(o<10||(o==10&&j073(j76()))){zfkw()}h="<b><i>"+STR.PHASE_ACTION_BATTLE+": ("+(o-5)+")</i></b><small><br /><b>";if(o==6){h+=STR.BATTLE_SUPPORT_STATUS+":</b><br />"+STR.BATTLE_SUPPORT_STATUS_SPEC;if(k_2p()){scrollTo(0,p40[c05y][7]-(screen.height/2))}else{scrollTo(0,wq_[c05y][7]-(screen.height/2))}p=STR.BATTLE_SUPPORT_WAITING;if(mn4x==j76()||msj==j76()){_jw0();_xnx(o)}else{if(mymk(j76())&&(hp_(c05y,j76())>0||(k_2p()&&v70(c05y,j76())>0))){w4xt();c=v70(c05y,j76());b=hp_(c05y,j76());h+="<br />"+STR.BATTLE_SUPPORT_STATUS1;p='<form name="sendSupportForm" action="./setGameData.php?game='+d8m+"&crc="+s2x+'" target="setDataFrame" onsubmit="return p9t()" method="post"><center><table><tr><td colspan=2><input style="cursor:pointer" type="radio" name="support" value=0><small> <b>'+STR.BATTLE_SUPPORT_DEFAULT+'</b></small></td></tr><tr><td><input style="cursor:pointer" type="radio" name="support" value="attacker"><small> <b>'+_hm2(mn4x)+'</b></small></td><td><input style="cursor:pointer" type="radio" name="support" id="radioSupportDefender" value="defender"><small> <b>'+_hm2(msj)+'</b></small></td></tr><tr><th colspan=2><input type="hidden" name="house" value="'+j76()+'"><input type="hidden" name="supportstrland" value="'+c+'"><input type="hidden" name="supportstrsea" value="'+b+'"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></th></tr></table></center> </form>'}}}else{if(o==7){h+=STR.BATTLE_CARD_STATUS+":</b><br />";h+=_v1?STR.BATTLE_CARDS_STATUS1:STR.BATTLE_CARD_STATUS1;if((mn4x==j76()||msj==j76())&&((vpx()+qws()).length<4||j76()!="L")){b2j=kypb(j76());if(o!=g||(!_v1&&b2j._jj("1")>1)||(_v1&&b2j._jj("1")>3)){if(o==g){w4xt()}h+="<br />"+STR.BATTLE_CARD_STATUS2;p+='<form name="sendCardsForm" action="./setGameData.php?&game='+d8m+"&crc="+s2x+'" target="setDataFrame" onsubmit="return fyw7()" method="post"><input type="hidden" name="card" value=""><input type="hidden" name="actor"><input type="hidden" name="house"><input type="hidden" name="textability"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'">'}else{p=STR.BATTLE_CARD_STATUS0+"<br />"+STR.BATTLE_CARD_WAITING}_xnx(o)}else{p=STR.BATTLE_CARD_WAITING}}else{if(o==8||o==9){var d,l,a;_xnx(o);if(_h1()){d="L3";l=STR.HOUSE_L}else{if(nq9v("G1")){d="G1";l=STR.HOUSE_G}else{if(nq9v("T1")){d="T1";l=STR.HOUSE_T}else{if(nq9v("M1")){d="M1";l=STR.HOUSE_M}}}}if(d&&l){a=d.charAt(0);h+=STR.BATTLE_CARDS_CHOSEN+":</b><br />"+STR.format(STR.BATTLE_CARD_TEXT_ABILITY,[l]);if(j76()==a){m0xj=true;n6td(d!="G1"?true:false);mw9(d)}else{p=STR.format(STR.STATUS_WAITING_NAME,[qjg(a)])}}else{if(vx5k()){n6td(false);h+=STR.BATTLE_CARDS_CHOSEN+":</b><br />"+STR.BATTLE_BLADE_STATUS;if(p_zy(j76())&&(j76()==mn4x||j76()==msj)){m0xj=true;q4dc()}else{l=p_zy(mn4x)?mn4x:msj;p=STR.format(STR.STATUS_WAITING_NAME,[qjg(l)])}}else{h+=STR.BATTLE_RESULT+":</b><br />"+STR.BATTLE_RESULT_STATUS;f2x()}}}else{if(o==10){var f=_8jj(),k=qgyl(f);if(j76()==f){m0xj=true;w4xt();lmgw(o);h+=STR.BATTLE_CARD1+":</b><br />"+STR.BATTLE_CARD2;p='<form name="phaseAForm" action="./setGameData.php?sendorders=1&game='+d8m+"&crc="+s2x+'" target="setDataFrame" onsubmit="return cn1y()" method="post"><input type="hidden" name="ordersB"><input type="hidden" name="ordersL"><input type="hidden" name="ordersS"><input type="hidden" name="ordersT"><input type="hidden" name="ordersG"><input type="hidden" name="ordersM"><input type="hidden" name="land"><input type="hidden" name="routedunits"><input type="hidden" name="house"><input type="hidden" name="housepositions"><input type="hidden" name="cardstring"><input type="hidden" name="type" value="'+k+'"><input type="hidden" name="stolentokens"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>&#160;&#160;&#160;<form name="revokeForm"><input class="button" type="button" value="'+STR.REVOKE+'" onclick="lmgw('+o+')"></form>'}else{h+=STR.BATTLE_CARD1+":</b><br />"+STR.BATTLE_CARD3;p=STR.format(STR.STATUS_WAITING_NAME,[qjg(f)])}h+=" '<i>"+STR[grj()+"_"+k]+"</i>'<br />";if(k=="S1"){p=""}}else{if(o==11){var k="B1";if(j76()=="B"){m0xj=true;w4xt();h+=STR.BATTLE_CARD1+":</b><br />"+STR.BATTLE_CARD2;p='<form name="phaseAForm" action="./setGameData.php?game='+d8m+"&crc="+s2x+'" target="setDataFrame" onsubmit="return srf()" method="post"><input type="hidden" name="house"><input type="hidden" name="cardstring"><input type="hidden" name="type" value="'+k+'"><input class="button" type="submit" name="proceed" value="'+STR.PROCEED+'"></form>&#160;&#160;&#160;<form name="revokeForm"><input class="button" type="button" value="'+STR.REVOKE+'" onclick="lmgw('+o+')"></form>'}else{h+=STR.BATTLE_CARD1+":</b><br />"+STR.BATTLE_CARD3;p=STR.format(STR.STATUS_WAITING_NAME,[qjg("B")])}h+=" '<i>"+STR["BATTLE_CARD2_"+k]+"</i>'<br />"}}}}}}}}}}if($("gameStateText").innerHTML==""){$("gameStateText").innerHTML=h+"</small>"}if($("gameStateForm").innerHTML==""){$("gameStateForm").innerHTML=p}}function cty_(){m0xj=false;$("gameStateForm").innerHTML=STR.STATUS_WAITING;if(lyys()||wb_j()){_5l5()}else{if(rh__()){$("gameStateText").innerHTML="<b><i>"+STR.PHASE_TITLE_PLANNING+": (2)</i></b><br /><small>"+STR.PLAN_STATUS1+"</small>"}}}function lmgw(b){var f=ysf(),a=!f&&cdsz(),e=!f&&!a&&wb_j(),c,g;ts_();if(b>2||f||e){b66=d2t6("land");_8bd=d2t6("sea");_dmx=d2t6("port");z31=d2t6("routedunits");_hmv()}else{if(a){if(d6kx.length>1){c=d6kx.length-2;d6kx.pop();b66=d6kx[c].land;_8bd=d6kx[c].sea;_dmx=d6kx[c].ports;for(var d=0;d<8;d++){r70[d][0]=d6kx[c].mpoints[d][0];r70[d][1]=d6kx[c].mpoints[d][1]}}else{b66=d2t6("land");_8bd=d2t6("sea");_dmx=d2t6("port");qc0(j76())}}}m0d();p15z();_qd();pln_(b66,_8bd,_dmx);p5t="";_jw0();sds();d_5();if(a){q263();_5l5();f8b();f72();vbb();cyj(vhz)}else{if(f||e){hzd=1;if(e){if(_04m()=="1"||(kt_h[0]==d2t6("bid"+j76())&&f0s!="1"&&y67!="1"&&_qnc!="1"&&n187!="1"&&x_05!="1"&&fsny!="1")){hzd=4}else{hzd=2}}}else{if(lyys()){_n0();bpd()}else{if(b==2){cp0()}else{if(b==3){lkpc(1,3);ggp()}else{if(b==4){h343();lphh();s45();vbb();h_w();ggp();lkpc(4,6);rf_=false}else{if(b==5){q263();pvl();_5l5();lkpc(13,15);vbb()}else{if(b==8||b==9){vx5();l_q0=d2t6("houses");_q4(1,b)}else{if(b>=10){if(document.phaseAForm){document.phaseAForm.cardstring.value=""}w2m();if(b==10){g=qgyl(j76());_hnn(g)}}}}}}}}}}if(b!=10){xp4g=-1}ktlx=0};